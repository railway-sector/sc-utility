{"version":3,"file":"static/js/68632.d3c04c67.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/layers/support/highlightUtils.js","../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/layers/ImageryLayerView.js","../node_modules/@arcgis/core/views/3d/layers/ImagerySubView3D.js","../node_modules/@arcgis/core/views/3d/support/flow/FlowSubViewExtent3D.js","../node_modules/@arcgis/core/views/3d/layers/ImageryLayerView3D.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isSome as r}from\"../../../core/arrayUtils.js\";import o from\"../../../core/Collection.js\";import{isGraphic as t}from\"../../../support/guards.js\";function i(i){if(!i)return[];let e=t(i)?[i]:o.isCollection(i)?i.toArray():Array.isArray(i)?i:[];return e=e?.filter(r),0===(e?.length??0)?[]:e}export{i as getHighlightGraphics};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as i}from\"tslib\";import e from\"../../../../Color.js\";import t from\"../../../../core/Accessor.js\";import{isSome as r}from\"../../../../core/arrayUtils.js\";import{makeHandle as s,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as n,project as c}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import d from\"../../../../symbols/SimpleLineSymbol.js\";import u from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends t{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const t=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new u({size:\"2px\",style:\"square\",color:t})],[\"polyline\",new d({width:\"2px\",color:t})],[\"polygon\",new m({outline:null,color:t})]])}highlight(i,e){const t=y(i);if(0===t.length)return s();let r,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(t),this._ensureGraphicsView3D()]).then(([i,t])=>{!o&&t&&(r=this._addHighlightGraphics(t,i,e))})),s(()=>{o=!0,r?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,t){for(const s of e)this._highlightCounts.set(s,(this._highlightCounts.get(s)??0)+1);this.graphics.addMany(e);const r=i.highlight(e,t);return s(()=>{this._removeHighlightGraphics(e),r.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(i=>{const e=Math.max(0,(this._highlightCounts.get(i)??0)-1);return 0===e?(this._highlightCounts.delete(i),!0):(this._highlightCounts.set(i,e),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:\"graphics-view-3d-dummy\",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:\"on-the-ground\"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h(()=>this.suspended,i=>{e.suspended=i},p)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:i})=>i?.spatialReference).filter(r).reduce((i,e)=>(0!==i.length&&i.at(-1)?.equals(e)||i.push(e),i),[]),t=this.view.spatialReference,s=e.map(i=>({source:i,dest:t}));try{await n(s)}catch{return[]}return i.map(i=>{const{geometry:e}=i;try{const r=e?c(e,t):null,s=i.cloneShallow();return s.geometry=r,s.symbol=this._symbols.get(r?.type),s}catch{return i}})}};i([a()],w.prototype,\"graphics\",void 0),i([a()],w.prototype,\"graphicsView\",void 0),i([a()],w.prototype,\"view\",void 0),i([a()],w.prototype,\"layer\",void 0),i([a()],w.prototype,\"updatingHandles\",void 0),i([a()],w.prototype,\"suspended\",void 0),i([a()],w.prototype,\"updating\",null),w=i([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import t from\"../../core/Error.js\";import{throwIfAborted as r}from\"../../core/promiseUtils.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import i from\"../../geometry/Point.js\";import a from\"../../layers/support/FieldsIndex.js\";import{rasterFieldPrefix as p}from\"../../layers/support/rasterFieldUtils.js\";import{combineTimeExtent as n}from\"../../layers/support/timeSupport.js\";import{load as l,getSourceScale as m}from\"../../layers/support/rasterFunctions/rasterProjectionHelper.js\";import u from\"../../rest/support/Query.js\";import{getFetchPopupTemplate as c}from\"./support/popupUtils.js\";const y=y=>{const d=y;let f=class extends d{constructor(...e){super(...e),this.view=null}get timeExtent(){return n(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}async fetchPopupFeaturesAtLocation(e,o){const{layer:s}=this;if(!e)throw new t(\"imagerylayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:s});const{popupEnabled:n}=s,l=c(s,o);if(!n||null==l)return[];const m=await l.getRequiredFields(null,{index:new a(s.rasterFields),partitions:new Map([[\"$pixel\",s.rasterFields.filter(e=>e.name.startsWith(p)).map(e=>e.name)],[\"$imageCollectionItem\",s.fields.map(e=>e.name)]])});r(o);const y=new u;y.timeExtent=this.timeExtent,y.geometry=e,y.outFields=m,y.outSpatialReference=e.spatialReference;const{resolution:d,spatialReference:f}=this.view,h=\"2d\"===this.view.type?new i(d,d,f):new i(.5*d,.5*d,f),{returnTopmostRaster:w,showNoDataRecords:R}=l.layerOptions||{returnTopmostRaster:!0,showNoDataRecords:!1},j={returnDomainValues:!0,returnTopmostRaster:w,pixelSize:h,showNoDataRecords:R,signal:o?.signal};return s.queryVisibleRasters(y,j)}async getSourceScale(){return await l(),await this.layer.load(),m(this.layer.serviceRasterInfo,this.view.spatialReference)}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([o()],f.prototype,\"layer\",void 0),e([o()],f.prototype,\"suspended\",void 0),e([o({readOnly:!0})],f.prototype,\"timeExtent\",null),e([o()],f.prototype,\"view\",void 0),f=e([s(\"esri.views.layers.ImageryLayerView\")],f),f};export{y as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{debounce as a}from\"../../../core/promiseUtils.js\";import{when as i}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as t}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DrapedSubView3D.js\";let s=class extends r{constructor(e){super(e),this.redrawDebounced=a(async e=>{this.redraw((e,a)=>this._redrawImage(e,a),e)},2e3)}initialize(){this.addHandles([i(()=>this.view.basemapTerrain.ready,()=>this._initializeMaximumDataResolution(),{once:!0,initial:!0}),this.layer.on(\"redraw\",()=>this.updatingHandles.addPromise(this.redrawDebounced()))])}_initializeMaximumDataResolution(){this.maximumDataResolution=this.layer.loaded?this.layer.serviceRasterInfo.pixelSize:null}async processResult(e,a,i){a.imageOrCanvasElement?e.image=a.imageOrCanvasElement:(e.image=document.createElement(\"canvas\"),e.pixelData=a.pixelData,await this._redrawImage(e,i))}async _redrawImage(e,a){if(!(e.image instanceof HTMLCanvasElement)||null==e.pixelData)throw new Error;const i=e.image,t=i.getContext(\"2d\"),r=await this.layer.applyRenderer(e.pixelData,{signal:a}),s=this.layer.applyFilter(r).pixelBlock;if(null==s)throw new Error;i.width=s.width,i.height=s.height;const o=t.createImageData(s.width,s.height);o.data.set(s.getAsRGBA()),t.putImageData(o,0,0)}};s=e([t(\"esri.views.3d.layers.ImagerySubView3D\")],s);export{s as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{makeHandle as t}from\"../../../../core/handleUtils.js\";import\"../../../../core/Logger.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import\"../../../../core/Error.js\";import{subclass as r}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{loadImagery as s}from\"../../../2d/engine/flow/dataUtils.js\";import o from\"../../layers/FlowSubView3D.js\";let i=class extends o{constructor(e){super(e)}initialize(){this.updatingHandles.add(()=>this.renderedTiles,()=>this.triggerLoad()),this.updatingHandles.add(()=>this.elevationInfo.mode,e=>this._updatePopupDrapeSource(e),{initial:!0})}_updatePopupDrapeSource(e){if(\"on-the-ground\"===e)return void this.removeHandles(a);if(this.hasHandles(a))return;const r={destroyed:!1,drapeSourceType:2,updatePolicy:0,layer:this.layer},s=this.layerView.view.overlayManager;s.registerGeometryDrapeSource(r),this.addHandles(t(()=>s.unregisterDrapeSource(r)),a)}async fetchDataAndGenerateStreamlines(e,t){const{needsMagnitude:r,workerHandle:o}=this,i=this.getSimulationSettings(e),{size:a,extent:n,timeExtent:l}=e;if(null==i||null==o)return;const d=await s(this.layer,n,a[0],a[1],l,t);if(null==d)return null;const u={simulationSettings:i,flowExtentInfo:e.flowExtentInfo,flowData:d,needsMagnitude:r,startPositions:this.startPositions(e)},{streamlines:p}=await o.generateStreamlines(u,t);return p}};i=e([r(\"esri.views.3d.support.flow.FlowSubViewExtent3D\")],i);const a=Symbol(\"popupDrapeSource\");export{i as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import{watch as i,syncAndInitial as r,initial as s}from\"../../../core/reactiveUtils.js\";import{property as o}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/has.js\";import\"../../../core/Logger.js\";import\"../../../core/RandomLCG.js\";import{subclass as a}from\"../../../core/accessorSupport/decorators/subclass.js\";import h from\"./DynamicLayerView3D.js\";import l from\"./ImagerySubView3D.js\";import{ImageHighlightHelper3D as p}from\"./support/ImageHighlightHelper3D.js\";import n from\"../support/flow/FlowSubViewExtent3D.js\";import d from\"../../layers/ImageryLayerView.js\";let g=class extends(d(h)){constructor(){super(...arguments),this.type=\"imagery-3d\"}get highlightOptions(){return null}get pixelData(){return null}initialize(){const e=()=>this._updatingHandles.addPromise(this.refreshDebounced());this._updatingHandles.add(()=>this.layer?.exportImageServiceParameters?.version,e),this._updatingHandles.add(()=>this.layer?.renderer,e),this._updatingHandles.add(()=>this.timeExtent,e),this._highlightHelper=new p({view:this.view,layer:this.layer,updatingHandles:this._updatingHandles}),this.addHandles([t(this._highlightHelper),i(()=>this.suspended,e=>this._highlightHelper.suspended=e,r)])}_initSubView(){this.addHandles([i(()=>this.layer.renderer,e=>this._recreateSubView(e),s)])}_recreateSubView(e){const t=\"flow\"===e?.type,i=\"flow\"===this.subView?.type,r=this.subView;r&&t===i||(this.subView=t?new n({layerView:this}):new l({layerView:this}),r?.destroy())}getFetchOptions(){return{timeExtent:this.timeExtent}}highlight(e,t){return this._highlightHelper.highlight(e,t)}isUpdating(){return super.isUpdating()||this._highlightHelper.updating}};e([o()],g.prototype,\"highlightOptions\",null),e([o()],g.prototype,\"pixelData\",null),g=e([a(\"esri.views.3d.layers.ImageryLayerView3D\")],g);const m=g;export{m as default};\n"],"names":["i","_e","_e$length","_e2","e","t","o","isCollection","toArray","Array","isArray","filter","r","length","w","updating","_this$graphicsView$up","_this$graphicsView","this","graphicsView","constructor","super","_highlightCounts","Map","_graphicsViewLoader","graphics","g","suspended","_symbols","u","size","style","color","d","width","m","outline","highlight","y","s","updatingHandles","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","_r","remove","preload","_this$_highlightCount","set","get","addMany","_removeHighlightGraphics","removeMany","_this$_highlightCount2","Math","max","delete","default","destroyed","view","layer","type","id","uid","elevationInfo","mode","getGraphics","drapeSourcePriorityOffset","_set","addHandles","h","p","map","_ref2","geometry","spatialReference","reduce","_i$at","at","equals","push","source","dest","n","_unused","c","cloneShallow","symbol","_unused2","a","prototype","l","f","arguments","timeExtent","_this$view","_get","fetchPopupFeaturesAtLocation","popupEnabled","getRequiredFields","index","rasterFields","partitions","name","startsWith","fields","outFields","outSpatialReference","resolution","returnTopmostRaster","showNoDataRecords","R","layerOptions","j","returnDomainValues","pixelSize","signal","queryVisibleRasters","getSourceScale","load","serviceRasterInfo","canResume","_this$timeExtent","isEmpty","readOnly","redrawDebounced","async","redraw","_redrawImage","initialize","basemapTerrain","ready","_initializeMaximumDataResolution","once","initial","on","maximumDataResolution","loaded","processResult","imageOrCanvasElement","image","document","createElement","pixelData","HTMLCanvasElement","Error","getContext","applyRenderer","applyFilter","pixelBlock","height","createImageData","data","getAsRGBA","putImageData","add","renderedTiles","triggerLoad","_updatePopupDrapeSource","removeHandles","hasHandles","drapeSourceType","updatePolicy","layerView","overlayManager","registerGeometryDrapeSource","unregisterDrapeSource","fetchDataAndGenerateStreamlines","needsMagnitude","workerHandle","getSimulationSettings","extent","simulationSettings","flowExtentInfo","flowData","startPositions","streamlines","generateStreamlines","Symbol","highlightOptions","_updatingHandles","refreshDebounced","_this$layer","exportImageServiceParameters","version","_this$layer2","renderer","_highlightHelper","_initSubView","_recreateSubView","_this$subView","subView","destroy","getFetchOptions","isUpdating"],"sourceRoot":""}