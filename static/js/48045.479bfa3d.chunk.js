"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[48045],{48045:(e,t,n)=>{n.r(t),n.d(t,{fromGeometries:()=>le,fromGeometry:()=>de,fromGeometryToGXGeometry:()=>ce,getSpatialReference:()=>ue,toGeometry:()=>he});var r=n(89379),i=n(97799),a=n(26871),s=n(82103),o=n(91523),u=n(63331);n(59739);function m(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:1,m_value:null},done:!1};if(this.m_i<this.m_keys.length){const e=this.m_bReturnKey,t=Math.trunc(this.m_i);return this.m_bReturnKey=!this.m_bReturnKey,this.m_i+=.5,e?{value:{m_token:5,m_value:this.m_keys[t]},done:!1}:{value:{m_token:6,m_value:this.m_o[this.m_keys[t]]},done:!1}}return{value:{m_token:3,m_value:null},done:!0}}function l(){if(-1===this.m_i)return this.m_i=0,{value:{m_token:2,m_value:null},done:!1};if(this.m_i<this.m_a.length){const e={value:{m_token:6,m_value:this.m_a[this.m_i++]},done:!1};return this.m_strict||void 0===e.value.m_value&&(e.value.m_value=Number.NaN),e}return{value:{m_token:4,m_value:null},done:!0}}class d{createJSONObjectIterator(e){return{m_iteratorType:"object",m_o:e,m_keys:this.m_options.strict?Object.keys(e):Object.keys(e).filter(t=>void 0!==e[t]),m_i:-1,m_bReturnKey:!0,next:m}}createJSONArrayIterator(e){return{m_iteratorType:"array",m_strict:this.m_options.strict,m_i:-1,m_a:e,next:l}}constructor(e,t){this.m_currentToken=0,this.m_options=t?(0,r.A)({},t):{strict:!0};const n=e;this.m_iteratorStack=[n instanceof Array?this.createJSONArrayIterator(n):this.createJSONObjectIterator(n)],this.m_nextFlatToken={m_value:null,m_token:0}}nextToken(){if(0===this.m_iteratorStack.length)return this.m_currentToken=0;switch(this.m_nextFlatToken=this.m_iteratorStack.at(-1).next().value,this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_currentToken=1;case 3:return this.m_iteratorStack.pop(),this.m_currentToken=3;case 2:return this.m_currentToken=2;case 4:return this.m_iteratorStack.pop(),this.m_currentToken=4;case 5:return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=5;case 6:if(this.m_nextFlatToken.m_value instanceof Array)return this.m_iteratorStack.push(this.createJSONArrayIterator(this.m_nextFlatToken.m_value)),this.nextToken();if(this.m_nextFlatToken.m_value instanceof Object)return this.m_iteratorStack.push(this.createJSONObjectIterator(this.m_nextFlatToken.m_value)),this.nextToken();if("number"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,Number.isSafeInteger(this.m_currentValue)&&this.m_currentValue>=(0,a.ar)()&&this.m_currentValue<=(0,a.i)()?this.m_currentToken=8:this.m_currentToken=7;if("string"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=6;if("boolean"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=this.m_nextFlatToken.m_value,this.m_currentToken=this.m_nextFlatToken.m_value?11:12;if("object"==typeof this.m_nextFlatToken.m_value)return this.m_currentValue=null,this.m_currentToken=10;(0,i.d)("unrecognized json element type")}return(0,i.d)("unrecognized json element type"),0}currentToken(){return this.m_currentToken}skipChildren(){if(0!==this.m_iteratorStack.length)switch(this.m_currentValue=void 0,this.m_nextFlatToken.m_token){case 1:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=3,void(this.m_currentToken=3);case 2:return this.m_iteratorStack.pop(),this.m_nextFlatToken.m_token=4,void(this.m_currentToken=4)}}currentString(){return 6!==this.m_currentToken&&5!==this.m_currentToken&&(0,i.a)("invalid token"),this.m_currentValue}currentDoubleValue(){return 7!==this.m_currentToken&&8!==this.m_currentToken&&(0,i.a)("invalid token"),this.m_currentValue}currentInt32Value(){return 8!==this.m_currentToken&&(0,i.a)("invalid token"),this.m_currentValue}currentInt64Value(){return(0,i.g)(0),0n}currentBoolValue(){return 12!==this.m_currentToken&&11!==this.m_currentToken&&(0,i.a)("invalid token"),this.m_currentValue}isError(){return 0}}class c{constructor(e){return this.m_buffer=null,this.m_view=null,this.m_sz=0,this.m_offset=0,this.m_bOwnsBuffer=!0,this.m_bLittleEndian=!0,this.m_element=new ArrayBuffer(8),this.m_elementBytes=new Uint8Array(this.m_element),this.m_elementView=new DataView(this.m_element),this.m_elementDouble=new Float64Array(this.m_element),this.m_elementFloat=new Float32Array(this.m_element),this.m_elementInt64=new BigInt64Array(this.m_element),this.m_elementInt32=new Int32Array(this.m_element),this.m_elementInt16=new Int16Array(this.m_element),void 0!==e.sz?(this.m_sz=e.sz,e.buffer?(this.m_sz<0&&(0,i.q)("size out of range"),this.m_buffer=e.buffer,this.m_offset=void 0!==e.offset?e.offset:0,this.m_view=void 0!==e.offset?new DataView(e.buffer,e.offset,e.sz):new DataView(this.m_buffer),this.m_bOwnsBuffer=!1,void(this.m_bLittleEndian=!0)):(this.m_sz<0&&(0,i.q)("size out of range"),void(this.m_sz>0&&(this.m_buffer=new ArrayBuffer(this.m_sz),this.m_view=new DataView(this.m_buffer))))):e.move?(this.m_sz=e.move.m_sz,this.m_buffer=e.move.m_buffer,this.m_view=e.move.m_view,this.m_bOwnsBuffer=e.move.m_bOwnsBuffer,this.m_bLittleEndian=e.move.m_bLittleEndian,e.move.m_buffer=null,e.move.m_view=null,e.move.m_sz=0,void(e.move.m_bOwnsBuffer=!0)):void(0,i.d)("unrecognized constructor options")}swapBytesDouble(){this.doSwap()&&(this.m_elementDouble[0]=this.m_elementBytes[0]<<56|this.m_elementBytes[1]<<48|this.m_elementBytes[2]<<40|this.m_elementBytes[3]<<32|this.m_elementBytes[4]<<24|this.m_elementBytes[5]<<16|this.m_elementBytes[6]<<8|this.m_elementBytes[7])}swapBytesInt32(){this.doSwap()&&(this.m_elementInt32[0]=this.m_elementBytes[0]<<24|this.m_elementBytes[1]<<16|this.m_elementBytes[2]<<8|this.m_elementBytes[3])}getOffset(){return this.m_offset}assignMove(e){return this===e||(this.clear(),this.m_sz=e.m_sz,this.m_buffer=e.m_buffer,this.m_view=e.m_view,this.m_bOwnsBuffer=e.m_bOwnsBuffer,this.m_bLittleEndian=e.m_bLittleEndian,e.m_buffer=null,e.m_sz=0,e.m_bOwnsBuffer=!0),this}doSwap(){return this.m_bLittleEndian!==(1===c.getNativeByteOrder())}setNativeByteOrder(){this.m_bLittleEndian=1===c.getNativeByteOrder()}setOrder(e){this.m_bLittleEndian=1===e}getOrder(){return this.m_bLittleEndian?1:0}getView(){return this.m_view||(0,i.p)("buffer not defined"),this.m_view}static getNativeByteOrder(){return 1}clear(){this.m_buffer=null,this.m_sz=0,this.m_bOwnsBuffer=!0}size(){return this.m_sz}readDouble(e){return this.doSwap()?(this.m_elementDouble[0]=this.m_view.getFloat64(e,this.m_bLittleEndian),this.swapBytesDouble(),this.m_elementDouble[0]):this.m_view.getFloat64(e,this.m_bLittleEndian)}writeDouble(e,t){this.m_elementDouble[0]=t,this.swapBytesDouble(),this.m_view.setFloat64(e,this.m_elementDouble[0],this.m_bLittleEndian)}readInt32(e){return this.doSwap()?(this.m_elementInt32[0]=this.m_view.getInt32(e,this.m_bLittleEndian),this.swapBytesInt32(),this.m_elementInt32[0]):this.m_view.getInt32(e,this.m_bLittleEndian)}writeInt32(e,t){this.m_elementInt32[0]=t,this.swapBytesInt32(),this.m_view.setInt32(e,this.m_elementInt32[0],this.m_bLittleEndian)}getPtr(){return this.m_buffer}setSizeNoRealloc(e){(0,i.g)(e>=0&&e<=this.m_sz),this.m_sz=e}}function h(e,t,n,a,s,m){let l=!1,d=!1,c=!1,h=!1,_=!1,N=!1,T=!1,v=!1,x=!1,A=!1,S=!1,w=!1,C=!1,D=!1,F=!1,j=!1,I=!1,O=!1,z=!1,E=!1,P=!1,G=!1,B=!1,V=!1,M=Number.NaN,R=Number.NaN,U=Number.NaN,W=Number.NaN,X=0,L=Number.NaN,Y=Number.NaN,K=Number.NaN,q=Number.NaN,J=Number.NaN,Z=Number.NaN,H=Number.NaN,Q=Number.NaN,$=0,ee=0,te=!1,ne=!1,re=null,ie=null,ae=null,se=null,oe=null;for(;3!==n.nextToken();){const r=n.currentString();if(n.nextToken(),"spatialReference"===r){if(s&&!l){l=!0,1===n.currentToken()?se=f(n):10!==n.currentToken()&&(0,i.a)("failed to parse spatial reference: object or null is expected");continue}}else if(a)if("hasZ"===r){if(!d){d=!0,te=11===n.currentToken();continue}}else if("hasM"===r){if(!c){c=!0,ne=11===n.currentToken();continue}}else if("rings"===r){if(!(_||N||e!==i.G.enumUnknown&&e!==i.G.enumPolygon)){_=!0,({geometry:oe,as:re,bs:ie}=p(!0,!1,t,n));continue}}else if("curveRings"===r){if(!N&&(e===i.G.enumUnknown||e===i.G.enumPolygon)){N=!0,({geometry:oe,as:re,bs:ie}=p(!0,!0,t,n));continue}}else if("paths"===r){if(!(T||v||e!==i.G.enumUnknown&&e!==i.G.enumPolyline)){T=!0,({geometry:oe,as:re,bs:ie}=p(!1,!1,t,n));continue}}else if("curvePaths"===r){if(!v&&(e===i.G.enumUnknown||e===i.G.enumPolyline)){v=!0,({geometry:oe,as:re,bs:ie}=p(!1,!0,t,n));continue}}else if("points"===r){if(!x&&(e===i.G.enumUnknown||e===i.G.enumMultiPoint)){x=!0,({geometry:oe,as:re,bs:ie}=k(t,n));continue}}else if("ids"===r){if(!h){h=!0,ae=b(t,n);continue}}else if("x"===r){if(!A&&(e===i.G.enumUnknown||e===i.G.enumPoint)){A=!0,M=y(n);continue}}else if("y"===r){if(!S&&(e===i.G.enumUnknown||e===i.G.enumPoint)){S=!0,R=y(n);continue}}else if("z"===r){if(!w&&(e===i.G.enumUnknown||e===i.G.enumPoint)){w=!0,U=y(n);continue}}else if("m"===r){if(!C&&(e===i.G.enumUnknown||e===i.G.enumPoint)){C=!0,W=y(n);continue}}else if("id"===r){if(!D&&(e===i.G.enumUnknown||e===i.G.enumPoint)){D=!0,X=g(n);continue}}else if("xmin"===r){if(!F&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){F=!0,L=y(n);continue}}else if("ymin"===r){if(!j&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){j=!0,Y=y(n);continue}}else if("mmin"===r){if(!P&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){P=!0,H=y(n);continue}}else if("zmin"===r){if(!z&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){z=!0,J=y(n);continue}}else if("idmin"===r){if(!B&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){B=!0,$=g(n);continue}}else if("xmax"===r){if(!I&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){I=!0,K=y(n);continue}}else if("ymax"===r){if(!O&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){O=!0,q=y(n);continue}}else if("mmax"===r){if(!G&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){G=!0,Q=y(n);continue}}else if("zmax"===r){if(!E&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){E=!0,Z=y(n);continue}}else if("idmax"===r){if(!V&&(e===i.G.enumUnknown||e===i.G.enumEnvelope)){V=!0,ee=g(n);continue}}else"materials"===r&&(0,i.g)(0);n.skipChildren()}if(_||N||T||v||x){let e=null,t=null;const n=oe;te&&(oe.addAttribute(1),e=re,e||(e=(0,o.D)(n.getPointCount(),Number.NaN))),ne&&(oe.addAttribute(2),t=te?ie:re),null!=ae&&oe.addAttribute(3),te&&null!=e&&n.setAttributeStreamRef(1,e),ne&&null!=t&&n.setAttributeStreamRef(2,t),null!=ae&&function(e,t){if(e.isEmpty())return;const n=(0,o.K)(2,0),r=e.getGeometryType();let a=0;r===u.M.type?a=1:r===u.P.type||r===u.a.type?a=e.getPathCount():(0,i.d)("not implemented"),n.resize(e.getPointCount(),0);let s=0;for(let o=0;o<a;++o){const a=t.read(s);s++;const m=s+a;let l=0,d=0;r===u.M.type?l=e.getPointCount():r===u.P.type||r===u.a.type?(l=e.getPathSize(o),d=e.getPathStart(o)):(0,i.d)("not implemented");for(let e=0,r=Math.min(a,l);e<r;++e)n.write(d,t.read(s)),s++,d++;s=m}e.getImpl().setAttributeStreamRef(3,n)}(n,ae)}else if(A||S||C||w||D){(0,o.I)(M,R)||(0,i.a)("failed to parse point: x and y must be finite or nan"),(Number.isNaN(R)||Number.isNaN(M))&&(M=Number.NaN,R=Number.NaN);const e=new o.P({x:M,y:R});w&&e.setZ(U),C&&e.setM(W),D&&e.setID(X),oe=e}else if(F||j||I||O||z||E||P||G||B||V){(Number.isNaN(Y)||Number.isNaN(K)||Number.isNaN(q))&&(L=Number.NaN);const e=new o.E({xmin:L,ymin:Y,xmax:K,ymax:q});z&&E&&e.setInterval(1,0,J,Z),P&&G&&e.setInterval(2,0,H,Q),B&&V&&e.setInterval(3,0,$,ee),oe=e}return(0,r.A)((0,r.A)({},oe?{geom:oe}:{}),se?{sr:se}:{})}function _(e){let t=!1;for(;3!==e.nextToken();){const n=e.currentString();e.nextToken(),"uwkid"===n?t||(t=!0,8===e.currentToken()&&e.currentInt32Value()):e.skipChildren()}return null}function f(e){let t=!1,n=!1,r=!1,i=!1,a=!1,o=!1,u=!1,m=!1,l=!1,d=!1,c=!1,h=!1,f=!1,p=!1,k=!1,b=!1,y=!1,g=-1,N=-1,T=-1,v=-1,x=0,A=0,S=0,w=0,C=0,D=0,F=0,j=0,I=0,O=0,z="",E="",P=null;for(;3!==e.nextToken();){const s=e.currentString();e.nextToken(),"wkid"===s?t||(t=!0,8===e.currentToken()&&(g=e.currentInt32Value())):"latestWkid"===s?n||(n=!0,8===e.currentToken()&&(N=e.currentInt32Value())):"wkt"===s?a||(a=!0,6===e.currentToken()&&(z=e.currentString())):"wkt2"===s?a||6===e.currentToken()&&(E=e.currentString()):"vcsWkid"===s?r||(r=!0,8===e.currentToken()&&(T=e.currentInt32Value())):"latestVcsWkid"===s?i||(i=!0,8===e.currentToken()&&(v=e.currentInt32Value())):"xyTolerance"===s?u||(u=!0,o=!0,x=e.currentDoubleValue()):"zTolerance"===s?m||(m=!0,o=!0,A=e.currentDoubleValue()):"mTolerance"===s?l||(l=!0,o=!0,S=e.currentDoubleValue()):"falseX"===s?d||(d=!0,o=!0,F=e.currentDoubleValue()):"falseY"===s?c||(c=!0,o=!0,j=e.currentDoubleValue()):"falseZ"===s?h||(h=!0,o=!0,I=e.currentDoubleValue()):"falseM"===s?f||(f=!0,o=!0,O=e.currentDoubleValue()):"xyUnits"===s?p||(p=!0,o=!0,w=e.currentDoubleValue()):"zUnits"===s?k||(k=!0,o=!0,C=e.currentDoubleValue()):"mUnits"===s?b||(b=!0,o=!0,D=e.currentDoubleValue()):"unit"===s?y||(y=!0,P=_(e)):e.skipChildren()}v<=0&&T>0&&(v=T),T<=0&&v>0&&(T=v);let G=null,B=!0;if(0!==z.length&&(B=!1,(0,s.aA)(z)&&(G=(0,s.a)(z))),G||0===E.length||(B=!1,(0,s.aA)(E)&&(G=(0,s.a)(E))),!G&&N>0&&(B=!1,(0,s.aB)(N)&&(v<=0||(0,s.aC)())&&(G=(0,s.c)(N,v))),!G&&g>0&&(B=!1,(0,s.aB)(g)&&(T<=0||(0,s.aC)())&&(G=(0,s.c)(g,T))),B&&(G=(0,s.R)(P)),o&&G){const e=new s.aD;G.queryPrecisionDescriptorWithoutFalseXY(e),u&&e.setTolerance(0,x),m&&e.setTolerance(1,A),l&&e.setTolerance(2,S),p&&d&&c&&e.setGridParams(F,j,w),k&&h&&e.setZParams(I,C),b&&f&&e.setMParams(O,D),G=(0,s.aE)(G,e)}return G}function p(e,t,n,r){2!==r.currentToken()&&(0,i.a)("failed to parse multipath: array of array of vertices is expected");const s=e?new u.a:new u.P,m=s,l=(0,o.y)(0),d=(0,o.D)(2,0),c=(0,o.z)(0);let h=null,_=null,f=null,p=null,k=null,b=0,g=0,x=0;const A=new u.S,S=a.P.getNAN();let w=0,C=0;const D=e?1:0;for(;4!==r.nextToken();){2!==r.currentToken()&&(0,i.a)("failed to parse multipath: ring/path array is expected");let n=2,s=0,F=!0;const j=4;let I=0,O=0;const z=a.P.getNAN(),E=(0,a.d)(j,Number.NaN),P=(0,a.d)(j,Number.NaN);let G=!1;for(r.nextToken();4!==r.currentToken();){if(t&&1===r.currentToken())F&&(0,i.a)("failed to parse multipath: starting vertex array is expected"),f||(f=(0,o.z)(w-1,1),p=(0,o.y)(w-1,-1),k=(0,o.D)(0)),G=!0,n=1,({segFlag:x,toPointSz:I}=v(A,E,S,r));else{for(G=!1,2!==r.currentToken()&&(0,i.a)("failed to parse multipath: array is expected, rings/paths vertices consist of arrays of coordinates"),I=0;4!==r.nextToken();)I===j&&(0,i.a)("failed to parse multipath: each vertex array has to have at most 4 elements"),E[I++]=y(r);I<2&&(0,i.a)("failed to parse multipath: each vertex array has to have at least 2 elements"),(0,o.J)(E[0],E[1])||(0,i.a)("failed to parse multipath: x and y must be finite")}r.nextToken();do{if(d.size()===2*w&&d.resize(N(w)),d.writePoint2D(2*w,z.setCoords(E[0],E[1])),h&&h.size()===w&&h.resize(T(w)),I>2?(h||(h=(0,o.D)(w+1,Number.NaN)),h.write(w,E[2])):h&&h.write(w,Number.NaN),_&&_.size()===w&&_.resize(T(w)),I>3?(_||(_=(0,o.D)(w+1,Number.NaN)),_.write(w,E[3])):_&&_.write(w,Number.NaN),F)C++,l.add(w),c.add(D),F=!1,O=I,(0,a.b)(P,E,0,0,O);else if(null!==f)if(G){const e=(0,u.H)(x),t=k.size();k.resize(t+e),f.add(x),p.add(b),A.get().writeInBufferStream(k,b),b+=e,m.incCurveType(x,1),g++}else f.add(1),p.add(-1);w++,s++,S.setCoords(E[0],E[1])}while(s<n&&4===r.currentToken())}0!==s&&(e&&s>n&&I===O&&0===(0,a.as)(E,P,I)?(w--,s--):null!==f&&(f.add(1),p.add(-1)))}return w&&(l.resize(C),c.resize(C),w>0&&(l.add(w),c.add(0)),m.setAttributeStreamRef(0,d),m.setPathFlagsStreamRef(c),m.setPathStreamRef(l),null!==f&&(m.updateCurveCounter(g),m.setSegmentData(p,k,f,b)),m.notifyModifiedFlags(65535)),{geometry:s,as:h,bs:_}}function k(e,t){2!==t.currentToken()&&(0,i.a)("failed to parse multipoint: array of vertices is expected");let n=0;const r=new u.M,s=(0,o.D)(2,0);let m=0;const l=(0,a.d)(4,Number.NaN),d=new a.P;let c=null,h=null;for(;4!==t.nextToken();){for(2!==t.currentToken()&&(0,i.a)("failed to parse multipoint: array is expected, multipoint vertices consist of arrays of cooridinates"),m=0;4!==t.nextToken();)4===m&&(0,i.a)("failed to parse multipoint: each vertex array has to have at most 4 elements"),l[m++]=y(t);m<2&&(0,i.a)("failed to parse multipoint: each vertex array has to have at least 2 elements"),(0,o.J)(l[0],l[1])||(0,i.a)("failed to parse multipoint: x and y must be finite"),s.size()===2*n&&s.resize(N(n)),s.writePoint2D(2*n,d.setCoords(l[0],l[1])),c&&c.size()===n&&c.resize(T(n)),m>2?(c||(c=(0,o.D)(n+1,Number.NaN)),c.write(n,l[2])):c&&c.write(n,Number.NaN),h&&h.size()===n&&h.resize(T(n)),m>3?(h||(h=(0,o.D)(n+1,Number.NaN)),h.write(n,l[3])):h&&h.write(n,Number.NaN),n++}if(n){const e=r.getImpl();e.setAttributeStreamRef(0,s),e.resizeNoInit(n),e.notifyModifiedFlags(65535)}return{geometry:r,as:c,bs:h}}function b(e,t){2!==t.currentToken()&&(0,i.a)("failed to parse array of IDs: array of array of integers is expected");const n=(0,o.K)(2,0);let r=0,a=-1;for(;4!==t.nextToken();){const e=r;n.size()===r&&n.resize(T(r)),r++;let s=0;for(-1===a?a=2===t.currentToken()?1:0:1===a&&2!==t.currentToken()&&(0,i.a)("failed to parse array of IDs: array of array of integers is expected"),0===a&&(n.size()===r&&n.resize(T(r)),n.write(r,g(t)),s++,r++);4!==t.nextToken();)n.size()===r&&n.resize(T(r)),n.write(r,g(t)),s++,r++;if(n.write(e,s),0===a)break}return n.resize(r),n}function y(e){const t=e.currentToken();if(10===t||6===t&&"NaN"===e.currentString())return Number.NaN;{const t=e.currentDoubleValue();return Number.isNaN(t)?Number.NaN:t}}function g(e){return e.currentInt32Value()}function N(e){let t=2*Math.trunc(3*(e+1)/2);return t<8?t=8:t<32&&(t=32),t}function T(e){let t=Math.trunc(3*(e+1)/2);return t<4?t=4:t<16&&(t=16),t}function v(e,t,n,r,s){const o={segFlag:0,toPointSz:0};let m=r.currentToken();m=r.nextToken();const l=r.currentString(),d=l[0];for((1!==l.length||"a"!==d&&"b"!==d&&"c"!==d&&"n"!==d&&"q"!==d)&&(0,i.a)('failed to parse curve: expecting "a", "b", "n", "q", or "c"'),m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for curve parameters"),m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for to point"),o.toPointSz=0;4!==r.nextToken();)4===o.toPointSz&&(0,i.a)("failed to parse curve: vertex array cannot have more than 4 elements"),t[o.toPointSz++]=y(r);o.toPointSz<2&&(0,i.a)("failed to parse curve: vertex array must have at least 2 elements");const h=a.P.construct(t[0],t[1]),_=a.P.getNAN();let f=-1,p=-1,k=!1,b=Number.NaN,g=Number.NaN,N=Number.NaN;const T=[a.P.getNAN(),a.P.getNAN(),a.P.getNAN()],v=a.P.getNAN();if("a"===d){m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for center point"),m=r.nextToken();const e=y(r);m=r.nextToken();const t=y(r);m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for center point"),_.setCoords(e,t),m=r.nextToken(),f=r.currentInt32Value(),m=r.nextToken(),p=r.currentInt32Value(),m=r.nextToken(),4!==m?(k=!1,b=y(r),m=r.nextToken(),g=y(r),m=r.nextToken(),N=y(r),m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for curve parameters")):k=!0,o.segFlag=4}else if("b"===d){for(let e=0;e<2;e++){m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for control point"),m=r.nextToken();const t=y(r);m=r.nextToken();const n=y(r);m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for control point"),T[e].setCoords(t,n)}m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=2}else if("n"===d){{m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for control point"),m=r.nextToken();const e=y(r);m=r.nextToken();const t=y(r);m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for control point"),T[0].setCoords(e,t)}m=r.nextToken();const e=y(r);m=r.nextToken();const t=y(r);m=r.nextToken();const n=y(r);T[1].setCoords(e,t),T[2].setCoords(n,n),m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=8}else if("q"===d){for(let e=0;e<1;e++){m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for control point"),m=r.nextToken();const t=y(r);m=r.nextToken();const n=y(r);m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for control point"),T[e].setCoords(t,n)}m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=16}else{m=r.nextToken(),2!==m&&(0,i.a)("failed to parse curve: start array is expected for interior point"),m=r.nextToken();const e=y(r);m=r.nextToken();const t=y(r);m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for interior point"),v.setCoords(e,t),m=r.nextToken(),4!==m&&(0,i.a)("failed to parse curve: end array is expected for curve parameters"),o.segFlag=4}if(m=r.nextToken(),3!==m&&(0,i.a)("failed to parse curve: end object is expected for curve"),"a"===d)if(e.createEllipticArc(),k){const t=!0;x(e.get(),n,h,_,t,f,p)}else!function(e,t,n,r,i,a,s,o,m){e.dropAllAttributes();const l=44,d=new ArrayBuffer(l),h=new c({sz:l,buffer:d});let _=0;h.writeDouble(_,r.x),_+=8,h.writeDouble(_,r.y),_+=8,h.writeDouble(_,s),_+=8,h.writeDouble(_,o),_+=8,h.writeDouble(_,m),_+=8;let f=0;a||(f|=2048),i&&(f|=4096),h.writeInt32(_,f),_+=4,function(e,t,n,r,i){e.m_bits=0,e.m_center.x=r.readDouble(i),e.m_center.y=r.readDouble(i+8),e.m_rotation=r.readDouble(i+16),e.m_semiMajorAxis=r.readDouble(i+24),e.m_minorMajorRatio=r.readDouble(i+32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y;const a=r.readInt32(i+40);if(1&a)return!1;let s=!!(64&a),o=!!(128&a);const m=!!(2048&a),l=!!(4096&a);!(512&a)&&!(1024&a)||o||(s=!0),o&&!t.equals(n)?(o=!1,s=!0):s&&t.equals(n)&&(o=!0,s=!1),o?(e.m_center.assign(t),e.m_startAngle=e.m_center.x,e.m_sweepAngle=e.m_center.y,(0,u.F)(e,Number.NaN,m,l),e.m_semiMajorAxis=0,e.m_interior.setCoordsPoint2D(t)):s?(e.m_center.setNAN(),e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,u.A)(e),e.queryCoord2D(.5,e.m_interior)):e.constructEllipticArcEndPointsCenter(t,n,e.m_semiMajorAxis,e.m_minorMajorRatio,e.m_rotation,!l,m,e.m_center),e.setProjectionBehavior(1),(0,u.A)(e)}(e,t,n,h,0)}(e.get(),n,h,_,f,p,b,g,N);else if("b"===d)e.createCubicBezier(),function(e,t,n,r){e.dropAllAttributes();const s=32,o=new ArrayBuffer(s),u=new c({sz:s,buffer:o});let m=0;u.writeDouble(m,r[0].x),m+=8,u.writeDouble(m,r[0].y),m+=8,u.writeDouble(m,r[1].x),m+=8,u.writeDouble(m,r[1].y),m+=8,function(e,t,n,r,s){(0,i.g)(s+32<=r.size()),e.m_cp=(0,a.m)(a.P,2),e.m_cp[0].x=r.readDouble(s),e.m_cp[0].y=r.readDouble(s+8),e.m_cp[1].x=r.readDouble(s+16),e.m_cp[1].y=r.readDouble(s+24),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,u,0)}(e.get(),n,h,T);else if("n"===d)e.createQuadraticRationalBezier(),function(e,t,n,r,i,a,s){e.dropAllAttributes();const o=40,u=new ArrayBuffer(o),m=new c({sz:o,buffer:u});let l=0;m.writeDouble(l,r.x),l+=8,m.writeDouble(l,r.y),l+=8,m.writeDouble(l,i),l+=8,m.writeDouble(l,a),l+=8,m.writeDouble(l,s),l+=8,function(e,t,n,r,i){e.m_cp.x=r.readDouble(i),e.m_cp.y=r.readDouble(i+8),e.m_weights[0]=r.readDouble(i+16),e.m_weights[1]=r.readDouble(i+24),e.m_weights[2]=r.readDouble(i+32),e.m_XStart=t.x,e.m_YStart=t.y,e.m_XEnd=n.x,e.m_YEnd=n.y}(e,t,n,m,0)}(e.get(),n,h,T[0],T[1].x,T[1].y,T[2].x);else if("q"===d)e.createQuadraticBezier(),e.get().construct(n,T[0],h);else{e.createEllipticArc();const t=!1;x(e.get(),n,h,v,t,-1,-1)}return o}function x(e,t,n,r,s,o,m){e.dropAllAttributes();const l=new ArrayBuffer(20),d=new c({sz:20,buffer:l});let h=0;d.writeDouble(h,r.x),h+=8,d.writeDouble(h,r.y),h+=8;let _=0;s?(m||(_|=8),o&&(_|=16)):_|=128,d.writeInt32(h,_),h+=4,function(e,t,n,r,s){s>=r.size()&&(0,i.q)("Byte_buffer out of range access"),e.m_bits=0,e.m_rotation=0,e.m_cosr=1,e.m_sinr=0,e.setStartXY(t),e.setEndXY(n);const o=a.P.getNAN();o.x=r.readDouble(s),o.y=r.readDouble(s+8);const m=r.readInt32(s+16);if(1&m)return e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.assign(o),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,u.A)(e),!1;let l=!!(64&m);const d=!!(128&m);let c=!!(32&m);const h=!!(8&m),_=!!(16&m),f=t.equals(n);l&&!f&&(l=!1,c=!0),c&&f&&(l=!0,c=!1,o.setCoords(0,0)),l||(d?c?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_interior.assign(o),e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0):(e.constructCircularArcThreePoint(t,n,o),f&&h===e.isClockwise()&&e.reverse()):c?(e.m_semiMajorAxis=1,e.m_minorMajorRatio=0,e.m_center.setNAN(),e.m_sweepAngle=0,e.m_startAngle=0,(0,u.A)(e),e.queryCoord2D(.5,e.m_interior)):(0,u.B)(e,t,n,o,h,_)),l&&(e.m_center.assign(t),e.m_startAngle=o.x,e.m_sweepAngle=o.y,(0,u.F)(e,Number.NaN,h,_),e.m_semiMajorAxis=0,e.m_minorMajorRatio=1,e.m_interior.setCoordsPoint2D(t)),e.setProjectionBehavior(0),(0,u.A)(e)}(e,t,n,d,0)}function A(e,t,n,r,a){const s=e.getGeometryType();if(s===i.G.enumEllipticArc)return function(e,t,n,r,a){(0,i.g)(!(0,u.z)(e));const s=e.getEndXY(),o=e.hasAttribute(1)&&!t,m=e.hasAttribute(2)&&!n;let l=Number.NaN,d=Number.NaN;if(o&&(l=e.getEndAttributeAsDbl(1,0)),m&&(d=e.getEndAttributeAsDbl(2,0)),e.isDegenerateToLine()||e.isDegenerate(0))return w(o,m,s.x,s.y,l,d,r,a),!0;const c=0===e.projectionBehavior(),h=!!c&&e.isClosed();if(c&&!h)a.startObject(),a.addFieldName("c"),a.startArray(),w(o,m,s.x,s.y,l,d,r,a),C(e.m_interior.x,e.m_interior.y,17,a),a.endArray(),a.endObject();else if(c){a.startObject(),a.addFieldName("a"),a.startArray(),w(o,m,s.x,s.y,l,d,r,a);const t=0,n=0;C(e.m_center.x+t,e.m_center.y+n,17,a);const i=!e.isMajor();a.addInt32(i?1:0);const u=e.isClockwise();a.addInt32(u?1:0),a.endArray(),a.endObject()}else{a.startObject(),a.addFieldName("a"),a.startArray(),w(o,m,s.x,s.y,l,d,r,a);const t=e;C(t.m_center.x,t.m_center.y,17,a);const n=!t.isMajor();a.addInt32(n?1:0);const i=t.isClockwise();a.addInt32(i?1:0),a.addDouble(t.m_rotation,17),a.addDouble(t.m_semiMajorAxis,17),a.addDouble(t.m_minorMajorRatio,17),a.endArray(),a.endObject()}return!1}(e,t,n,r,a);if(s===i.G.enumBezier)return S(e,t,n,r,a);if(s===i.G.enumRationalBezier2)return function(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("n"),i.startArray(),w(s,o,a.x,a.y,u,m,r,i),C(e.m_cp.x,e.m_cp.y,r,i);const l=r;return i.addDouble(e.m_weights[0],l),i.addDouble(e.m_weights[1],l),i.addDouble(e.m_weights[2],l),i.endArray(),i.endObject(),!1}(e,t,n,r,a);if(s===i.G.enumBezier2){const i=new u.y;return i.constructFromQuadraticSegment(e),S(i,t,n,r,a)}(0,i.t)("")}function S(e,t,n,r,i){const a=e.getEndXY(),s=e.hasAttribute(1)&&!t,o=e.hasAttribute(2)&&!n;let u=Number.NaN,m=Number.NaN;return s&&(u=e.getEndAttributeAsDbl(1,0)),o&&(m=e.getEndAttributeAsDbl(2,0)),i.startObject(),i.addFieldName("b"),i.startArray(),w(s,o,a.x,a.y,u,m,r,i),C(e.m_cp[0].x,e.m_cp[0].y,r,i),C(e.m_cp[1].x,e.m_cp[1].y,r,i),i.endArray(),i.endObject(),!1}function w(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}function C(e,t,n,r){r.startArray(),r.addDouble(e,n),r.addDouble(t,n),r.endArray()}function D(e,t,n,r){const a=n.getImpl(),s=!!(2&t),m=!!(4&t),l=!!(8&t),d=a.hasAttribute(1)&&!s,c=a.hasAttribute(2)&&!m,h=a.hasAttribute(3)&&!l,_=a.hasNonLinearSegments();d&&(r.addFieldName("hasZ"),r.addBool(!0)),c&&(r.addFieldName("hasM"),r.addBool(!0)),e?_?r.addFieldName("curveRings"):r.addFieldName("rings"):_?r.addFieldName("curvePaths"):r.addFieldName("paths");let f=null;const p=[];if(n.isEmpty())r.startArray(),r.endArray();else{const e=17-(31&t>>13);r.startArray();const l=n.getPathCount();let k=0;const b=a.getAttributeStreamRef(0);let y=null,g=null,N=null;const T=new u.S;let v=null,x=null,S=null;_&&(v=a.getSegmentFlagsStreamRef(),x=a.getSegmentIndexStreamRef(),S=a.getSegmentDataStreamRef()),d&&(y=a.getAttributeStreamRef(1)),c&&(g=a.getAttributeStreamRef(2)),h&&(N=a.getAttributeStreamRef(3),f=(0,o.t)(3,0));for(let t=0;t<l;t++){r.startArray(),h&&p.push(0);const a=n.getPathEnd(t);if(k===a){r.endArray();continue}const o=n.isClosedPath(t);let u=b.read(2*k),l=b.read(2*k+1),_=d?y.read(k):Number.NaN,w=c?g.read(k):Number.NaN,C=h?N.read(k):0;F(d,c,u,l,_,w,e,r);let D=1;h&&(f.add(C),p[p.length-1]++);const j=u,I=l,O=_,z=w,E=C;let P=!1,G=0,B=Number.NaN,V=Number.NaN,M=0;for(let t=k+1,n=k,R=o?a+1:a;t<R;t++,n++){const o=null!==v?31&v.read(n):1;let k,R;if(t<a?(k=b.read(2*t),R=b.read(2*t+1),d&&(B=y.read(t)),c&&(V=g.read(t)),h&&(M=N.read(t))):(k=j,R=I,B=O,V=z,M=E),1!==o){P=!0,4===o?T.createEllipticArc():2===o?T.createCubicBezier():16===o?T.createQuadraticBezier():8===o?T.createQuadraticRationalBezier():(0,i.t)("JSON export.unsupported curve");const t=T.get(),a=x.read(n);t.setStartXYCoords(u,l),t.setEndXYCoords(k,R),d&&(t.setStartAttribute(1,0,_),t.setEndAttribute(1,0,B)),c&&(t.setStartAttribute(2,0,w),t.setEndAttribute(2,0,V)),t.readFromBufferStream(S,a),A(T.get(),s,m,e,r)&&G++}else F(d,c,k,R,B,V,e,r);h&&(f.add(M),p[p.length-1]++),D++,u=k,l=R,_=B,w=V,C=M}P&&0===G||(D<2&&G<1&&(F(d,c,u,l,_,w,e,r),D++,h&&(f.add(C),p[p.length-1]++)),o&&D<3&&G<2&&(F(d,c,j,I,O,z,e,r),D++,u=j,l=I,_=O,w=z,C=E,h&&(f.add(E),p[p.length-1]++))),r.endArray(),k=a}r.endArray()}if(h){r.addFieldName("ids"),r.startArray();let e=0;for(let t=0,n=p.length;t<n;++t){const n=p[t];(0,i.g)(0===n||null!==f&&e+n<=f.size()),r.startArray();for(let t=0;t<n;++t)r.addInt32(f.read(e)),e++;r.endArray()}r.endArray()}}function F(e,t,n,r,i,a,s,o){o.startArray(),o.addDouble(n,s),o.addDouble(r,s),e&&o.addDouble(i,s),t&&o.addDouble(a,s),o.endArray()}const j="a".charCodeAt(0),I="A".charCodeAt(0),O="*".charCodeAt(0),z="b".charCodeAt(0),E="\\".charCodeAt(0),P="[".charCodeAt(0),G="{".charCodeAt(0),B=":".charCodeAt(0),V=".".charCodeAt(0),M=",".charCodeAt(0),R='"'.charCodeAt(0),U="]".charCodeAt(0),W="}".charCodeAt(0),X="e".charCodeAt(0),L="E".charCodeAt(0),Y="f".charCodeAt(0),K="F".charCodeAt(0),q="/".charCodeAt(0),J="-".charCodeAt(0),Z="+".charCodeAt(0),H="n".charCodeAt(0),Q="N".charCodeAt(0),$="r".charCodeAt(0),ee="t".charCodeAt(0),te="u".charCodeAt(0),ne="0".charCodeAt(0),re="9".charCodeAt(0);class ie{constructor(e){this.m_functionStack=[],this.m_pushPositions=[],this.m_utf8Decoder=new TextDecoder("utf-8",{fatal:!0}),void 0===e?(this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_endToken=0,this.m_currentTokenType=0,this.m_functionStack.push(()=>this.accept_()),this.m_jsonString=null,this.m_bHasEscapes=!1):e.jsonString?this.resetParserFromString(e.jsonString):e.jsonStream?(0,i.t)("streaming json parsing not yet impl"):(0,i.d)("invalid constructor parameter")}prepSubstrString_(){}getCurrentSubstrString_(){return this.m_jsonString.slice(this.m_startToken,this.m_endToken)}stepOverCharString_(){this.m_endToken++}peekCharString_(){return this.m_jsonString.charCodeAt(this.m_endToken)}getString_(e){var t;const n=null===(t=this.m_jsonString)||void 0===t?void 0:t.slice(this.m_startToken,this.m_startToken+e-1);return this.m_endToken+=e-1,{s:n,bDone:this.m_endToken>=this.m_jsonString.length}}incrementString_(){this.m_endToken++}eofString_(){return this.m_endToken>=this.m_jsonString.length}setStringFunctions_(){this.m_prepSubstr=this.prepSubstrString_,this.m_getCurrentSubstr=this.getCurrentSubstrString_,this.m_stepOverChar=this.stepOverCharString_,this.m_peekChar=this.peekCharString_,this.m_get=this.getString_,this.m_increment=this.incrementString_,this.m_eof=this.eofString_}setStreamFunctions_(){(0,i.t)("streaming json parsing not yet impl")}reset_(){this.m_jsonString=null,this.m_endToken=0,this.m_startToken=Number.MAX_SAFE_INTEGER,this.m_currentTokenType=0,this.m_bHasEscapes=!1,this.m_functionStack.length=0,this.m_functionStack.push(()=>this.start_()),this.m_pushPositions.length=0}resetParserFromString(e){this.reset_(),this.setStringFunctions_(),this.m_jsonString=e}resetParserFromStream(e){(0,i.t)("streaming json parsing not yet impl")}resetToPosition(e){return!!this.m_jsonString&&(this.m_endToken=e,this.m_startToken=Number.MAX_VALUE,this.m_currentTokenType=0,this.m_functionStack.length=0,e>=this.m_jsonString.length?(this.m_functionStack.push(()=>this.accept_()),!1):(this.m_functionStack.push(()=>this.start_()),!0))}nextToken(){return this.m_functionStack.at(-1)(),this.m_currentTokenType}currentToken(){return this.m_currentTokenType}currentTokenStartIndex(){return this.m_startToken}currentTokenEndIndex(){return this.m_endToken}currentText(){return(0,i.g)(0),""}childrenAsString(){return(0,i.g)(0),""}skipChildren(){this.skipChildren_()}skipChildren_(){if(1!==this.m_currentTokenType)if(2!==this.m_currentTokenType);else{let e=1;do{this.m_currentTokenType=this.nextToken(),2===this.m_currentTokenType?e++:4===this.m_currentTokenType&&e--}while(4!==this.m_currentTokenType||0!==e)}else{let e=1;do{this.m_currentTokenType=this.nextToken(),1===this.m_currentTokenType?e++:3===this.m_currentTokenType&&e--}while(3!==this.m_currentTokenType||0!==e)}}currentTerminalAsString_(){switch(this.m_currentTokenType){case 7:case 8:case 9:return this.m_getCurrentSubstr().slice(0,this.m_endToken-this.m_startToken);case 10:return"null";case 11:return"true";case 12:return"false"}(0,i.a)("invalid token")}toUTF8_(e,t){let n=0,r=e;for(;t.charCodeAt(r)===E&&t.charCodeAt(r+1)===te;)n++,r+=6;r=e;const i=new Uint8Array(n);let a=0;for(;t.charCodeAt(r)===E&&t.charCodeAt(r+1)===te;)i[a++]=Number.parseInt(t.slice(r+2,r+6),16),r+=6;return{u8s:this.m_utf8Decoder.decode(i),end:r}}unquoteCurrentString_(){let e="",t=1;const n=this.m_endToken-this.m_startToken-1;let r=0;const i=this.m_getCurrentSubstr();for(let a=t;a<n;a++)if(i.charCodeAt(a)!==E)r++;else{switch(r>0&&(e+=i.slice(t,t+r)),i.charCodeAt(++a)){case R:e+='"';break;case te:{const{u8s:t,end:n}=this.toUTF8_(a-1,i);a=n-1,e+=t;break}case E:e+="\\";break;case q:e+="/";break;case z:e+="\b";break;case Y:e+="\f";break;case H:e+="\n";break;case $:e+="\r";break;case ee:e+="\t"}t=a+1,r=0}return r>0&&(e+=i.slice(t,t+r)),e}currentString(){return 5!==this.m_currentTokenType&&6!==this.m_currentTokenType?this.currentTerminalAsString_():this.m_bHasEscapes?this.unquoteCurrentString_():this.m_getCurrentSubstr().slice(1,this.m_endToken-this.m_startToken-2+1)}currentDoubleValue(){if(7!==this.m_currentTokenType&&8!==this.m_currentTokenType&&9!==this.m_currentTokenType&&6!==this.m_currentTokenType&&10!==this.m_currentTokenType&&(0,i.a)("invalid token"),10===this.m_currentTokenType)return Number.NaN;let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;if(6===this.m_currentTokenType){if("NaN"===this.currentString())return Number.NaN;e=e.slice(1),t-=2,0===t&&(0,i.a)("invalid token")}const n=Number.parseFloat(e);if(6===this.m_currentTokenType)Number.isNaN(n)&&(0,i.a)("invalid token");else if(Number.isNaN(n))return Number.NaN;return n}currentInt32Value(){8!==this.m_currentTokenType&&6!==this.m_currentTokenType&&(0,i.a)("invalid token");let e=this.m_getCurrentSubstr(),t=this.m_endToken-this.m_startToken;6===this.m_currentTokenType&&(e=e.slice(1),t-=2,0===t&&(0,i.a)("invalid token"));const n=parseInt(e);return Number.isNaN(n)&&(0,i.a)("invalid token"),n}currentInt64Value(){return(0,i.g)(0),0n}currentBoolValue(){return(0,i.g)(0),!1}isError(){return 0}JSONString(){return(0,i.g)(0),""}pushPosition(){return(0,i.g)(0),!1}popPosition(){return(0,i.g)(0),!1}skipCStyleComments_(){(0,i.g)(0)}skipCppStyleComments_(){(0,i.g)(0)}skipComments_(){this.m_prepSubstr();let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar(),e===O?this.skipCStyleComments_():e===q?this.skipCppStyleComments_():(0,i.a)("invalid token")}skipWhiteSpace_(){let e;do{this.m_eof()&&(0,i.a)("invalid token");let t=this.m_peekChar();for(;t>=9&&t<=13||32===t;)this.m_increment(),this.m_eof()&&(0,i.a)("invalid token"),t=this.m_peekChar();t===q?(this.m_startToken=this.m_endToken,e=!0,this.skipComments_()):e=!1}while(e)}rightBracket_(){return this.m_peekChar()===U&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=4,!0)}rightBrace_(){return this.m_peekChar()===W&&(this.m_startToken=this.m_endToken,this.m_increment(),this.m_currentTokenType=3,!0)}string_(){this.m_prepSubstr(),this.m_bHasEscapes=!1,this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token");let e=this.m_peekChar();for(;e!==R;){const t=e===E;if(this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar(),t)if(this.m_bHasEscapes=!0,e===R||e===E||e===q||e===z||e===Y||e===H||e===$||e===ee)this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar();else if(e===te)for(let n=0;n<4;n++)this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar(),e>=ne&&e<=re||e>=j&&e<=Y||e>=I&&e<=K||(0,i.a)("invalid token");else(0,i.a)("invalid token")}this.m_stepOverChar()}comma_(){return this.m_peekChar()===M&&(this.m_increment(),!0)}colon_(){return this.m_peekChar()===B&&(this.m_increment(),!0)}fieldNameEnd_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.colon_()?(this.skipWhiteSpace_(),this.value_()):(0,i.a)("invalid token")}fieldNameStart_(){this.m_startToken=this.m_endToken,this.m_peekChar()!==R&&(0,i.a)("invalid token"),this.string_(),this.m_currentTokenType=5,this.m_functionStack.push(()=>this.fieldNameEnd_())}pairEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.fieldNameStart_()):this.rightBrace_()?this.m_functionStack.pop():(0,i.a)("invalid token")}arrayStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBracket_()||(this.m_functionStack.push(()=>this.elementEnd_()),this.value_())}elementEnd_(){this.skipWhiteSpace_(),this.comma_()?(this.skipWhiteSpace_(),this.value_()):this.rightBracket_()?this.m_functionStack.pop():(0,i.a)("invalid token")}objectStart_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.rightBrace_()||(this.m_functionStack.push(()=>this.pairEnd_()),this.fieldNameStart_())}valueStartObject_(){this.m_increment(),this.m_currentTokenType=1,this.m_functionStack.push(()=>this.objectStart_())}valueStartArray_(){this.m_increment(),this.m_currentTokenType=2,this.m_functionStack.push(()=>this.arrayStart_())}valueString_(){this.string_(),this.m_currentTokenType=6}int_(){this.m_peekChar()!==ne?this.digits_():this.m_stepOverChar()}digits_(){let e=this.m_peekChar();do{this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar()}while(e>=ne&&e<=re)}frac_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar(),e>=ne&&e<=re||(0,i.a)("invalid token"),this.digits_()}exp_(){let e=this.m_peekChar();this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar(),e!==Z&&e!==J||(this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),e=this.m_peekChar()),e>=ne&&e<=re||(0,i.a)("invalid token"),this.digits_()}valueNumber_(){this.m_prepSubstr();let e=!1,t=this.m_peekChar();if(t===J?(this.m_stepOverChar(),this.m_eof()&&(0,i.a)("invalid token"),t=this.m_peekChar(),e=!0,t>=ne&&t<=re||(0,i.a)("invalid token"),this.int_()):this.int_(),t=this.m_peekChar(),t===V)this.m_currentTokenType=7,this.frac_(),t=this.m_peekChar(),t!==X&&t!==L||this.exp_();else if(t===X||t===L)this.m_currentTokenType=7,this.exp_();else{let t=0;e&&t++;const n=this.m_endToken-this.m_startToken-t;if(n<10)this.m_currentTokenType=8;else if(10===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="2147483648"?this.m_currentTokenType=8:this.m_currentTokenType=9:n.slice(t)<="2147483647"?this.m_currentTokenType=8:this.m_currentTokenType=9}else if(n<19)this.m_currentTokenType=9;else if(19===n){const n=this.m_getCurrentSubstr();e?n.slice(t)<="9223372036854775808"?this.m_currentTokenType=9:this.m_currentTokenType=7:n.slice(t)<="9223372036854775807"?this.m_currentTokenType=9:this.m_currentTokenType=7}else this.m_currentTokenType=7}}valueNull_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,i.a)("invalid token"),"null"!==e&&(0,i.a)("invalid token"),this.m_currentTokenType=10}valueTrue_(){const{s:e,bDone:t}=this.m_get(5);t&&(0,i.a)("invalid token"),"true"!==e&&(0,i.a)("invalid token"),this.m_currentTokenType=11}valueFalse_(){const{s:e,bDone:t}=this.m_get(6);t&&(0,i.a)("invalid token"),"false"!==e&&(0,i.a)("invalid token"),this.m_currentTokenType=12}valueNan_(){const{s:e,bDone:t}=this.m_get(4);t&&(0,i.a)("invalid token"),"NaN"!==e&&(0,i.a)("invalid token"),this.m_currentTokenType=7}value_(){this.m_startToken=this.m_endToken;const e=this.m_peekChar();e===G?this.valueStartObject_():e===P?this.valueStartArray_():e===R?this.valueString_():e===J||e>=ne&&e<=ne+9?this.valueNumber_():e===H?this.valueNull_():e===ee?this.valueTrue_():e===Y?this.valueFalse_():e===Q?this.valueNan_():(0,i.a)("invalid token")}start_(){this.skipWhiteSpace_(),this.m_functionStack.pop(),this.m_functionStack.push(()=>this.accept_());const e=this.m_peekChar();e!==G&&e!==P&&(0,i.a)("invalid token"),this.value_()}accept_(){this.m_startToken=this.m_endToken,this.m_currentTokenType=0}}const ae=new class{constructor(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject=[]}reset(){this.m_pendingKey=null,this.m_acceptedObject=null,this.m_currentObject.length=0}startObject(){const e={};this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}startArray(){const e=[];this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):Array.isArray(this.m_currentObject.at(-1))&&this.m_currentObject.at(-1).push(e),this.m_currentObject.push(e)}endObject(){this.m_acceptedObject=this.m_currentObject.at(-1),this.m_currentObject.pop()}endArray(){this.m_currentObject.pop()}addFieldName(e){this.m_pendingKey=e}addValue_(e){this.m_pendingKey?(this.m_currentObject.at(-1)[this.m_pendingKey]=e,this.m_pendingKey=null):this.m_currentObject.at(-1).push(e)}addString(e){this.addValue_(e)}addDouble(e,t){this.addValue_(e)}addInt64(e){(0,i.g)(0)}addInt32(e){this.addValue_(e)}addBool(e){this.addValue_(e)}addNull(){this.addValue_(null)}getObject(){return this.m_acceptedObject}},se=new class{getOperatorType(){return 10405}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,r,a,o){!function(e,t,n,r){if(t||n){if(r.startObject(),null!==t)switch(t.getGeometryType()){case i.G.enumPolygon:D(!0,e,t,r);break;case i.G.enumPolyline:D(!1,e,t,r);break;case i.G.enumMultiPoint:!function(e,t,n){const r=t.getImpl(),a=r.hasAttribute(1)&&!(2&e),s=r.hasAttribute(2)&&!(4&e),o=r.hasAttribute(3)&&!(8&e);a&&(n.addFieldName("hasZ"),n.addBool(!0)),s&&(n.addFieldName("hasM"),n.addBool(!0)),n.addFieldName("points");const u=t.getPointCount();if(t.isEmpty())n.startArray(),n.endArray();else{const t=17-(31&e>>13);n.startArray();const i=r.getAttributeStreamRef(0);let o=null,m=null;a&&(o=r.getAttributeStreamRef(1)),s&&(m=r.getAttributeStreamRef(2));for(let e=0;e<u;e++){const r=i.read(2*e),u=i.read(2*e+1);let l=Number.NaN,d=Number.NaN;a&&(l=o.read(e)),s&&(d=m.read(e)),F(a,s,r,u,l,d,t,n)}n.endArray()}if(o){let e=null;r.isEmpty()||(e=r.getAttributeStreamRef(3)),(0,i.g)(0===u||null!==e&&e.size()>=u),n.addFieldName("ids"),n.startArray();for(let t=0;t<u;t++)n.addInt32(e.read(t));n.endArray()}}(e,t,r);break;case i.G.enumPoint:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("x"),n.addNull(),n.addFieldName("y"),n.addNull(),r&&(n.addFieldName("z"),n.addNull()),i&&(n.addFieldName("m"),n.addNull()),void(a&&(n.addFieldName("id"),n.addInt32(0)));const s=17-(31&e>>13);n.addFieldName("x"),n.addDouble(t.getX(),s),n.addFieldName("y"),n.addDouble(t.getY(),s),r&&(n.addFieldName("z"),n.addDouble(t.getZ(),s)),i&&(n.addFieldName("m"),n.addDouble(t.getM(),s)),a&&(n.addFieldName("id"),n.addInt32(t.getID()))}(e,t,r);break;case i.G.enumEnvelope:!function(e,t,n){const r=t.hasAttribute(1)&&!(2&e),i=t.hasAttribute(2)&&!(4&e),a=t.hasAttribute(3)&&!(8&e);if(t.isEmpty())return n.addFieldName("xmin"),n.addNull(),n.addFieldName("ymin"),n.addNull(),n.addFieldName("xmax"),n.addNull(),n.addFieldName("ymax"),n.addNull(),r&&(n.addFieldName("zmin"),n.addNull(),n.addFieldName("zmax"),n.addNull()),i&&(n.addFieldName("mmin"),n.addNull(),n.addFieldName("mmax"),n.addNull()),void(a&&(n.addFieldName("idmin"),n.addInt32(0),n.addFieldName("idmax"),n.addInt32(0)));const s=17-(31&e>>13);if(n.addFieldName("xmin"),n.addDouble(t.getXMin(),s),n.addFieldName("ymin"),n.addDouble(t.getYMin(),s),n.addFieldName("xmax"),n.addDouble(t.getXMax(),s),n.addFieldName("ymax"),n.addDouble(t.getYMax(),s),r){const e=t.queryInterval(1,0);n.addFieldName("zmin"),n.addDouble(e.vmin,s),n.addFieldName("zmax"),n.addDouble(e.vmax,s)}if(i){const e=t.queryInterval(2,0);n.addFieldName("mmin"),n.addDouble(e.vmin,s),n.addFieldName("mmax"),n.addDouble(e.vmax,s)}if(a){const e=t.queryInterval(3,0);n.addFieldName("idmin"),n.addInt32(e.vmin),n.addFieldName("idmax"),n.addInt32(e.vmax)}}(e,t,r);break;case i.G.enumMultipatch:(0,i.g)(0);break;default:(0,i.d)("exportToJSON")}null!==n&&(r.addFieldName("spatialReference"),function(e,t,n){n.startObject();let r=0;t.isCustomWkid()||(r=t.getOldID());let a=0;const o=t.getVCS();if(null!==o&&(o.isCustomWkid()||(a=o.getOldID()),a<=0&&(r=0)),r>0){n.addFieldName("wkid"),n.addInt32(r);const e=t.getLatestID();if(e>0&&e!==r&&(n.addFieldName("latestWkid"),n.addInt32(e)),a>0){n.addFieldName("vcsWkid"),n.addInt32(a);const e=t.getLatestVerticalID();e!==a&&(n.addFieldName("latestVcsWkid"),n.addInt32(e))}}if(0===t.getCoordinateSystemType())n.addFieldName("wkid"),n.addNull(),null!==t.getUnit()&&(n.addFieldName("unit"),function(e,t,n){n.startObject();const r=t.getID();r<=0&&(0,i.a)("cannot export unit that has no valid WKID"),n.addFieldName("uwkid"),n.addInt32(r),n.endObject()}(0,t.getUnit(),n));else if(r<=0||1&e){let r="";64&e&&(r=t.getText2(),n.addFieldName("wkt2"),n.addString(r));const i=t.getText();i!==r&&(n.addFieldName("wkt"),n.addString(i))}if(16&e){const e=new s.aD;t.queryPrecisionDescriptor(e),n.addFieldName("xyTolerance"),n.addDouble(e.getTolerance(0)),n.addFieldName("zTolerance"),n.addDouble(e.getTolerance(1)),n.addFieldName("mTolerance"),n.addDouble(e.getTolerance(2)),n.addFieldName("falseX"),n.addDouble(e.getFalseX()),n.addFieldName("falseY"),n.addDouble(e.getFalseY()),n.addFieldName("xyUnits"),n.addDouble(e.getGridUnitsXY()),n.addFieldName("falseZ"),n.addDouble(e.getFalseZ()),n.addFieldName("zUnits"),n.addDouble(e.getGridUnitsZ()),n.addFieldName("falseM"),n.addDouble(e.getFalseM()),n.addFieldName("mUnits"),n.addDouble(e.getGridUnitsM())}n.endObject()}(e,n,r)),r.endObject()}}(e,t,n,r)}exportSpatialReference(e,t,n,r){(0,i.g)(0)}exportProjectionTransformation(e,t,n,r){(0,i.g)(0)}exportDatumTransformation(e,t,n,r){(0,i.g)(0)}static geometryTypeToString(e){return(0,i.g)(0),""}},oe=new class{getOperatorType(){return 10404}accelerateGeometry(e,t,n){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,t,n,r,a,o,u){let m;"string"==typeof n?(m=new ie({jsonString:n}),m.nextToken()):m=n,1!==m.currentToken()&&(0,i.a)("failed to import map geometry: start of object is expected");const l=h(t,e,m,r,a);return new s.aF(l)}importSpatialReference(e){const t=f(e);return null===t&&(0,i.d)("failed to import spatial reference"),t}importProjectionTransformation(e,t){return(0,i.g)(0),{}}importDatumTransformation(e,t){return(0,i.g)(0),{}}static stringToGeometryType(e){return(e=e.toLowerCase()).startsWith("esrigeometry")||(0,i.a)("string_to_geometry_type"),e.endsWith("point")?i.G.enumPoint:e.endsWith("envelope")?i.G.enumEnvelope:e.endsWith("multipoint")?i.G.enumMultiPoint:e.endsWith("polyline")?i.G.enumPolyline:e.endsWith("polygon")?i.G.enumPolygon:void(0,i.a)("string_to_geometry_type")}};function ue(e){return Array.isArray(e)?e[0].spatialReference:e.spatialReference}function me(e,t){const n=new d(e,{strict:!1});return n.nextToken(),oe.execute(0,i.G.enumUnknown,n,!0,t)}function le(e){let t=null;return[e.map(e=>{if(null==t){const n=de(e);return t=n.getSpatialReference(),n.getGeometry()}return ce(e)}),t]}function de(e){return me(e,!0)}function ce(e){return me(e,!1).getGeometry()}function he(e,t){var n;return e instanceof s.aF&&(t=e.getSpatialReference(),e=e.getGeometry()),null!==(n=e)&&void 0!==n&&n.isEmpty()?null:(ae.reset(),se.execute(0,e,t,ae),ae.getObject())}},59739:(e,t,n)=>{n(21557),n(97799),n(63331),n(91523),n(26871);var r=n(82103),i=n(31633),a=n(80963);(0,r.i)(e=>{let t,n;"number"==typeof e?t=e:n=e;const r={wkid:t,wkt:n};let s,o;if(n){s=(0,i.x1)(n);const e=(0,a.EA)(r);if(!s&&!e)throw new Error("Unsupported WKT type: ".concat(n))}else s=!(0,a.EA)(r);return o=t&&i.yD.has(t)?Math.PI/200:s?(0,i.Ao)(r):Math.PI/180,{isPCS:s,metersOrRadiansPerUnit:o,semiMajor:0,wkidOrWkt:e}})}}]);
//# sourceMappingURL=48045.479bfa3d.chunk.js.map