{"version":3,"file":"static/js/55039.fe9458f0.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/rest/query/operations/query.js","../node_modules/@arcgis/core/layers/support/StreamConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/WebSocketConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/GeoEventConnection.js","../node_modules/@arcgis/core/layers/support/ClientSideConnection.js","../node_modules/@arcgis/core/layers/graphics/sources/connections/createConnection.js","../node_modules/@arcgis/core/rest/operations/urlUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"../../../request.js\";import{urlToObject as t,join as r}from\"../../../core/urlUtils.js\";import{getJsonType as n}from\"../../../geometry/support/jsonUtils.js\";import{normalizeCentralMeridian as i}from\"../../../geometry/support/normalizeUtils.js\";import{srToRESTValue as o}from\"../../../geometry/support/spatialReferenceUtils.js\";import{mapParameters as a}from\"../../operations/urlUtils.js\";import{parsePBFFeatureQuery as s}from\"./pbfQueryUtils.js\";import{applyFeatureSetZUnitScaling as u}from\"./queryZScale.js\";const l=\"Layer does not support extent calculation.\";function d(e,t){if(t&&\"extent\"===e.type)return`${e.xmin},${e.ymin},${e.xmax},${e.ymax}`;if(t&&\"point\"===e.type)return`${e.x},${e.y}`;const r=e.toJSON();return delete r.spatialReference,JSON.stringify(r)}function y(e,t,r){const i=e.geometry,a=e.toJSON();delete a.compactGeometryEnabled,delete a.defaultSpatialReferenceEnabled;const s=a;let u,l,y;if(i&&(l=i.spatialReference,y=o(l),s.geometryType=n(i),s.geometry=d(i,e.compactGeometryEnabled),s.inSR=y),a.groupByFieldsForStatistics&&(s.groupByFieldsForStatistics=a.groupByFieldsForStatistics.join(\",\")),a.objectIds)switch(r?.uniqueIdFields?.length){case void 0:s.objectIds=a.objectIds.join(\",\");break;case 1:s.uniqueIds=JSON.stringify(a.objectIds),delete s.objectIds;break;default:s.uniqueIds=JSON.stringify(a.objectIds.map((e=>JSON.parse(e)))),delete s.objectIds}if(a.orderByFields&&(s.orderByFields=a.orderByFields.join(\",\")),!a.outFields||!a.returnDistinctValues&&(t?.returnCountOnly||t?.returnExtentOnly||t?.returnIdsOnly)?delete s.outFields:a.outFields.includes(\"*\")?s.outFields=\"*\":s.outFields=a.outFields.join(\",\"),a.outSR?(s.outSR=o(a.outSR),u=e.outSpatialReference):i&&(a.returnGeometry||a.returnCentroid)&&(s.outSR=s.inSR,u=l),a.returnGeometry&&delete a.returnGeometry,a.outStatistics&&(s.outStatistics=JSON.stringify(a.outStatistics)),a.fullText&&(s.fullText=JSON.stringify(a.fullText)),a.pixelSize&&(s.pixelSize=JSON.stringify(a.pixelSize)),a.quantizationParameters&&(e.defaultSpatialReferenceEnabled&&null!=l&&null!=e.quantizationParameters?.extent&&l.equals(e.quantizationParameters.extent.spatialReference)&&delete a.quantizationParameters.extent.spatialReference,s.quantizationParameters=JSON.stringify(a.quantizationParameters)),a.parameterValues&&(s.parameterValues=JSON.stringify(a.parameterValues)),a.rangeValues&&(s.rangeValues=JSON.stringify(a.rangeValues)),a.dynamicDataSource&&(s.layer=JSON.stringify({source:a.dynamicDataSource}),delete a.dynamicDataSource),a.timeExtent){const e=a.timeExtent,{start:t,end:r}=e;null==t&&null==r||(s.time=t===r?t:`${t??\"null\"},${r??\"null\"}`),delete a.timeExtent}return e.defaultSpatialReferenceEnabled&&null!=l&&null!=u&&l.equals(u)&&(s.defaultSR=s.inSR,delete s.inSR,delete s.outSR),s}async function c(e,t,r,n,i){const o=t.timeExtent?.isEmpty?{data:{features:[]}}:await g(e,t,\"json\",n,void 0,i);return u(t,r,o.data),o}async function f(e,t,r,n,i){if(t.timeExtent?.isEmpty)return{data:r.createFeatureResult()};const o=await m(e,t,n,i),a=o;return a.data=s(o.data,r),a}function m(e,t,r,n){return g(e,t,\"pbf\",r,void 0,n)}function p(e,t,r,n){return t.timeExtent?.isEmpty?Promise.resolve({data:{objectIds:[]}}):g(e,t,\"json\",r,{returnIdsOnly:!0},n)}function S(e,t,r,n){return t.timeExtent?.isEmpty?Promise.resolve({data:{count:0}}):g(e,t,\"json\",r,{returnIdsOnly:!0,returnCountOnly:!0},n)}async function O(e,t,r){if(t.timeExtent?.isEmpty)return{data:{count:0,extent:null}};const n=await g(e,t,\"json\",r,{returnExtentOnly:!0,returnCountOnly:!0}),i=n.data;if(i.hasOwnProperty(\"extent\"))return n;if(i.features)throw new Error(l);if(i.hasOwnProperty(\"count\"))throw new Error(l);return n}function x(e,t){if(!e.returnIdsOnly||!t.uniqueIdFields)return e;const r={...e,returnUniqueIdsOnly:!0};return delete r.returnIdsOnly,r}async function g(n,o,s,u={},l={},d={}){const c=\"string\"==typeof n?t(n):n,f=o.geometry?[o.geometry]:[],m=await i(f,null,{signal:u.signal}),p=m?.[0];null!=p&&((o=o.clone()).geometry=p);const S=a({...c.query,f:s,...x(l,d),...y(o,l,d)});return e(r(c.path,j(o,l)?\"query3d\":\"query\"),{...u,responseType:\"pbf\"===s?\"array-buffer\":\"json\",query:{...S,...u.query}})}function j(e,t){return null!=e.formatOf3DObjects&&!(t.returnCountOnly||t.returnExtentOnly||t.returnIdsOnly)}export{d as encodeGeometry,c as executeQuery,S as executeQueryForCount,O as executeQueryForExtent,p as executeQueryForIds,f as executeQueryPBF,m as executeQueryPBFBuffer,y as queryToQueryStringParameters,g as runQuery};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as r}from\"../../chunks/tslib.es6.js\";import e from\"../../core/Error.js\";import o from\"../../core/Evented.js\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";let c=class extends o.EventedAccessor{destroy(){this.emit(\"destroy\")}get connectionError(){return this.errorString?new e(\"stream-connection\",this.errorString):null}onFeature(r){this.emit(\"data-received\",r)}onMessage(r){this.emit(\"message-received\",r)}};r([t({readOnly:!0})],c.prototype,\"connectionError\",null),c=r([s(\"esri.layers.support.StreamConnection\")],c);export{c as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../core/Error.js\";import o from\"../../../../core/Logger.js\";import{after as s,createResolver as r}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as n}from\"../../../../core/urlUtils.js\";import{property as i}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as c}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as a}from\"../../../../geometry/support/zscale.js\";import l from\"../../../support/StreamConnection.js\";var h;!function(e){e[e.CONNECTING=0]=\"CONNECTING\",e[e.OPEN=1]=\"OPEN\",e[e.CLOSING=2]=\"CLOSING\",e[e.CLOSED=3]=\"CLOSED\"}(h||(h={}));let d=class extends l{constructor(e){super({}),this._outstandingMessages=[],this.errorString=null;const{geometryType:t,spatialReference:o,sourceSpatialReference:s}=e;this._config=e,this._featureZScaler=a(t,s,o),this._open()}normalizeCtorArgs(){return{}}async _open(){await this._tryCreateWebSocket(),this.destroyed||await this._handshake()}destroy(){super.destroy(),null!=this._websocket&&(this._websocket.onopen=null,this._websocket.onclose=null,this._websocket.onerror=null,this._websocket.onmessage=null,this._websocket.close()),this._websocket=null}get connectionStatus(){if(null==this._websocket)return\"disconnected\";switch(this._websocket.readyState){case h.CONNECTING:case h.OPEN:return\"connected\";case h.CLOSING:case h.CLOSED:return\"disconnected\"}}sendMessageToSocket(e){null!=this._websocket?this._websocket.send(JSON.stringify(e)):this._outstandingMessages.push(e)}sendMessageToClient(e){this._onMessage(e)}updateCustomParameters(e){this._config.customParameters=e,null!=this._websocket&&this._websocket.close()}async _tryCreateWebSocket(e=this._config.source.path,r=1e3,i=0){try{if(this.destroyed)return;const t=n(e,this._config.customParameters??{});this._websocket=await this._createWebSocket(t),this.notifyChange(\"connectionStatus\")}catch(c){const n=r/1e3;return this._config.maxReconnectionAttempts&&i>=this._config.maxReconnectionAttempts?(o.getLogger(this).error(new t(\"websocket-connection\",\"Exceeded maxReconnectionAttempts attempts. No further attempts will be made\")),void this.destroy()):(o.getLogger(this).error(new t(\"websocket-connection\",`Failed to connect. Attempting to reconnect in ${n}s`,c)),await s(r),this._tryCreateWebSocket(e,Math.min(1.5*r,1e3*this._config.maxReconnectionInterval),i+1))}}_setWebSocketJSONParseHandler(e){e.onmessage=e=>{try{const t=JSON.parse(e.data);this._onMessage(t)}catch(s){return void o.getLogger(this).error(new t(\"websocket-connection\",\"Failed to parse message, invalid JSON\",{error:s}))}}}_createWebSocket(e){return new Promise(((t,o)=>{const s=new WebSocket(e);s.onopen=()=>{if(s.onopen=null,this.destroyed)return s.onclose=null,void s.close();s.onclose=e=>this._onClose(e),s.onerror=e=>this._onError(e),this._setWebSocketJSONParseHandler(s),t(s)},s.onclose=e=>{s.onopen=s.onclose=null,o(e)}}))}async _handshake(e=1e4){const s=this._websocket;if(null==s)return;const n=r(),i=s.onmessage,{filter:c,outFields:a,spatialReference:l}=this._config;return n.timeout(e),s.onmessage=e=>{let r=null;try{r=JSON.parse(e.data)}catch(h){}r&&\"object\"==typeof r||(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - malformed message\",e.data)),n.reject(),this.destroy()),r.spatialReference?.wkid!==l?.wkid&&(o.getLogger(this).error(new t(\"websocket-connection\",`Protocol violation. Handshake failed - expected wkid of ${l.wkid}`,e.data)),n.reject(),this.destroy()),\"json\"!==r.format&&(o.getLogger(this).error(new t(\"websocket-connection\",\"Protocol violation. Handshake failed - format is not set\",e.data)),n.reject(),this.destroy()),c&&r.filter!==c&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set filter, but server doesn't support it\")),a&&r.outFields!==a&&o.getLogger(this).error(new t(\"websocket-connection\",\"Tried to set outFields, but server doesn't support it\")),s.onmessage=i;for(const t of this._outstandingMessages)s.send(JSON.stringify(t));this._outstandingMessages=[],n.resolve()},s.send(JSON.stringify({filter:c,outFields:a,format:\"json\",spatialReference:{wkid:l.wkid}})),n.promise}_onMessage(e){if(this.onMessage(e),\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const t of e.features)null!=this._featureZScaler&&this._featureZScaler(t.geometry),this.onFeature(t)}}_onError(e){const t=\"Encountered an error over WebSocket connection\";this._set(\"errorString\",t),o.getLogger(this).error(\"websocket-connection\",t)}_onClose(e){this._websocket=null,this.notifyChange(\"connectionStatus\"),1e3!==e.code&&o.getLogger(this).error(\"websocket-connection\",`WebSocket closed unexpectedly with error code ${e.code}`),this.destroyed||this._open()}};e([i()],d.prototype,\"connectionStatus\",null),e([i()],d.prototype,\"errorString\",void 0),d=e([c(\"esri.layers.graphics.sources.connections.WebSocketConnection\")],d);export{d as WebSocketConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../chunks/tslib.es6.js\";import t from\"../../../../request.js\";import r from\"../../../../core/Error.js\";import i from\"../../../../core/Logger.js\";import{createResolver as o}from\"../../../../core/promiseUtils.js\";import{addQueryParameters as s}from\"../../../../core/urlUtils.js\";import\"../../../../core/has.js\";import\"../../../../core/RandomLCG.js\";import{subclass as n}from\"../../../../core/accessorSupport/decorators/subclass.js\";import a from\"../../../../geometry/SpatialReference.js\";import{fromJSON as c}from\"../../../../geometry/support/jsonUtils.js\";import{WebSocketConnection as u}from\"./WebSocketConnection.js\";import{executeQuery as l}from\"../../../../rest/query/operations/query.js\";import f from\"../../../../rest/support/Query.js\";const h=1e4,d={maxQueryDepth:5,maxRecordCountFactor:3};let g=class extends u{constructor(e){super({...d,...e}),this._buddyServicesQuery=null,this._relatedFeatures=null}async _open(){const e=await this._fetchServiceDefinition(this._config.source);e.timeInfo.trackIdField||i.getLogger(this).warn(\"GeoEvent service was configured without a TrackIdField. This may result in certain functionality being disabled. The purgeOptions.maxObservations property will have no effect.\");const t=this._fetchWebSocketUrl(e.streamUrls,this._config.spatialReference);this._buddyServicesQuery||(this._buddyServicesQuery=this._queryBuddyServices()),await this._buddyServicesQuery,await this._tryCreateWebSocket(t);const{filter:r,outFields:o}=this._config;this.destroyed||this._setFilter(r,o)}_onMessage(e){if(\"attributes\"in e){let o;try{o=this._enrich(e),null!=this._featureZScaler&&this._featureZScaler(o.geometry)}catch(t){return void i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to parse message\",t))}this.onFeature(o)}else this.onMessage(e)}async _fetchServiceDefinition(e){const r={f:\"json\",...this._config.customParameters},i=t(e.path,{query:r,responseType:\"json\"}),o=(await i).data;return this._serviceDefinition=o,o}_fetchWebSocketUrl(e,t){const r=e[0],{urls:i,token:o}=r,n=this._inferWebSocketBaseUrl(i);return s(`${n}/subscribe`,{outSR:\"\"+t.wkid,token:o})}_inferWebSocketBaseUrl(e){if(1===e.length)return e[0];for(const t of e)if(t.includes(\"wss\"))return t;return i.getLogger(this).error(new r(\"geoevent-connection\",\"Unable to infer WebSocket url\",e)),null}async _setFilter(e,t){const s=this._websocket;if(null==s||null==e&&null==t)return;const n=JSON.stringify({filter:this._serializeFilter(e,t)});let a=!1;const c=o(),u=()=>{a||(this.destroyed||this._websocket!==s||i.getLogger(this).error(new r(\"geoevent-connection\",\"Server timed out when setting filter\")),c.reject())},l=e=>{const t=JSON.parse(e.data);t.filter&&(t.error&&(i.getLogger(this).error(new r(\"geoevent-connection\",\"Failed to set service filter\",t.error)),this._set(\"errorString\",`Could not set service filter - ${t.error}`),c.reject(t.error)),this._setWebSocketJSONParseHandler(s),a=!0,c.resolve())};return s.onmessage=l,s.send(n),setTimeout(u,h),c.promise}_serializeFilter(e,t){const o={};if(null==e&&null==t)return o;if(e?.geometry)try{const t=c(e.geometry);if(\"extent\"!==t.type)throw new r(\"geoevent-connection\",`Expected extent but found type ${t.type}`);o.geometry=JSON.stringify(t.shiftCentralMeridian())}catch(s){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when setting connection geometryDefinition\",s))}return e?.where&&\"1 = 1\"!==e.where&&\"1=1\"!==e.where&&(o.where=e.where),null!=t&&(o.outFields=t.join(\",\")),o}_enrich(e){if(!this._relatedFeatures)return e;const t=this._serviceDefinition.relatedFeatures.joinField,o=e.attributes[t],s=this._relatedFeatures.get(o);if(!s)return i.getLogger(this).warn(\"geoevent-connection\",\"Feature join failed. Is the join field configured correctly?\",e),e;const{attributes:n,geometry:a}=s;for(const r in n)e.attributes[r]=n[r];return a&&(e.geometry=a),e.geometry||e.centroid||i.getLogger(this).error(new r(\"geoevent-connection\",\"Found malformed feature - no geometry found\",e)),e}async _queryBuddyServices(){try{const{relatedFeatures:e,keepLatestArchive:t}=this._serviceDefinition,r=this._queryRelatedFeatures(e),i=this._queryArchive(t);await r;const o=await i;if(!o)return;for(const s of o.features)this.onFeature(this._enrich(s))}catch(e){i.getLogger(this).error(new r(\"geoevent-connection\",\"Encountered an error when querying buddy services\",{error:e}))}}async _queryRelatedFeatures(e){if(!e)return;const t=await this._queryBuddy(e.featuresUrl);this._addRelatedFeatures(t)}async _queryArchive(e){if(e)return this._queryBuddy(e.featuresUrl)}async _queryBuddy(e){const t=new((await import(\"../../../FeatureLayer.js\")).default)({url:e}),{capabilities:r}=await t.load(),i=r.query.supportsMaxRecordCountFactor,o=r.query.supportsPagination,s=r.query.supportsCentroid,n=this._config.maxRecordCountFactor,c=t.capabilities.query.maxRecordCount,u=i?c*n:c,h=new f;if(h.outFields=this._config.outFields??[\"*\"],h.where=this._config.filter?.where??\"1=1\",h.returnGeometry=!0,h.returnExceededLimitFeatures=!0,h.outSpatialReference=a.fromJSON(this._config.spatialReference),s&&(h.returnCentroid=!0),i&&(h.maxRecordCountFactor=n),o)return h.num=u,t.destroy(),this._queryPages(e,h);const d=await l(e,h,this._config.sourceSpatialReference);return t.destroy(),d.data}async _queryPages(e,t,r=[],i=0){t.start=null!=t.num?i*t.num:null;const{data:o}=await l(e,t,this._config.sourceSpatialReference);return o.exceededTransferLimit&&i<(this._config.maxQueryDepth??0)?(o.features.forEach((e=>r.push(e))),this._queryPages(e,t,r,i+1)):(r.forEach((e=>o.features.push(e))),o)}_addRelatedFeatures(e){const t=new Map,r=e.features,i=this._serviceDefinition.relatedFeatures.joinField;for(const o of r){const e=o.attributes[i];t.set(e,o)}this._relatedFeatures=t}};g=e([n(\"esri.layers.graphics.sources.connections.GeoEventConnection\")],g);export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import{property as r}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as t}from\"../../core/accessorSupport/decorators/subclass.js\";import{getGeometryZScaler as o}from\"../../geometry/support/zscale.js\";import s from\"./StreamConnection.js\";let a=class extends s{constructor(e){super({}),this.connectionStatus=\"connected\",this.errorString=null;const{geometryType:r,spatialReference:t,sourceSpatialReference:s}=e;this._featureZScaler=o(r,s,t)}normalizeCtorArgs(){return{}}updateCustomParameters(e){}sendMessageToSocket(e){}sendMessageToClient(e){if(\"type\"in e)switch(e.type){case\"features\":case\"featureResult\":for(const r of e.features)null!=this._featureZScaler&&this._featureZScaler(r.geometry),this.onFeature(r)}this.onMessage(e)}};e([r()],a.prototype,\"connectionStatus\",void 0),e([r()],a.prototype,\"errorString\",void 0),a=e([t(\"esri.layers.support.ClientSideConnection\")],a);export{a as ClientSideConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nimport e from\"./GeoEventConnection.js\";import{WebSocketConnection as t}from\"./WebSocketConnection.js\";import{ClientSideConnection as n}from\"../../../support/ClientSideConnection.js\";function o(e,t){if(null==e&&null==t)return null;const n={};return null!=t&&(n.geometry=t),null!=e&&(n.where=e),n}function r(r,i,s,c,l,u,a,m,p){const f={source:r,sourceSpatialReference:i,spatialReference:s,geometryType:c,filter:o(l,u),maxReconnectionAttempts:a,maxReconnectionInterval:m,customParameters:p};if(!r)return new n(f);return r.path.startsWith(\"wss://\")||r.path.startsWith(\"ws://\")?new t(f):new e(f)}export{r as createConnection};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.33/esri/copyright.txt for details.\n*/\nfunction t(n){const o={};for(const e in n){if(\"declaredClass\"===e)continue;const r=n[e];if(null!=r&&\"function\"!=typeof r)if(Array.isArray(r)){o[e]=[];for(let n=0;n<r.length;n++)o[e][n]=t(r[n])}else\"object\"==typeof r?r.toJSON&&(o[e]=JSON.stringify(r)):o[e]=r}return o}export{t as mapParameters};\n"],"names":["l","y","e","t","r","_r$uniqueIdFields","_e$quantizationParame","i","geometry","a","toJSON","compactGeometryEnabled","defaultSpatialReferenceEnabled","s","u","spatialReference","o","geometryType","n","type","concat","xmin","ymin","xmax","ymax","x","JSON","stringify","d","inSR","groupByFieldsForStatistics","join","objectIds","uniqueIdFields","length","uniqueIds","map","parse","orderByFields","outFields","returnDistinctValues","returnCountOnly","returnExtentOnly","returnIdsOnly","includes","outSR","outSpatialReference","returnGeometry","returnCentroid","outStatistics","fullText","pixelSize","quantizationParameters","extent","equals","parameterValues","rangeValues","dynamicDataSource","layer","source","timeExtent","start","end","time","defaultSR","async","c","_t$timeExtent","isEmpty","data","features","g","f","_t$timeExtent2","createFeatureResult","m","p","_t$timeExtent3","Promise","resolve","S","_t$timeExtent4","count","O","_t$timeExtent5","hasOwnProperty","Error","arguments","undefined","signal","clone","_objectSpread","query","returnUniqueIdsOnly","path","formatOf3DObjects","responseType","EventedAccessor","destroy","this","emit","connectionError","errorString","onFeature","onMessage","h","readOnly","prototype","CONNECTING","OPEN","CLOSING","CLOSED","constructor","super","_outstandingMessages","sourceSpatialReference","_config","_featureZScaler","_open","normalizeCtorArgs","_tryCreateWebSocket","destroyed","_handshake","_websocket","onopen","onclose","onerror","onmessage","close","connectionStatus","readyState","sendMessageToSocket","send","push","sendMessageToClient","_onMessage","updateCustomParameters","customParameters","_this$_config$customP","_createWebSocket","notifyChange","maxReconnectionAttempts","getLogger","error","Math","min","maxReconnectionInterval","_setWebSocketJSONParseHandler","WebSocket","_onClose","_onError","filter","timeout","_r$spatialReference","reject","wkid","format","promise","_set","code","maxQueryDepth","maxRecordCountFactor","_buddyServicesQuery","_relatedFeatures","_fetchServiceDefinition","timeInfo","trackIdField","warn","_fetchWebSocketUrl","streamUrls","_queryBuddyServices","_setFilter","_enrich","_serviceDefinition","urls","token","_inferWebSocketBaseUrl","_serializeFilter","setTimeout","shiftCentralMeridian","where","relatedFeatures","joinField","attributes","get","centroid","keepLatestArchive","_queryRelatedFeatures","_queryArchive","_queryBuddy","featuresUrl","_addRelatedFeatures","_this$_config$outFiel","_this$_config$filter$","_this$_config$filter","default","url","capabilities","load","supportsMaxRecordCountFactor","supportsPagination","supportsCentroid","maxRecordCount","returnExceededLimitFeatures","fromJSON","num","_queryPages","_this$_config$maxQuer","exceededTransferLimit","forEach","Map","set","startsWith","Array","isArray"],"sourceRoot":""}