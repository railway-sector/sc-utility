"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[8775,51264,96141],{7150:(t,e,n)=>{n.d(e,{K:()=>a});var o=n(15941),s=n(68930),r=n(20664),i=n(9392);const c=-1;function a(t,e,n){const o=t.vertices.position,s=t.vertices.componentIndex,i=p.position0,a=p.position1,d=p.faceNormal0,h=p.faceNormal1,{edges:g,normals:m}=u(t),v=g.length/4,N=e.allocate(v);let I=0;const A=v,E=null===n||void 0===n?void 0:n.allocate(A);let y=0,T=0,_=0;f.length=0;for(let c=0;c<v;++c){const t=4*c;o.getVec(g.data[t],i),o.getVec(g.data[t+1],a);const e=f.pushNew();e.index=4*c,e.length=(0,r.j)(i,a)}f.sort((t,e)=>e.length-t.length);const b=new Array,P=new Array;f.forAll(t=>{let{length:u,index:f}=t;const v=g.data[f],A=g.data[f+1],C=g.data[f+2],L=g.data[f+3],M=L===c;if(o.getVec(v,i),o.getVec(A,a),M){const t=3*C;(0,r.i)(d,m.data[t],m.data[t+1],m.data[t+2]),(0,r.c)(h,d),p.componentIndex=s.get(v),p.cosAngle=(0,r.e)(d,h)}else{let t=3*C;if((0,r.i)(d,m.data[t],m.data[t+1],m.data[t+2]),t=3*L,(0,r.i)(h,m.data[t],m.data[t+1],m.data[t+2]),p.componentIndex=s.get(v),p.cosAngle=(0,r.e)(d,h),function(t,e){return t.cosAngle>e}(p,w))return;p.cosAngle<-.9999&&(0,r.c)(h,d)}T+=u,_++,M||function(t,e){return t.cosAngle<e}(p,O)?(e.write(N,I++,p),b.push(u)):l(p,S)&&(E&&n&&n.write(E,y++,p),P.push(u))});const C=new Float32Array(b.reverse()),L=new Float32Array(P.reverse()),M=E&&n?{instancesData:E.slice(0,y),lodInfo:{lengths:L}}:void 0;return{regular:{instancesData:N.slice(0,I),lodInfo:{lengths:C}},silhouette:M,averageEdgeLength:T/_}}function l(t,e){const n=(0,o.XM)(t.cosAngle);return(0,r.E)(v,t.position1,t.position0),n*((0,r.e)((0,r.h)(m,t.faceNormal0,t.faceNormal1),v)>0?-1:1)>e}function u(t){const e=t.faces.length/3,n=t.faces,o=t.neighbors,s=t.vertices.position;h.length=g.length=0;for(let i=0;i<e;i++){const t=3*i,e=o[t],a=o[t+1],l=o[t+2],u=n[t],d=n[t+1],f=n[t+2];s.getVec(u,N),s.getVec(d,I),s.getVec(f,A),(0,r.d)(I,I,N),(0,r.d)(A,A,N),(0,r.h)(N,I,A),(0,r.n)(N,N),g.pushArray(N),(e===c||u<d)&&(h.push(u),h.push(d),h.push(i),h.push(e)),(a===c||d<f)&&(h.push(d),h.push(f),h.push(i),h.push(a)),(l===c||f<u)&&(h.push(f),h.push(u),h.push(i),h.push(l))}return{edges:h,normals:g}}class d{constructor(){this.index=0,this.length=0}}const f=new s.A({allocator:t=>t||new d,deallocator:null}),h=new s.A({deallocator:null}),g=new s.A({deallocator:null}),p=new class{constructor(){this.position0=(0,i.vt)(),this.position1=(0,i.vt)(),this.faceNormal0=(0,i.vt)(),this.faceNormal1=(0,i.vt)(),this.componentIndex=0,this.cosAngle=0}},m=(0,i.vt)(),v=(0,i.vt)(),N=(0,i.vt)(),I=(0,i.vt)(),A=(0,i.vt)(),S=(0,o.kU)(4),w=Math.cos(S),E=(0,o.kU)(35),O=Math.cos(E)},8775:(t,e,n)=>{n.d(e,{o6:()=>u,extractComponentsEdgeLocationsLayout:()=>m,hx:()=>d,Jb:()=>p});var o=n(77176);function s(t,e,n){const o=e/3,s=new Uint32Array(n+1),r=new Uint32Array(n+1),i=(t,e)=>{t<e?s[t+1]++:r[e+1]++};for(let v=0;v<o;v++){const e=t[3*v],n=t[3*v+1],o=t[3*v+2];i(e,n),i(n,o),i(o,e)}let c=0,a=0;for(let v=0;v<n;v++){const t=s[v+1],e=r[v+1];s[v+1]=c,r[v+1]=a,c+=t,a+=e}const l=new Uint32Array(6*o),u=s[n],d=(t,e,n)=>{if(t<e){const o=s[t+1]++;l[2*o]=e,l[2*o+1]=n}else{const o=r[e+1]++;l[2*u+2*o]=t,l[2*u+2*o+1]=n}};for(let v=0;v<o;v++){const e=t[3*v],n=t[3*v+1],o=t[3*v+2];d(e,n,v),d(n,o,v),d(o,e,v)}const f=(t,e)=>{const n=2*t,o=e-t;for(let s=1;s<o;s++){const t=l[n+2*s],e=l[n+2*s+1];let o=s-1;for(;o>=0&&l[n+2*o]>t;o--)l[n+2*o+2]=l[n+2*o],l[n+2*o+3]=l[n+2*o+1];l[n+2*o+2]=t,l[n+2*o+3]=e}};for(let v=0;v<n;v++)f(s[v],s[v+1]),f(u+r[v],u+r[v+1]);const h=new Int32Array(3*o),g=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,p=(t,e)=>{const n=g(t,e);h[3*e+n]=-1},m=(t,e,n,o)=>{const s=g(t,e);h[3*e+s]=o;const r=g(n,o);h[3*o+r]=e};for(let v=0;v<n;v++){let t=s[v];const e=s[v+1];let n=r[v];const o=r[v+1];for(;t<e&&n<o;){const e=l[2*t],o=l[2*u+2*n];e===o?(m(v,l[2*t+1],o,l[2*u+2*n+1]),t++,n++):e<o?(p(v,l[2*t+1]),t++):(p(o,l[2*u+2*n+1]),n++)}for(;t<e;)p(v,l[2*t+1]),t++;for(;n<o;)p(l[2*u+2*n],l[2*u+2*n+1]),n++}return h}var r=n(48549),i=n(66470),c=n(96141),a=n(69413),l=n(7150);function u(t){const e=d(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return h.updateSettings(t.writerSettings),g.updateSettings(t.writerSettings),(0,l.K)(e,h,g)}function d(t,e,n,r){if(e){const e=s(n,r,t.count);return new f(n,r,e,t)}const i=(0,o.b)(t.buffer,t.stride/4,{originalIndices:n}),a=s(i.indices,r,i.uniqueCount);return{faces:i.indices,facesLength:i.indices.length,neighbors:a,vertices:c.EdgeInputBufferLayout.createView(i.buffer)}}class f{constructor(t,e,n,o){this.faces=t,this.facesLength=e,this.neighbors=n,this.vertices=o}}const h=new a.T,g=new a.k,p=(0,r.BP)().vec3f(i.r.POSITION0).vec3f(i.r.POSITION1),m=(0,r.BP)().vec3f(i.r.POSITION0).vec3f(i.r.POSITION1).u16(i.r.COMPONENTINDEX)},51264:(t,e,n)=>{n.r(e),n.d(e,{default:()=>g});var o=n(35143),s=n(50346),r=(n(76460),n(81806),n(47249),n(50076),n(85842)),i=n(20664),c=n(9392),a=n(44230),l=n(78315),u=n(94536),d=n(8775);function f(t,e,n){const o=(0,l.c)(),s=(0,l.a)(o);return(0,i.b)(s,s,t,.5),(0,i.b)(s,s,e,.5),o[3]=(0,i.j)(s,t),(0,i.f)(s,s,n),o}let h=class{constructor(){this._idToComponent=new Map,this._components=new u.A(t=>t.bounds),this._edges=new u.A(t=>t.bounds),this._tmpLineSegment=(0,a.vt)(),this._tmpP1=(0,c.vt)(),this._tmpP2=(0,c.vt)(),this._tmpP3=(0,c.vt)(),this.remoteClient=null}async fetchCandidates(t,e){await Promise.resolve(),(0,s.Te)(e),await this._ensureEdgeLocations(t,e);const n=[];return this._edges.forEachNeighbor(e=>(this._addCandidates(t,e,n),n.length<1e3),t.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(t,e){const n=[];if(this._components.forEachNeighbor(t=>{if(null==t.info){const{id:e,uid:o}=t;n.push({id:e,uid:o})}return!0},t.bounds),!n.length)return;const o={components:n},s=await this.remoteClient.invoke("fetchAllEdgeLocations",o,null!==e&&void 0!==e?e:{});for(const r of s.components)this._setFetchEdgeLocations(r)}async add(t){const e=new m(t.id,t.bounds);return this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}}async remove(t){const e=this._idToComponent.get(t.id);if(e){const t=[];this._edges.forEachNeighbor(n=>(n.component===e&&t.push(n),!0),e.bounds),this._edges.remove(t),this._components.remove([e]),this._idToComponent.delete(e.id)}return{result:{}}}_setFetchEdgeLocations(t){const e=this._idToComponent.get(t.id);if(null==e||t.uid!==e.uid)return;const n=d.extractComponentsEdgeLocationsLayout.createView(t.locations),o=new Array(n.count),s=(0,c.vt)(),r=(0,c.vt)();for(let c=0;c<n.count;c++){n.position0.getVec(c,s),n.position1.getVec(c,r);const i=f(s,r,t.origin),a=new v(e,c,i);o[c]=a}this._edges.add(o);const{objectIds:i,origin:a}=t;e.info={locations:n,objectIds:i,origin:a}}_addCandidates(t,e,n){const{info:o}=e.component,{origin:s,objectIds:r}=o,c=o.locations,a=c.position0.getVec(e.index,this._tmpP1),l=c.position1.getVec(e.index,this._tmpP2);(0,i.f)(a,a,s),(0,i.f)(l,l,s);const u=r[c.componentIndex.get(e.index)];this._addEdgeCandidate(t,u,a,l,n),p(t,u,a,n),p(t,u,l,n)}_addEdgeCandidate(t,e,n,o,s){if(!t.returnEdge)return;const r=(0,l.a)(t.bounds),u=(0,a.Cr)(n,o,this._tmpLineSegment),d=(0,a._I)(u,r,this._tmpP3);(0,l.o)(t.bounds,d)&&s.push({type:"edge",objectId:e,target:(0,c.o8)(d),distance:(0,i.j)(r,d),start:(0,c.o8)(n),end:(0,c.o8)(o)})}};h=(0,o._)([(0,r.$)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],h);const g=h;function p(t,e,n,o){if(!t.returnVertex||!(0,l.o)(t.bounds,n))return;const s=(0,l.a)(t.bounds);o.push({type:"vertex",objectId:e,target:(0,c.o8)(n),distance:(0,i.j)(s,n)})}class m{constructor(t,e){this.id=t,this.bounds=e,this.info=null,this.uid=++m.uid}}m.uid=0;class v{constructor(t,e,n){this.component=t,this.index=e,this.bounds=n}}},69413:(t,e,n)=>{n.d(e,{T:()=>I,k:()=>A});var o,s,r=n(47249),i=n(20664),c=n(9392),a=n(57481),l=n(25672),u=n(96141);class d{updateSettings(t){this.settings=t,this._edgeHashFunction=t.reducedPrecision?m:p}write(t,e,n){w.seed=this._edgeHashFunction(n);const o=w.getIntRange(0,255),s=w.getIntRange(0,this.settings.variants-1),r=w.getFloat(),i=255*(.5*function(t,e){return Math.abs(t)**e*Math.sign(t)}(-(1-Math.min(r/.7,1))+Math.max(0,r-.7)/(1-.7),1.2)+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,o),t.variantStroke.set(e,s),t.variantExtension.set(e,i)}}const f=new Float32Array(6),h=new Uint32Array(f.buffer),g=new Uint32Array(1);function p(t){return f[0]=t.position0[0],f[1]=t.position0[1],f[2]=t.position0[2],f[3]=t.position1[0],f[4]=t.position1[1],f[5]=t.position1[2],g[0]=31*(31*(31*(31*(31*(166811+h[0])+h[1])+h[2])+h[3])+h[4])+h[5],g[0]}function m(t){const e=f;e[0]=N(t.position0[0]),e[1]=N(t.position0[1]),e[2]=N(t.position0[2]),e[3]=N(t.position1[0]),e[4]=N(t.position1[1]),e[5]=N(t.position1[2]),g[0]=5381;for(let n=0;n<h.length;n++)g[0]=31*g[0]+h[n];return g[0]}const v=1e4;function N(t){return Math.round(t*v)/v}class I{constructor(){this._commonWriter=new d}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return u.gr.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n),(0,i.f)(S,n.faceNormal0,n.faceNormal1),(0,i.n)(S,S);const{typedBuffer:o,typedBufferStride:s}=t.normalCompressed;(0,l.aT)(o,e,S[0],S[1],S[2],s)}}(o=I).Layout=u.gr,o.glLayout=(0,a.U)(u.gr,1);class A{constructor(){this._commonWriter=new d}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return u.In.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n);{const{typedBuffer:o,typedBufferStride:s}=t.normalCompressed;(0,l.aT)(o,e,n.faceNormal0[0],n.faceNormal0[1],n.faceNormal0[2],s)}{const{typedBuffer:o,typedBufferStride:s}=t.normal2Compressed;(0,l.aT)(o,e,n.faceNormal1[0],n.faceNormal1[1],n.faceNormal1[2],s)}}}(s=A).Layout=u.In,s.glLayout=(0,a.U)(u.In,1);const S=(0,c.vt)(),w=new r.A},77176:(t,e,n)=>{n.d(e,{b:()=>r});var o=n(15941),s=n(38496);function r(t,e,n){var r;const u=Array.isArray(t),d=u?t.length/e:t.byteLength/(4*e),f=u?t:new Uint32Array(t,0,d*e),h=null!==(r=null===n||void 0===n?void 0:n.minReduction)&&void 0!==r?r:0,g=(null===n||void 0===n?void 0:n.originalIndices)||null,p=g?g.length:0,m=(null===n||void 0===n?void 0:n.componentOffsets)||null;let v=0;if(m)for(let o=0;o<m.length-1;o++){const t=m[o+1]-m[o];t>v&&(v=t)}else v=d;const N=Math.floor(1.1*v)+1;(null==l||l.length<2*N)&&(l=new Uint32Array((0,o.cU)(2*N)));for(let o=0;o<2*N;o++)l[o]=0;let I=0;const A=!!m&&!!g,S=A?p:d;let w=(0,s.my)(d);const E=new Uint32Array(p),O=1.96;let y=0!==h?Math.ceil(4*O*O/(h*h)*h*(1-h)):S,T=1,_=m?m[1]:S;for(let o=0;o<S;o++){if(o===y){const t=1-I/o;if(t+O*Math.sqrt(t*(1-t)/o)<h)return null;y*=2}if(o===_){for(let t=0;t<2*N;t++)l[t]=0;if(g)for(let t=m[T-1];t<m[T];t++)E[t]=w[g[t]];_=m[++T]}const t=A?g[o]:o,n=t*e,s=a(f,n,e);let r=s%N,c=I;for(;0!==l[2*r+1];){if(l[2*r]===s){const t=l[2*r+1]-1;if(i(f,n,t*e,e)){c=w[t];break}}r++,r>=N&&(r-=N)}c===I&&(l[2*r]=s,l[2*r+1]=t+1,I++),w[t]=c}if(0!==h&&1-I/d<h)return null;if(A){for(let t=m[T-1];t<E.length;t++)E[t]=w[g[t]];w=(0,s.uW)(E)}const b=u?new Array(I):new Uint32Array(I*e);I=0;for(let o=0;o<S;o++)w[o]===I&&(c(f,(A?g[o]:o)*e,b,I*e,e),I++);if(g&&!A){const t=new Uint32Array(p);for(let e=0;e<t.length;e++)t[e]=w[g[e]];w=(0,s.uW)(t)}return{buffer:Array.isArray(b)?b:b.buffer,indices:w,uniqueCount:I}}function i(t,e,n,o){for(let s=0;s<o;s++)if(t[e+s]!==t[n+s])return!1;return!0}function c(t,e,n,o,s){for(let r=0;r<s;r++)n[o+r]=t[e+r]}function a(t,e,n){let o=0;for(let s=0;s<n;s++)o=t[e+s]+o|0,o=o+(o<<11)+(o>>>2)|0;return o>>>0}let l=null},96141:(t,e,n)=>{n.d(e,{EdgeInputBufferLayout:()=>i,In:()=>u,gr:()=>l,vG:()=>d,vJ:()=>c,wO:()=>a});var o=n(57481),s=n(48549),r=n(66470);const i=(0,s.BP)().vec3f(r.r.POSITION).u16(r.r.COMPONENTINDEX).freeze(),c=(0,s.BP)().vec2u8(r.r.SIDENESS).freeze(),a=(0,o.U)(c),l=(0,s.BP)().vec3f(r.r.POSITION0).vec3f(r.r.POSITION1).vec2i16(r.r.NORMALCOMPRESSED).u16(r.r.COMPONENTINDEX).u8(r.r.VARIANTOFFSET,{glNormalized:!0}).u8(r.r.VARIANTSTROKE).u8(r.r.VARIANTEXTENSION,{glNormalized:!0}).freeze(),u=(0,s.BP)().vec3f(r.r.POSITION0).vec3f(r.r.POSITION1).vec2i16(r.r.NORMALCOMPRESSED).vec2i16(r.r.NORMAL2COMPRESSED).u16(r.r.COMPONENTINDEX).u8(r.r.VARIANTOFFSET,{glNormalized:!0}).u8(r.r.VARIANTSTROKE).u8(r.r.VARIANTEXTENSION,{glNormalized:!0}).freeze(),d=new Map([[r.r.POSITION0,0],[r.r.POSITION1,1],[r.r.COMPONENTINDEX,2],[r.r.VARIANTOFFSET,3],[r.r.VARIANTSTROKE,4],[r.r.VARIANTEXTENSION,5],[r.r.NORMALCOMPRESSED,6],[r.r.NORMAL2COMPRESSED,7],[r.r.SIDENESS,8]])}}]);
//# sourceMappingURL=51264.b4e1b125.chunk.js.map