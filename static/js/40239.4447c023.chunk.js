"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[40239],{771:(e,t,i)=>{i.d(t,{A:()=>l});var s=i(35143),r=i(76460),n=i(50346),o=i(68134),a=(i(81806),i(47249),i(50076),i(85842));const l=e=>{let t=class extends e{initialize(){this.addHandles((0,o.on)(()=>this.layer,"refresh",e=>{this.doRefresh(e.dataChanged).catch(e=>{(0,n.zf)(e)||r.A.getLogger(this).error(e)})}),"RefreshableLayerView")}};return t=(0,s._)([(0,a.$)("esri.views.layers.RefreshableLayerView")],t),t}},12838:(e,t,i)=>{i.d(t,{jX:()=>c,zo:()=>p,gd:()=>d,ph:()=>a,no:()=>h,kz:()=>l,ht:()=>u,yo:()=>f});var s=i(19247);var r=i(59844);const n=new Map,o=new class{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15e3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5e3;this._timer=null,this._cachedBlocks=new Map,this._size=-1,this._duration=e,this._interval=Math.min(e,t)}decreaseRefCount(e,t){const i=e+"/"+t,s=this._cachedBlocks;if(s.has(i)){const e=s.get(i);return e.refCount--,e.refCount<=0&&(s.delete(i),e.controller&&e.controller.abort()),e.refCount}return 0}getBlock(e,t){const i=e+"/"+t,s=this._cachedBlocks;if(s.has(i)){const e=s.get(i);return e.ts=Date.now(),e.refCount++,s.delete(i),s.set(i,e),e.block}return null}putBlock(e,t,i,s){const r=this._cachedBlocks,n=e+"/"+t;if(r.has(n)){const e=r.get(n);e.ts=Date.now(),e.refCount++}else r.set(n,{block:i,ts:Date.now(),refCount:1,controller:s});this._trim(),this._updateTimer()}deleteBlock(e,t){const i=this._cachedBlocks,s=e+"/"+t;i.has(s)&&i.delete(s)}updateMaxSize(e){this._size=e,this._trim()}empty(){this._cachedBlocks.clear(),this._clearTimer()}getCurrentSize(){return this._cachedBlocks.size}_updateTimer(){if(null!=this._timer)return;const e=this._cachedBlocks;this._timer=setInterval(()=>{const t=Array.from(e),i=Date.now();for(let s=0;s<t.length&&t[s][1].ts<=i-this._duration;s++)e.delete(t[s][0]);0===e.size&&this._clearTimer()},this._interval)}_trim(){const e=this._cachedBlocks;if(-1===this._size||this._size>=e.size)return;const t=Array.from(e);for(let i=0;i<t.length-this._size;i++)e.delete(t[i][0])}_clearTimer(){null!=this._timer&&(clearInterval(this._timer),this._timer=null)}};function a(e,t,i){const s=[];return null!=t&&s.push("sliceId=".concat(t)),null!=i&&s.push("bandIds=".concat(i.join(","))),s.length?"".concat(e,"?").concat(s.join("&")):e}function l(e,t){const i={extent:null,rasterInfo:t,cache:new Map},s=n.get(e);return s?(s.push(i),s.length-1):(n.set(e,[i]),0)}function u(e,t){const i=n.get(e);i&&(i[t]=null,i.some(e=>null!=e)||n.delete(e))}function c(e,t,i){var s;const r=n.get(e);if(!r)return null==t?o.decreaseRefCount(e,i):0;if(null==t||null==r[t])return o.decreaseRefCount(e,i);const a=null===(s=r[t])||void 0===s?void 0:s.cache,l=null===a||void 0===a?void 0:a.get(i);if(a&&l){if(l.refCount--,0===l.refCount){a.delete(i);for(let e=0;e<r.length;e++){var u;null===(u=r[e])||void 0===u||u.cache.delete(i)}l.controller&&l.controller.abort()}return l.refCount}return 0}function d(e,t,i){var s;const r=n.get(e);if(!r)return null==t?o.getBlock(e,i):null;if(null==t||null==r[t]){for(let e=0;e<r.length;e++){var a;const t=null===(a=r[e])||void 0===a?void 0:a.cache.get(i);if(t)return t.refCount++,t.block}return o.getBlock(e,i)}const l=null===(s=r[t])||void 0===s?void 0:s.cache.get(i);if(l)return l.refCount++,l.block;for(let n=0;n<r.length;n++){var u;if(n===t||!r[n])continue;const e=null===(u=r[n])||void 0===u?void 0:u.cache,s=null===e||void 0===e?void 0:e.get(i);if(e&&s)return s.refCount++,e.set(i,s),s.block}return null}function h(e,t,i,s){var r;let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const l=n.get(e);if(!l)return void(null==t&&o.putBlock(e,i,s,a));if(null==t||null==l[t])return void o.putBlock(e,i,s,a);const u={refCount:1,block:s,isResolved:!1,isRejected:!1,controller:a};s.then(()=>u.isResolved=!0).catch(()=>u.isRejected=!0),null===(r=l[t])||void 0===r||r.cache.set(i,u)}function p(e,t,i){var s;const r=n.get(e);r?null!=t&&null!=r[t]?null===(s=r[t])||void 0===s||s.cache.delete(i):o.deleteBlock(e,i):null==t&&o.deleteBlock(e,i)}function m(e,t){var i;const s=n.get(e);return s&&null!==(i=s[t])&&void 0!==i?i:null}function f(e,t,i,n,o,a){let l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;const u=m(e,t);if(!u)return;const c=u.extent,{cache:d,rasterInfo:h}=u;if(c&&c.xmin===i.xmin&&c.xmax===i.xmax&&c.ymin===i.ymin&&c.ymax===i.ymax)return;n=null!==n&&void 0!==n?n:0;const p=i.clone().normalize(),{spatialReference:f,transform:y}=h,g=new Set;for(let m=0;m<p.length;m++){const e=p[m];if(e.xmax-e.xmin<=n||e.ymax-e.ymin<=n)continue;let t=(0,r._l)(e,f,l);if(null==t)continue;if(null!=y&&(t=y.inverseTransform(t),null==t))continue;const i=new s.A({x:n,y:n,spatialReference:e.spatialReference});if(null==o&&!(o=(0,r.Wo)(i,f,e,l)))return;const{pyramidLevel:u,pyramidResolution:c,excessiveReading:d}=(0,r.t$)(o,h,a||"closest");if(d)return;const{storageInfo:_}=h,{origin:x}=_,{x:w,y:b}=c,v=Math.max(0,Math.floor((t.xmin-x.x)/w)),C=Math.max(0,Math.floor((x.y-t.ymax)/b)),T=Math.ceil(t.width/w-.1),P=Math.ceil(t.height/b-.1),R=u>0?_.pyramidBlockWidth:_.blockWidth,S=u>0?_.pyramidBlockHeight:_.blockHeight,M=_.blockBoundary[u];if(!M)continue;const k=1,I=Math.max(M.minCol,Math.floor(v/R)-k),z=Math.max(M.minRow,Math.floor(C/S)-k),A=Math.min(M.maxCol,Math.floor((v+T-1)/R)+k),B=Math.min(M.maxRow,Math.floor((C+P-1)/S)+k);for(let s=z;s<=B;s++)for(let e=I;e<=A;e++)g.add("".concat(u,"/").concat(s,"/").concat(e))}d.forEach((e,t)=>{if(!g.has(t)){const e=d.get(t);(null==e||e.isResolved||e.isRejected)&&d.delete(t)}}),u.extent={xmin:i.xmin,ymin:i.ymin,xmax:i.xmax,ymax:i.ymax}}},28866:(e,t,i)=>{i.d(t,{A:()=>p});var s=i(35143),r=i(39356),n=i(50076),o=i(46053),a=(i(81806),i(76460),i(47249),i(85842)),l=i(51939),u=i(31516),c=i(17775),d=i(59844),h=i(2257);const p=e=>{let t=class extends e{constructor(){super(...arguments),this.layer=null,this.tileInfo=null}get fullExtent(){try{return this.layer.loaded?this._getFullExtent():null}catch(e){return null}}get timeExtent(){var e;return(0,u.F)(this.layer,null===(e=this.view)||void 0===e?void 0:e.timeExtent,this._get("timeExtent"))}get hasTilingEffects(){return!!(this.layer.renderer&&"dynamicRangeAdjustment"in this.layer.renderer&&this.layer.renderer.dynamicRangeAdjustment)}get datumTransformation(){try{return this.layer.loaded?(0,d.vI)(this.layer.fullExtent,this.view.spatialReference,!0):null}catch(e){return null}}supportsSpatialReference(e){try{return!this.layer.loaded||!!(0,d.eh)(this.layer.serviceRasterInfo,e)}catch(t){return!1}}async fetchPopupFeaturesAtLocation(e,t){const{layer:i}=this;if(!e)throw new n.A("imageryTileLayerView:fetchPopupFeatures","Nothing to fetch without area",{layer:i});const{popupEnabled:s}=i,o=(0,h.D8)(i,t);if(!s||null==o)return[];const a=[],{value:u,magdirValue:d,processedValue:p}=await i.identify(e,{timeExtent:this.timeExtent,signal:null===t||void 0===t?void 0:t.signal});let m="";if(null!==u&&void 0!==u&&u.length){var f,y,g;m="imagery-tile"===i.type&&i.hasStandardTime()&&null!=u[0]?u.map(e=>i.getStandardTimeValue(e)).join(", "):u.join(", ");const e={ObjectId:0};e[l.F_.servicePixelValue]="imagery-tile"===i.type&&(0,c.q)(i.raster)?null===p||void 0===p?void 0:p.join(", "):m,e[l.F_.rawServicePixelValue]=m;const t=null!==(f=null===(y=i.raster)||void 0===y?void 0:y.rasterInfo)&&void 0!==f?f:i.serviceRasterInfo,s=null===t||void 0===t?void 0:t.attributeTable;if(null!=s){const{fields:t,features:i}=s,r=t.find(e=>{let{name:t}=e;return"value"===t.toLowerCase()}),n=e[l.F_.servicePixelValue],o=r?i.find(e=>String(e.attributes[r.name])===n):null;if(o)for(const s in o.attributes)o.attributes.hasOwnProperty(s)&&(e[l.ER+s]=o.attributes[s])}const n=null===t||void 0===t?void 0:t.dataType;"vector-magdir"!==n&&"vector-uv"!==n||(e[l.F_.magnitude]=null===d||void 0===d?void 0:d[0],e[l.F_.direction]=null===d||void 0===d?void 0:d[1]);const{multidimensionalDefinition:o}=this.layer.normalizeRasterFetchOptions({timeExtent:this.timeExtent});(0,l.eS)(i.rasterFields,e,o);const h=new r.A({geometry:null===(g=this.fullExtent)||void 0===g?void 0:g.clone(),attributes:e,layer:i,sourceLayer:i});a.push(h)}return a}async getSourceScale(){return await this.layer.load(),(0,d.OO)(this.layer.serviceRasterInfo,this.view.spatialReference)}_getFullExtent(){return(0,d.eh)(this.layer.serviceRasterInfo,this.view.spatialReference)}};return(0,s._)([(0,o.MZ)()],t.prototype,"fullExtent",null),(0,s._)([(0,o.MZ)()],t.prototype,"layer",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],t.prototype,"timeExtent",null),(0,s._)([(0,o.MZ)()],t.prototype,"tileInfo",void 0),(0,s._)([(0,o.MZ)({readOnly:!0})],t.prototype,"hasTilingEffects",null),(0,s._)([(0,o.MZ)()],t.prototype,"datumTransformation",null),t=(0,s._)([(0,a.$)("esri.views.layers.ImageryTileLayerView")],t),t}},40239:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ot});var s=i(35143),r=i(76460),n=i(50346),o=i(68134),a=i(46053),l=i(81806),u=(i(47249),i(85842)),c=i(68347),d=i(1626),h=i(56286),p=i(17775),m=i(52297),f=i(61229),y=i(2413),g=i(28632),_=i(85827),x=i(30726),w=i(63919),b=i(59422),v=i(8794),C=i(93345),T=i(71853);const P={bandCount:3,minOutput:0,maxOutput:1,minCutOff:[0,0,0],maxCutOff:[255,255,255],factor:[1/255,1/255,1/255],useGamma:!1,gamma:[1,1,1],gammaCorrection:[1,1,1],colormap:null,colormapOffset:null,stretchType:"none",type:"stretch"};class R extends v.q{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;super(),this._textureInvalidated=!0,this._colormapTextureInvalidated=!0,this._rasterTexture=null,this._maskTexture=null,this._rasterTextureBandIds=null,this._transformGridTexture=null,this._colormapTexture=null,this._colormap=null,this._supportsBilinearTexture=!0,this._processedTexture=null,this.functionTextures=[],this.projected=!1,this.stencilRef=0,this.coordScale=[1,1],this._processed=!1,this._symbolizerParameters=null,this.height=null,this.isRendereredSource=!1,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._mask=null,this.rawPixelData=null,this._suspended=!1,this._bandIds=null,this._interpolation=null,this._transformGrid=null,this.width=null,this.x=0,this.y=0,this.source=e,this.transformGrid=t,this.interpolation=i}destroy(){this._disposeTextures()}get processedTexture(){return this._processedTexture}set processedTexture(e){this._processedTexture!==e&&(this._disposeTextures(!0),this._processedTexture=e)}get rasterTexture(){return this._rasterTexture}set rasterTexture(e){var t;this._rasterTexture!==e&&(null!==(t=this._rasterTexture)&&void 0!==t&&t.dispose(),this._rasterTexture=e),null==e&&(this.projected=!1)}get processed(){return this._processed}set processed(e){this._processed=e,e||(this.processedTexture=(0,x.WD)(this.processedTexture),this.invalidateTexture())}get symbolizerParameters(){return this._symbolizerParameters||P}set symbolizerParameters(e){this._symbolizerParameters!==e&&(this._symbolizerParameters=e,this._colormapTextureInvalidated=!0)}get source(){return this._source}set source(e){this._source!==e&&(this._source=e,this._rasterTexture&&(this._rasterTexture=(0,x.WD)(this._rasterTexture),this._rasterTextureBandIds=null),this.projected=!1,this.invalidateTexture())}get mask(){return this._mask}set mask(e){this._mask!==e&&(this._mask=e,this._maskTexture=(0,x.WD)(this._maskTexture))}get suspended(){return this._suspended}set suspended(e){this._suspended&&!e&&this.stage&&(this.ready(),this.requestRender()),this._suspended=e}get bandIds(){return this._bandIds}set bandIds(e){this._bandIds=e,this._isBandIdsChanged(e)&&(this.projected=!1,this.invalidateTexture())}get interpolation(){return this._interpolation||"nearest"}set interpolation(e){this._interpolation=e,this._rasterTexture&&this._rasterTexture.setSamplingMode("bilinear"===this._getTextureSamplingMethod(e||"nearest")?C.Cj.LINEAR:C.Cj.NEAREST)}get transformGrid(){return this._transformGrid}set transformGrid(e){this._transformGrid!==e&&(this._transformGrid=e,this._transformGridTexture=(0,x.WD)(this._transformGridTexture))}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRender())}getRasterTextureSize(){var e,t;const i=arguments.length>0&&void 0!==arguments[0]&&arguments[0]||this.projected;return[i?this.width:(null===(e=this.source)||void 0===e?void 0:e.width)||this.width,i?this.height:(null===(t=this.source)||void 0===t?void 0:t.height)||this.height]}getRasterCellSize(){var e;const t=null===(e=this.rawPixelData)||void 0===e?void 0:e.srcPixelSize,{projected:i,resolution:s}=this;return t&&!i?[t.x,t.y]:[s,s]}_createTransforms(){return{displayViewScreenMat3:(0,_.vt)()}}setTransform(e){const t=(0,w.D_)(this.transforms.displayViewScreenMat3),[i,s]=e.toScreenNoRotation([0,0],[this.x,this.y]),r=this.resolution/this.pixelRatio/e.resolution,n=r*this.width,o=r*this.height,a=Math.PI*this.rotation/180;(0,w.Tl)(t,t,(0,b.fA)(i,s)),(0,w.Tl)(t,t,(0,b.fA)(n/2,o/2)),(0,w.e$)(t,t,-a),(0,w.Tl)(t,t,(0,b.fA)(-n/2,-o/2)),(0,w.Oe)(t,t,(0,b.fA)(n,o)),(0,w.lw)(this.transforms.displayViewScreenMat3,e.displayViewMat3,t)}getTextures(){var e;let{forProcessing:t=!1,useProcessedTexture:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const s=i&&null!==(e=this._processedTexture)&&void 0!==e?e:this._rasterTexture,r=[],n=[];return s?(this._transformGridTexture&&!this.projected&&(n.push(this._transformGridTexture),r.push("u_transformGrid")),n.push(s),r.push("u_image"),!this._colormapTexture||!i&&t||(n.push(this._colormapTexture),r.push("u_colormap")),this._maskTexture&&(n.push(this._maskTexture),r.push("u_mask")),{names:r,textures:n}):{names:r,textures:n}}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}updateTexture(e){let{context:t}=e;if(!this.stage)return void this._disposeTextures();const i=this._isValidSource(this.source);i&&this._colormapTextureInvalidated&&(this._colormapTextureInvalidated=!1,this._updateColormapTexture(t)),this._textureInvalidated&&(this._textureInvalidated=!1,this._createOrDestroyRasterTexture(t),this._rasterTexture&&(i?(this.transformGrid&&!this._transformGridTexture&&(this._transformGridTexture=(0,T.kc)(t,this.transformGrid)),this._mask&&!this._maskTexture&&(this._maskTexture=(0,T.WL)(t,this._mask,[this.width,this.height]))):this._rasterTexture.setData(null)),this.suspended||(this.ready(),this.requestRender()))}updateProcessedTexture(){const{functionTextures:e}=this;0!==e.length&&(this.processedTexture=e.shift(),e.forEach(e=>null===e||void 0===e?void 0:e.dispose()),e.length=0,this.processed=!!this.processedTexture)}_createOrDestroyRasterTexture(e){var t;const i=null===(t=this.source)||void 0===t?void 0:t.extractBands(this.bandIds);if(!this._isValidSource(i))return void(this._rasterTexture&&(this._rasterTexture=(0,x.WD)(this._rasterTexture),this._rasterTextureBandIds=null));const s=!this._isBandIdsChanged(this.bandIds);if(this._rasterTexture){if(s)return;this._rasterTexture=(0,x.WD)(this._rasterTexture),this._rasterTextureBandIds=null}this._supportsBilinearTexture=!!e.capabilities.textureFloatLinear;const r=this._getTextureSamplingMethod(this.interpolation),n=this.isRendereredSource;this._rasterTexture=(0,T.b4)(e,i,r,n),this.projected=!1,this._processed=!1,this._rasterTextureBandIds=this.bandIds?[...this.bandIds]:null}_isBandIdsChanged(e){const t=this._rasterTextureBandIds;return!(null==t&&null==e||t&&e&&t.join("")===e.join(""))}_isValidSource(e){var t;return null!=e&&(null===(t=e.pixels)||void 0===t?void 0:t.length)>0}_getTextureSamplingMethod(e){const{type:t}=this.symbolizerParameters,i="lut"===t&&!this.symbolizerParameters.isClassBreaks||"hillshade"===t||"stretch"===t&&1===this.symbolizerParameters.bandCount;return!this._supportsBilinearTexture||i||"bilinear"!==e&&"cubic"!==e?"nearest":"bilinear"}_updateColormapTexture(e){const t=this._colormap,i=this.symbolizerParameters.colormap;return i?t?i.length!==t.length||i.some((e,i)=>e!==t[i])?(this._colormapTexture&&(this._colormapTexture=(0,x.WD)(this._colormapTexture)),this._colormapTexture=(0,T.hE)(e,i),void(this._colormap=i)):void 0:(this._colormapTexture=(0,T.hE)(e,i),void(this._colormap=i)):(this._colormapTexture&&(this._colormapTexture=(0,x.WD)(this._colormapTexture)),void(this._colormap=null))}_disposeTextures(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.projected&&(this._transformGridTexture=(0,x.WD)(this._transformGridTexture)):(this._rasterTexture=(0,x.WD)(this._rasterTexture),this._colormapTexture=(0,x.WD)(this._colormapTexture),this._transformGridTexture=(0,x.WD)(this._transformGridTexture),this._maskTexture=(0,x.WD)(this._maskTexture),this._rasterTextureBandIds=null,this._colormap=null,this._colormapTextureInvalidated=!0),this._processedTexture=(0,x.WD)(this._processedTexture)}}var S=i(78440);class M extends S.Y{constructor(e,t,i,s,r,n){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;super(e,t,i,s,r,n),this.bitmap=null,this.bitmap=new R(o,null,null),this.bitmap.coordScale=[r,n],this.bitmap.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.bitmap.destroy(),this.bitmap=null,this.stage=null}set stencilRef(e){this.bitmap.stencilRef=e}get stencilRef(){return this.bitmap.stencilRef}setTransform(e){super.setTransform(e),this.bitmap.transforms.displayViewScreenMat3=this.transforms.displayViewScreenMat3}_createTransforms(){return{displayViewScreenMat3:(0,_.vt)(),tileMat3:(0,_.vt)()}}onAttach(){this.bitmap.stage=this.stage}onDetach(){this.bitmap.stage=null}}var k=i(61551),I=i(46550),z=i(89379),A=i(70479),B=i(32743),F=i(6951),V=i(60984),Z=i(60853);class E extends F.k2{}function O(e,t){const{transformTexture:i,targetImageSize:s,transformSpacing:r}=t,n=(0,V.RI)(e.multiply(s)),o=new V.ZY(4,1),a=(0,V.RI)(n.divide(r)).multiply(o),l=(0,V.jc)(n.add(new V.ZY(.5,.5)).divide(r)),u=new V.Cq((0,V.Wh)(a.x),(0,V.Wh)(a.y)),c=new V.eB(l,1);return(0,V.Tk)((0,V.$5)(l.x,l.y),function(e,t,i){const s=(0,V.nP)(e,t,new V.Ai(0)),r=new V.Cq(t.x.add(1),t.y),n=(0,V.nP)(e,r,new V.Ai(0));return new V.ZY((0,V.Om)(s.rgb,i),(0,V.Om)(n.rgb,i))}(i,u,c),function(e,t,i){const s=new V.Cq(t.x.add(2),t.y),r=(0,V.nP)(e,s,new V.Ai(0)),n=new V.Cq(t.x.add(3),t.y),o=(0,V.nP)(e,n,new V.Ai(0));return new V.ZY((0,V.Om)(r.rgb,i),(0,V.Om)(o.rgb,i))}(i,u,c))}function D(e,t){return t?arguments.length>2&&void 0!==arguments[2]&&arguments[2]?function(e,t){const i=(0,V.US)(t.transformTexture,e);return new V.ZY(i.r,i.g)}(e,t):O(e,t):e}function U(e,t,i){const{bicubic:s=!1,bilinear:r=!1,nearestOnEdge:n=!1}=null!==i&&void 0!==i?i:{};return s||r?function(e,t,i,s){const r=(0,V.RI)(t.multiply(i)),n=new V.Cq(new V.Ai(r.x),new V.Ai(r.y)),o=new V.Cq(n.x.add(1),n.y),a=new V.Cq(n.x,n.y.add(1)),l=new V.Cq(n.x.add(1),n.y.add(1)),u=(0,V.nP)(e,n,new V.Ai(0)),c=(0,V.nP)(e,o,new V.Ai(0)),d=(0,V.nP)(e,a,new V.Ai(0)),h=(0,V.nP)(e,l,new V.Ai(0)),p=(0,V.jc)(t.multiply(i)),m=(0,V.jh)(u,c,p.x),f=(0,V.jh)(d,h,p.x),y=(0,V.jh)(m,f,p.y);if(!s)return y;const g=new V.Zb(u.a,c.a,d.a,h.a),_=g.xy.multiply(g.zw),x=(0,V.RI)(_.x.multiply(_.y).add(.5)),w=y.multiply(x),b=(0,Z.zb)(x).multiply((0,V.US)(e,t));return w.add(b)}(t.texture,e,t.srcImageSize,n):(0,V.US)(t.texture,e)}(0,s._)([(0,F.Pi)(V.z7)],E.prototype,"transformTexture",void 0),(0,s._)([(0,F.Pi)(V.ZY)],E.prototype,"targetImageSize",void 0),(0,s._)([(0,F.Pi)(V.ZY)],E.prototype,"transformSpacing",void 0),(0,s._)([(0,F.Pi)(V.ZY)],E.prototype,"transformGridSize",void 0);class G extends F.ZA{}(0,s._)([(0,F.C5)(0,V.ZY)],G.prototype,"position",void 0);class L extends F.HS{}class j extends F.k2{}(0,s._)([(0,F.Pi)(V.z7)],j.prototype,"texture",void 0),(0,s._)([(0,F.Pi)(V.U)],j.prototype,"dvsMat3",void 0),(0,s._)([(0,F.Pi)(V.ZY)],j.prototype,"coordScale",void 0),(0,s._)([(0,F.Pi)(V.ZY)],j.prototype,"srcImageSize",void 0),(0,s._)([(0,F.Pi)(V.nt)],j.prototype,"opacity",void 0);class q extends F.k2{}(0,s._)([(0,F.Pi)(V.z7)],q.prototype,"maskTexture",void 0);class Y extends F.A{constructor(){super(...arguments),this.applyProjection=!0,this.lookupProjection=!1,this.bilinear=!1,this.bicubic=!1,this.nearestOnEdge=!1,this.applyPixelMask=!1}vertex(e){const t=e.position,{dvsMat3:i,coordScale:s}=this.config,r=i.multiply(new V.eB(t.multiply(s),1));return{uv:t,glPosition:new V.Zb(r,1)}}fragment(e){const t=new F.mm,i=D(e.uv,this.applyProjection?this.projectionConfig:void 0,this.lookupProjection),s=(0,V.Tk)(function(e){const t=(0,V.PM)(new V.ZY(-1e-5,-1e-5),e).multiply((0,V.PM)(e,new V.ZY(1.00001,1.00001))),i=(0,Z.zb)(t.x.multiply(t.y));return new V.x(i)}(i),new V.Zb(0,0,0,0),this._colorize(i));let r=s.a.multiply(this.config.opacity);if(this.applyPixelMask){const t=this._getPixelMask(e.uv);r=r.multiply(t)}return t.fragColor=new V.Zb(s.rgb,1).multiply(r),t}_getPixel(e){const{config:t,bicubic:i,bilinear:s,nearestOnEdge:r}=this;return U(e,t,{bicubic:i,bilinear:s,nearestOnEdge:r})}_getPixelMask(e){const{maskTexture:t}=this.pixelMaskConfig,i=(0,V.US)(t,e);return(0,V._S)(i.a)}}(0,s._)([F.E8],Y.prototype,"applyProjection",void 0),(0,s._)([F.E8],Y.prototype,"lookupProjection",void 0),(0,s._)([F.E8],Y.prototype,"bilinear",void 0),(0,s._)([F.E8],Y.prototype,"bicubic",void 0),(0,s._)([F.E8],Y.prototype,"nearestOnEdge",void 0),(0,s._)([F.E8],Y.prototype,"applyPixelMask",void 0),(0,s._)([(0,F.Pi)(j)],Y.prototype,"config",void 0),(0,s._)([(0,F.uK)(E)],Y.prototype,"projectionConfig",void 0),(0,s._)([(0,F.uK)(q)],Y.prototype,"pixelMaskConfig",void 0),(0,s._)([(0,s.a)(0,(0,F.hF)(G))],Y.prototype,"vertex",null),(0,s._)([(0,s.a)(0,(0,F.hF)(L))],Y.prototype,"fragment",null);class W extends F.k2{}function N(e,t,i){let s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{colormapTexture:r,colormapOffset:n,colormapMaxIndex:o}=i,a=e.r.multiply(t).subtract(n),l=(0,V.qE)(a,new V.nt(0),o),u=new V.ZY(l.add(.5).divide(o.add(1)),0),c=(0,V.US)(r,u),d=new V.Zb(c.rgb,c.a.multiply(e.a));if(s)return d;const h=(0,V.PM)(new V.nt(0),a).multiply((0,V.PM)(a,i.colormapMaxIndex));return d.multiply(h)}(0,s._)([(0,F.Pi)(V.z7)],W.prototype,"colormapTexture",void 0),(0,s._)([(0,F.Pi)(V.nt)],W.prototype,"colormapOffset",void 0),(0,s._)([(0,F.Pi)(V.nt)],W.prototype,"colormapMaxIndex",void 0);class H extends Y{constructor(){super(...arguments),this.type="RasterColorizerLUTShader"}_colorize(e){return N(this._getPixel(e),new V.nt(1),this.colormapConfig,!1)}}function Q(e){const t=new V.Zb(0,-1/3,2/3,-1),i=(0,V.Tk)((0,V.Xe)(e.y,e.z),new V.Zb(e.zy,t.wz),new V.Zb(e.yz,t.xy)),s=(0,V.Tk)((0,V.Xe)(e.x,i.x),new V.Zb(i.xyw,e.x),new V.Zb(e.x,i.yzx)),r=s.x.subtract((0,V.jk)(s.w,s.y)),n=new V.nt(1e-10),o=s.w.subtract(s.y),a=r.multiply(6).add(n),l=(0,V.tn)(o.divide(a).add(s.z)),u=s.x.add(n),c=(0,V.jk)(r.divide(u),new V.nt(1));return new V.eB(l,c,s.x)}function K(e){const t=new V.Zb(1,2/3,1/3,3),i=(0,V.tn)((0,V.jc)(e.xxx.add(t.xyz)).multiply(6).subtract(t.www)),s=(0,V.qE)(i.subtract(t.xxx),new V.eB(0,0,0),new V.eB(1));return e.z.multiply((0,V.jh)(t.xxx,s,e.y))}(0,s._)([(0,F.Pi)(W)],H.prototype,"colormapConfig",void 0);class $ extends F.k2{}function X(e){const t=(0,V.tn)(e),i=(0,V.PM)(t,new V.ZY(1,1)).multiply(t),s=new V.nt(2).subtract(t),r=(0,V.PM)(new V.nt(1),t).multiply(s);return i.add(r)}function J(e,t,i){const s=new V.nt(1).divide(i),r=(0,V.US)(e,X(s.multiply(new V.ZY(-1,-1)).add(t))),n=(0,V.US)(e,X(s.multiply(new V.ZY(0,-1)).add(t))),o=(0,V.US)(e,X(s.multiply(new V.ZY(1,-1)).add(t))),a=(0,V.US)(e,X(s.multiply(new V.ZY(-1,0)).add(t))),l=(0,V.US)(e,X(t)),u=(0,V.US)(e,X(s.multiply(new V.ZY(1,0)).add(t))),c=(0,V.US)(e,X(s.multiply(new V.ZY(-1,1)).add(t))),d=(0,V.US)(e,X(s.multiply(new V.ZY(0,1)).add(t))),h=(0,V.US)(e,X(s.multiply(new V.ZY(1,1)).add(t))),p=new V.Zb(r.a,n.a,o.a,a.a),m=new V.Zb(u.a,c.a,d.a,h.a),f=p.multiply(m),y=f.xy.multiply(f.zw),g=y.x.multiply(y.y).multiply(l.a),_=new V.My(new V.nt(0),10);return _[0]=r.r,_[1]=n.r,_[2]=o.r,_[3]=a.r,_[4]=l.r,_[5]=u.r,_[6]=c.r,_[7]=d.r,_[8]=h.r,_[9]=g,_}function ee(e,t){const i=new V.Zb(e[5],e[3],e[7],e[1]).multiply(2),s=new V.eB(e[2],i[0],e[8]),r=new V.eB(e[0],i[1],e[6]),n=(0,V.Om)(s.subtract(r),new V.eB(1)),o=new V.eB(e[6],i[2],e[8]),a=new V.eB(e[0],i[3],e[2]),l=(0,V.Om)(o.subtract(a),new V.eB(1));return new V.ZY(n,l).multiply(t)}function te(e,t,i){const{factor:s}=t,r=ee(e,s),n=(0,V.RZ)((0,V.Om)(r,r).add(1)),o=e[9],{sinZsinAs:a,sinZcosAs:l,cosZs:u,weights:c}=t;if(!i){const e=ie({sinZsinA:a[0],sinZcosA:l[0],cosZ:u[0],weights:new V.nt(1),dzxy:r,dzd:n});return new V.Zb(e,e,e,o)}const d=ie({sinZsinA:new V.eB(a[0],a[1],a[2]),sinZcosA:new V.eB(l[0],l[1],l[2]),cosZ:new V.eB(u[0],u[1],u[2]),weights:new V.eB(c[0],c[1],c[2]),dzxy:r,dzd:n}),h=ie({sinZsinA:new V.eB(a[3],a[4],a[5]),sinZcosA:new V.eB(l[3],l[5],l[5]),cosZ:new V.eB(u[3],u[4],u[5]),weights:new V.eB(c[3],c[4],c[5]),dzxy:r,dzd:n}),p=(0,V.Om)(d.add(h),new V.eB(1));return new V.Zb(p,p,p,o)}function ie(e){const t=e.sinZsinA.multiply(e.dzxy.y),i=e.sinZcosA.multiply(e.dzxy.x),s=t.subtract(i),r=e.cosZ.add(s).divide(e.dzd);return r.multiply((0,V.PM)(new V.nt(0),r)).multiply(e.weights)}function se(e,t){const{pixelSizeFactor:i}=e,s=[e.factor[0]/t[0],e.factor[1]/t[1]];if(i>0){const{zFactor:r,pixelSizePower:n,gcsFactor:o}=e,a=t[0]*o,l=t[1]*o;s[0]=(r+a**n*i)/(8*a),s[1]=(r+l**n*i)/(8*l)}return s}(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,6))],$.prototype,"sinZcosAs",void 0),(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,6))],$.prototype,"sinZsinAs",void 0),(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,6))],$.prototype,"cosZs",void 0),(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,6))],$.prototype,"weights",void 0),(0,s._)([(0,F.Pi)(V.nt)],$.prototype,"minValue",void 0),(0,s._)([(0,F.Pi)(V.nt)],$.prototype,"maxValue",void 0),(0,s._)([(0,F.Pi)(V.ZY)],$.prototype,"factor",void 0);class re extends Y{constructor(){super(...arguments),this.type="RasterColorizerShadedReliefShader",this.applyColormap=!1,this.isMultidirectional=!1}_colorize(e){const{texture:t}=this.config,i=te(J(t,e,this.config.srcImageSize),this.hillshadeConfig,this.isMultidirectional);if(!this.applyColormap)return new V.Zb(i.x,i.x,i.x,i.a);const{minValue:s,maxValue:r}=this.hillshadeConfig,n=this._getPixel(e),o=r.subtract(s),a=n.r.subtract(s),l=(0,V.qE)(a.divide(o),new V.nt(0),new V.nt(1)),u=N(new V.Zb(l,l,l,1),new V.nt(255),this.colormapConfig),c=Q(u.xyz),d=K(new V.eB(c.xy,i.x));return new V.Zb(d,u.a.multiply(i.a))}}(0,s._)([F.E8],re.prototype,"applyColormap",void 0),(0,s._)([F.E8],re.prototype,"isMultidirectional",void 0),(0,s._)([(0,F.Pi)($)],re.prototype,"hillshadeConfig",void 0),(0,s._)([(0,F.uK)(W)],re.prototype,"colormapConfig",void 0);class ne extends F.k2{}function oe(e,t,i){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255;const r=i?function(e,t){const{minCutOff:i,maxCutOff:s,minOutput:r,maxOutput:n,gamma:o,gammaCorrection:a}=t,l=(0,V.qE)(e,i,s).subtract(i),u=s.subtract(i),c=l.divide(u),d=(0,V.PM)(new V.nt(1),o),h=(0,V._S)(o.subtract(1)),p=n.subtract(r),m=new V.eB(1),f=(0,V.n7)(m.divide(p),c.multiply(a)),y=(0,Z.zb)(d.multiply(h).multiply(f)),g=(0,V.n7)(c,m.divide(o)),_=y.multiply(p).multiply(g).add(r);return(0,V.qE)(_,r,n)}(e.rgb,t).divide(s):function(e,t){const{minCutOff:i,maxCutOff:s,factor:r,minOutput:n}=t;return(0,V.qE)(e,i,s).subtract(i).multiply(r).add(n)}(e.rgb,t);return new V.Zb(r,e.a)}(0,s._)([(0,F.Pi)(V.nt)],ne.prototype,"minOutput",void 0),(0,s._)([(0,F.Pi)(V.nt)],ne.prototype,"maxOutput",void 0),(0,s._)([(0,F.Pi)(V.eB)],ne.prototype,"minCutOff",void 0),(0,s._)([(0,F.Pi)(V.eB)],ne.prototype,"maxCutOff",void 0),(0,s._)([(0,F.Pi)(V.eB)],ne.prototype,"factor",void 0),(0,s._)([(0,F.Pi)(V.eB)],ne.prototype,"gamma",void 0),(0,s._)([(0,F.Pi)(V.eB)],ne.prototype,"gammaCorrection",void 0);class ae extends Y{constructor(){super(...arguments),this.type="RasterColorizerStretchShader",this.isMultiband=!0,this.applyColormap=!1,this.useGamma=!1,this.noOp=!1}_colorize(e){const t=this._getPixel(e);if(this.noOp)return t;let i=oe(t,this.stretchConfig,this.useGamma);if(this.isMultiband)return i;if(i=new V.Zb(i.rrr,i.a),this.applyColormap){const e=this.useGamma?255:1;i=N(i,new V.nt(e),this.colormapConfig)}return i}}(0,s._)([F.E8],ae.prototype,"isMultiband",void 0),(0,s._)([F.E8],ae.prototype,"applyColormap",void 0),(0,s._)([F.E8],ae.prototype,"useGamma",void 0),(0,s._)([F.E8],ae.prototype,"noOp",void 0),(0,s._)([(0,F.Pi)(ne)],ae.prototype,"stretchConfig",void 0),(0,s._)([(0,F.uK)(W)],ae.prototype,"colormapConfig",void 0);class le extends A.j{constructor(){super(...arguments),this.name="BrushRasterColorizer",this.type=B.Y.RasterColorizer,this.shaders={lut:new H,stretch:new ae,shadedRelief:new re}}render(e,t){for(const i of t.bitmaps){if(!i.source||i.suspended)continue;e.timeline.begin(this.name);const{painter:t}=e;t.setPipelineState({depth:!1,stencil:{test:{mask:255,ref:i.stencilRef,compare:C.MT.EQUAL,op:{fail:C.eA.KEEP,zFail:C.eA.KEEP,zPass:C.eA.KEEP}},write:!1},color:{write:[!0,!0,!0,!0],blendMode:"composite"}}),i.updateTexture(e),i.processedTexture||i.updateProcessedTexture();const{type:s}=i.symbolizerParameters,r="stretch"===s?this._getStretchOptions(i):"lut"===s?this._getLutOptions(i):this._getShadedReliefOptions(i);"bilinear"!==i.interpolation||e.context.capabilities.textureFloatLinear||(r.defines.bilinear=!0),t.submitDrawMesh(e.context,r,t.quadMesh),e.timeline.end(this.name)}}_getLutOptions(e){const{config:t,projectionConfig:i,colormapConfig:s,pixelMaskConfig:r,projectionDefines:n}=this._getCommonConfig(e),o=this._getInterpolationDefines("nearest",!1);return{shader:this.shaders.lut,uniforms:{projectionConfig:i,config:t,colormapConfig:s,pixelMaskConfig:r},defines:(0,z.A)((0,z.A)((0,z.A)({},n),o),{},{applyPixelMask:!!r}),optionalAttributes:null,useComputeBuffer:!1}}_getStretchOptions(e){const t=e.symbolizerParameters,{config:i,projectionConfig:s,colormapConfig:r,pixelMaskConfig:n,projectionDefines:o}=this._getCommonConfig(e),a=this._getInterpolationDefines(e.interpolation,1===t.bandCount);return{shader:this.shaders.stretch,uniforms:{projectionConfig:s,config:i,stretchConfig:t,colormapConfig:r,pixelMaskConfig:n},defines:(0,z.A)((0,z.A)((0,z.A)({},o),a),{},{isMultiband:t.bandCount>1,applyColormap:!!r,useGamma:t.useGamma,noOp:e.isRendereredSource&&!e.processed,applyPixelMask:!!n}),optionalAttributes:null,useComputeBuffer:!1}}_getShadedReliefOptions(e){const t=e.symbolizerParameters,{config:i,projectionConfig:s,colormapConfig:r,pixelMaskConfig:n,projectionDefines:o}=this._getCommonConfig(e),a=this._getInterpolationDefines(e.interpolation,!0);return{shader:this.shaders.shadedRelief,uniforms:{projectionConfig:s,config:i,hillshadeConfig:t,colormapConfig:r,pixelMaskConfig:n},defines:(0,z.A)((0,z.A)((0,z.A)({},o),a),{},{isMultidirectional:t.hillshadeType>0,applyColormap:!!r,applyPixelMask:!!n}),optionalAttributes:null,useComputeBuffer:!1}}_getCommonConfig(e){const{coordScale:t,computedOpacity:i,transforms:s}=e,{names:r,textures:n}=e.getTextures({useProcessedTexture:e.processed}),o=n[r.indexOf("u_image")],a=e.getRasterTextureSize(),l={texture:{texture:o,unit:0},dvsMat3:s.displayViewScreenMat3,coordScale:t,srcImageSize:a,opacity:i},u=n[r.indexOf("u_transformGrid")],{transformGrid:c}=e,d=!(!u||!c),h=d?{transformTexture:{texture:u,unit:2},targetImageSize:[e.width,e.height],transformSpacing:c.spacing,transformGridSize:c.size}:void 0,p=n[r.indexOf("u_colormap")],{colormap:m,colormapOffset:f}=e.symbolizerParameters,y=p&&m?{colormapTexture:{texture:p,unit:1},colormapOffset:null!==f&&void 0!==f?f:0,colormapMaxIndex:m.length/4-1}:void 0,g=n[r.indexOf("u_mask")];return{config:l,projectionConfig:h,colormapConfig:y,pixelMaskConfig:g?{maskTexture:{texture:g,unit:3}}:void 0,projectionDefines:{applyProjection:d,lookupProjection:d&&1===c.spacing[0]}}}_getInterpolationDefines(e,t){const i="bilinear"===e&&t;return{bilinear:i,bicubic:"cubic"===e,nearestOnEdge:i}}}var ue=i(5095),ce=i(12331),de=i(29492),he=i(96673);function pe(e,t){const i=new he.R;return i.width=e,i.height=t,i.internalFormat=C.H0.RGBA32F,i.samplingMode=C.Cj.NEAREST,i.dataType=C.ld.FLOAT,i.isImmutable=!0,i.wrapMode=C.pF.CLAMP_TO_EDGE,i}function me(e,t,i){const s=pe(t,i);return new de.g(e,s)}function fe(e,t,i){const s=pe(t,i);return new ce.H(e,s)}class ye extends A.j{shutdown(e){var t;super.shutdown(e),null!==(t=this._fbo)&&void 0!==t&&t.dispose(),this._fbo=void 0}render(e,t){const{rasterFunction:i}=e;if(!i)return;const{context:s}=e,r="indexedColormap"in i.parameters?(0,T.hE)(s,i.parameters.indexedColormap):void 0,n="Reproject"===i.name,o=s.getBoundFramebufferObject(),a=s.getViewport();for(const l of t.bitmaps){const o=n?!(l.rasterTexture&&l.projected):!l.processed;if(!l.source||!o||l.suspended)continue;e.timeline.begin(this.name);const{painter:a}=e;a.setPipelineState({depth:!1,stencil:{test:!1,write:!1},color:{write:[!0,!0,!0,!0],blendMode:"custom",blendParameters:{srcRGB:C.dn.ONE,dstRGB:C.dn.ZERO,srcAlpha:C.dn.ONE,dstAlpha:C.dn.ZERO}}}),n||(l.processedTexture=(0,x.WD)(l.processedTexture)),l.updateTexture(e);const[u,c]=l.getRasterTextureSize(n),d=u===ue.CQ&&c===ue.CQ,h=d?t.processorFbo:fe(s,u,c);s.bindFramebuffer(h),s.setViewport(0,0,h.width,h.height),this._process(e,l,r);const p=me(e.context,u,c);if(h.copyToTexture(0,0,u,c,0,0,p),n)l.rasterTexture=p;else{const t=e.hasBranches?i.id:0;l.functionTextures[t]=p}d||h.dispose(),e.timeline.end(this.name)}null!==r&&void 0!==r&&r.dispose(),s.bindFramebuffer(o),s.setViewport(a.x,a.y,a.width,a.height)}_getCommonConfig(e,t){var i,s,r,n;const{rasterFunction:o,hasBranches:a}=e,{raster:l,rasters:u}=o.parameters,c=a?null!==(i=null!==(s=null===l||void 0===l?void 0:l.id)&&void 0!==s?s:null===u||void 0===u||null===(r=u.filter(e=>"Constant"!==e.name))||void 0===r||null===(r=r[0])||void 0===r?void 0:r.id)&&void 0!==i?i:-1:0,d=null!==(n=t.functionTextures[c])&&void 0!==n?n:t.rasterTexture,h="Reproject"===o.name;return{texture:{texture:d,unit:0},srcImageSize:t.getRasterTextureSize(h)}}_getMultipleInputConfig(e,t){return null!==t&&void 0!==t&&t.length?2===t.length?{twoRasterConfig:this._getTwoInputConfig(t,e)}:3===t.length?{threeRasterConfig:this._getThreeInputConfig(t,e)}:{}:{}}_getConstantCount(e){var t;return null!==(t=null===e||void 0===e?void 0:e.filter(e=>"Constant"===e.name).length)&&void 0!==t?t:0}_getTextures(e,t){return e.filter(e=>"Constant"!==e.name).map(e=>null!=e.id&&"Identity"!==e.name?t.functionTextures[e.id]:t.rasterTexture)}_getTwoInputConfig(e,t){const i=this._getTextures(e,t),s=i[1]?{texture:i[1],unit:1}:void 0,r=e.findIndex(e=>"Constant"===e.name),n=0===r?new Float32Array([0,1,0,1,0,0,0,0,0]):new Float32Array([1,0,0,0,1,0,0,0,0]);return{image1:s,image1Const:r>-1?e[r].parameters.value:0,imageSwap:n}}_getThreeInputConfig(e,t){const i=this._getTextures(e,t);let s=0,r=0,n=new Float32Array([1,0,0,0,1,0,0,0,1]);const o=i[1]?{texture:i[1],unit:1}:void 0,a=i[2]?{texture:i[2],unit:2}:void 0,l=[];if(e.forEach((e,t)=>"Constant"===e.name&&l.push(t)),1===l.length)s=e[l[0]].parameters.value,n=0===l[0]?new Float32Array([0,1,0,0,0,1,1,0,0]):1===l[0]?new Float32Array([1,0,0,0,0,1,0,1,0]):new Float32Array([1,0,0,0,1,0,0,0,1]);else if(2===l.length){s=e[l[0]].parameters.value,r=e[l[1]].parameters.value;const t=e.findIndex(e=>"Constant"!==e.name);n=0===t?new Float32Array([1,0,0,0,1,0,0,0,1]):1===t?new Float32Array([0,1,0,1,0,0,0,0,1]):new Float32Array([0,0,1,1,0,0,0,1,0])}return{image1:o,image2:a,image1Const:s,image2Const:r,imageSwap:n}}}class ge extends F.ZA{}(0,s._)([(0,F.C5)(0,V.ZY)],ge.prototype,"position",void 0);class _e extends F.HS{}class xe extends F.k2{}(0,s._)([(0,F.Pi)(V.z7)],xe.prototype,"texture",void 0),(0,s._)([(0,F.Pi)(V.ZY)],xe.prototype,"srcImageSize",void 0);class we extends F.A{vertex(e){return{uv:e.position,glPosition:new V.Zb((0,Z.nb)(e.position),0,1)}}fragment(e){const t=new F.mm,i=D(e.uv),s=this._process(i);return t.fragColor=new V.Zb(s.rgb,1).multiply(s.a),t}_getPixel(e){return U(e,this.config)}}(0,s._)([(0,F.Pi)(xe)],we.prototype,"config",void 0),(0,s._)([(0,s.a)(0,(0,F.hF)(ge))],we.prototype,"vertex",null),(0,s._)([(0,s.a)(0,(0,F.hF)(_e))],we.prototype,"fragment",null);class be extends F.k2{}(0,s._)([(0,F.Pi)(V.ZY)],be.prototype,"cellSize",void 0);class ve extends we{constructor(){super(...arguments),this.type="AspectShader"}_process(e){const{texture:t}=this.config,i=J(t,e,this.config.srcImageSize),s=new V.ZY(1).divide(this.aspectConfig.cellSize.multiply(8)),{x:r,y:n}=ee(i,s),o=(0,V.ze)(n),a=i[9].multiply((0,V._S)((0,V.tn)(r).add((0,V.tn)(o)))),l=(0,V.tn)((0,V._S)(r)),u=new V.nt(3.14159265359),c=new V.nt(0),d=(0,V.PM)(c,o).multiply(.5).multiply(u).add((0,V.PM)(o,c).multiply(1.5).multiply(u)),h=(0,V.zi)(new V.nt(2.5).multiply(u).add((0,V.rY)(o,(0,V.ze)(r))),new V.nt(2).multiply(u)),p=(0,V.jh)(d,h,l).multiply(180).divide(u);return new V.Zb(p,p,p,a)}}(0,s._)([(0,F.Pi)(be)],ve.prototype,"aspectConfig",void 0);function Ce(e){const t=(0,V._S)(e),i=e.add((0,V.tn)(t).subtract(1));return t.multiply(t).divide(i)}function Te(e){return new V.Zb((0,V.RI)(e.rgb.add(.5)),e.a)}function Pe(e,t){return(0,V.PM)(t.x,e).multiply((0,V.PM)(e,t.y))}class Re extends F.k2{}(0,s._)([(0,F.Pi)(V.U)],Re.prototype,"bandIndexMat3",void 0);class Se extends F.k2{}(0,s._)([(0,F.Pi)(V.eB)],Se.prototype,"adjustments",void 0);class Me extends we{constructor(){super(...arguments),this.type="BandArithmeticShader",this.isOutputRounded=!1}_process(e){const t=this._getPixel(e),i=this.bandArithmeticConfig.bandIndexMat3.multiply(t.rgb),s=this._processIndex(i),r=new V.Zb(s,s,s,t.a);return this.isOutputRounded?Te(r):r}_processIndex(e){var t;const{r:i,g:s}=e,r=null===(t=this.adjustmentConfig)||void 0===t?void 0:t.adjustments;switch(this.indexType){case"ndxi":{const e=i.subtract(s),t=i.add(s);return e.multiply(Ce(t))}case"sr":return i.multiply(Ce(s));case"ci":return i.multiply(Ce(s)).subtract(1);case"savi":{const{x:e}=r,t=i.subtract(s),n=i.add(s).add(e);return t.multiply(Ce(n)).multiply(e.add(1))}case"tsavi":{const{x:e,y:t,z:n}=r,o=n.multiply(e.multiply(e).add(1)).subtract(t.multiply(e)),a=e.multiply(i.subtract(e.multiply(s)).subtract(t)),l=t.multiply(i).add(s).add(o);return a.multiply(Ce(l))}case"msavi":{const e=i.multiply(2).add(1),t=e.multiply(e).subtract(i.subtract(s).multiply(8));return e.subtract((0,V.RZ)(t)).multiply(.5)}case"gemi":{const e=i.multiply(i).subtract(s.multiply(s)).multiply(2).add(i.multiply(1.5)).add(s.multiply(.5)),t=i.add(s).add(.5),r=e.multiply(Ce(t)),n=r.multiply((0,Z.zb)(r.multiply(.25))),o=s.subtract(.125).multiply(Ce((0,Z.zb)(s)));return n.subtract(o)}case"pvi":{const{x:e,y:t}=r,n=(0,V.RZ)(e.multiply(e).add(1));return i.subtract(s.multiply(e)).subtract(t).multiply(Ce(n))}case"vari":{const t=e.g.subtract(e.r),i=e.g.add(e.r).subtract(e.b);return t.multiply(Ce(i))}case"rtvicore":return i.subtract(s).multiply(100).subtract(i.subtract(e.b).multiply(10));case"bai":{const e=(0,V.n7)(new V.nt(.1).subtract(s),new V.nt(2)),t=(0,V.n7)(new V.nt(.06).subtract(i),new V.nt(2));return Ce(e.add(t))}case"evi":{const t=e.b,r=i.add(s.multiply(6)).subtract(t.multiply(7.5)).add(1);return i.subtract(s).multiply(2.5).multiply(Ce(r))}case"wndwi":{const{r:t,g:i,b:s}=e,n=r.x,o=n.multiply(i),a=n.multiply(s),l=t.add(o).add(s).subtract(a);return t.subtract(o).subtract(s).add(a).multiply(Ce(l))}case"mtvi":{const t=e.b,r=(0,V.n7)(i.multiply(2).add(1),new V.nt(2)),n=i.multiply(6).subtract((0,V.RZ)(s).multiply(5)),o=(0,V.RZ)(r.subtract(n).subtract(.5)),a=i.subtract(t).multiply(1.2),l=s.subtract(t).multiply(2.5);return a.subtract(l).multiply(1.5).multiply(Ce(o))}default:return i}}}(0,s._)([F.E8],Me.prototype,"indexType",void 0),(0,s._)([F.E8],Me.prototype,"isOutputRounded",void 0),(0,s._)([(0,F.Pi)(Re)],Me.prototype,"bandArithmeticConfig",void 0),(0,s._)([(0,F.uK)(Se)],Me.prototype,"adjustmentConfig",void 0);class ke extends we{constructor(){super(...arguments),this.type="ColormapToRGBShader"}_process(e){const t=N(this._getPixel(e),new V.nt(1),this.colormapConfig,!1);return new V.Zb(t.xyz.multiply(255),t.a)}}(0,s._)([(0,F.Pi)(W)],ke.prototype,"colormapConfig",void 0);class Ie extends F.k2{}(0,s._)([(0,F.Pi)(V.z7)],Ie.prototype,"image1",void 0),(0,s._)([(0,F.Pi)(V.nt)],Ie.prototype,"image1Const",void 0),(0,s._)([(0,F.Pi)(V.U)],Ie.prototype,"imageSwap",void 0);class ze extends F.k2{}(0,s._)([(0,F.Pi)(V.z7)],ze.prototype,"image1",void 0),(0,s._)([(0,F.Pi)(V.z7)],ze.prototype,"image2",void 0),(0,s._)([(0,F.Pi)(V.nt)],ze.prototype,"image1Const",void 0),(0,s._)([(0,F.Pi)(V.nt)],ze.prototype,"image2Const",void 0),(0,s._)([(0,F.Pi)(V.U)],ze.prototype,"imageSwap",void 0);const Ae=e=>{class t extends e{constructor(){super(...arguments),this.constantCount=0,this.imageCount=1}_getRasterValues(e){const{imageCount:t}=this;if(1===t){const t=(0,V.US)(this.config.texture,e);return{a:t.r,b:t.g,c:t.b,alpha:t.a}}if(2===t){const t=this._getTwoValues(e);return{a:t.a,b:t.b,c:t.b,alpha:t.alpha}}return this._getThreeValues(e)}_getTwoValues(e){const t=(0,V.US)(this.config.texture,e);if(1===this.constantCount){const{imageSwap:e,image1Const:i}=this.twoRasterConfig,s=e.multiply(new V.eB(t.r,i,0));return{a:s.x,b:s.y,alpha:t.a}}const{image1:i}=this.twoRasterConfig,s=(0,V.US)(i,e);return{a:t.r,b:s.r,alpha:t.a.multiply(s.a)}}_getThreeValues(e){const t=(0,V.US)(this.config.texture,e),{imageSwap:i,image1:s,image2:r,image1Const:n,image2Const:o}=this.threeRasterConfig;if(2===this.constantCount){const e=i.multiply(new V.eB(t.r,n,o));return{a:e.x,b:e.y,c:e.z,alpha:t.a}}if(1===this.constantCount){const r=(0,V.US)(s,e),o=i.multiply(new V.eB(t.r,r.r,n));return{a:o.x,b:o.y,c:o.z,alpha:t.a.multiply(r.a)}}const a=(0,V.US)(s,e),l=(0,V.US)(r,e);return{a:t.r,b:a.r,c:l.r,alpha:t.a.multiply(a.a).multiply(l.a)}}}return(0,s._)([F.E8],t.prototype,"constantCount",void 0),(0,s._)([F.E8],t.prototype,"imageCount",void 0),(0,s._)([(0,F.uK)(Ie)],t.prototype,"twoRasterConfig",void 0),(0,s._)([(0,F.uK)(ze)],t.prototype,"threeRasterConfig",void 0),t};class Be extends(Ae(we)){constructor(){super(...arguments),this.type="CompositeBandShader"}_process(e){const{a:t,b:i,c:s,alpha:r}=this._getRasterValues(e);return new V.Zb(t,i,s,r)}}class Fe extends F.k2{}(0,s._)([(0,F.Pi)(V.ZY)],Fe.prototype,"domainRange",void 0);class Ve extends(Ae(we)){constructor(){super(...arguments),this.type="LocalShader",this.isOutputRounded=!1}_process(e){if("conditional"===this.operationName)return this._conditional(e);const{a:t,b:i,alpha:s}=this._getRasterValues(e),{value:r,alpha:n}=this._compute(t,i,s);return this._processResult(r,n)}_processResult(e,t){const i=Pe(e,this.domainRangeConfig.domainRange),s=new V.Zb(e,e,e,t).multiply(i);return this.isOutputRounded?Te(s):s}_compute(e,t,i){const{operationName:s}=this;let r;switch(s){case"plus":r=e.add(t);break;case"minus":r=e.subtract(t);break;case"times":r=e.multiply(t);break;case"divide":case"floatdivide":r=e.multiply(Ce(t)),i=i.multiply((0,V.fV)((0,V.tn)((0,V._S)(t))));break;case"floordivide":r=(0,V.RI)(e.multiply(Ce(t))),i=i.multiply((0,V.fV)((0,V.tn)((0,V._S)(t))));break;case"square":r=e.multiply(e);break;case"sqrt":r=(0,V.RZ)(e);break;case"power":r=(0,V.n7)(e,t);break;case"ln":r=(0,V.Tk)((0,V.MM)(e,new V.nt(0)),(0,V.Rm)(e),new V.nt(0)),i=i.multiply(this._isAboveZero(e));break;case"log10":r=(0,V.Tk)((0,V.MM)(e,new V.nt(0)),(0,V.p6)(e).multiply(Ce((0,V.p6)(new V.nt(10)))),new V.nt(0)),i=i.multiply(this._isAboveZero(e));break;case"log2":r=(0,V.Tk)((0,V.MM)(e,new V.nt(0)),(0,V.p6)(e),new V.nt(0)),i=i.multiply(this._isAboveZero(e));break;case"exp":r=(0,V.oN)(e);break;case"exp10":r=(0,V.n7)(new V.nt(10),e);break;case"exp2":r=(0,V.n7)(new V.nt(2),e);break;case"rounddown":r=(0,V.RI)(e);break;case"roundup":r=(0,V.mk)(e);break;case"int":r=(0,V._S)(e).multiply((0,V.RI)((0,V.tn)(e)));break;case"mod":r=(0,V.zi)(e,t);break;case"negate":r=(0,V.ze)(e);break;case"abs":r=(0,V.tn)(e);break;case"acos":{const t=this._isAbsBiggerThanOne(e);r=(0,V.Tk)(t,new V.nt(0),(0,V.HQ)(e)),i=(0,V.Tk)(t,new V.nt(0),i);break}case"acosh":r=(0,V.YN)(e);break;case"asin":{const t=this._isAbsBiggerThanOne(e);r=(0,V.Tk)(t,new V.nt(0),(0,V.qR)(e)),i=(0,V.Tk)(t,new V.nt(0),i);break}case"asinh":r=(0,V.yH)(e);break;case"atan":r=(0,V.rY)(e);break;case"atanh":{const t=this._isAbsBiggerThanOne(e);r=(0,V.Tk)(t,new V.nt(0),(0,V.rf)(e)),i=(0,V.Tk)(t,new V.nt(0),i);break}case"atan2":r=(0,V.rY)(e,t);break;case"cos":r=(0,V.gn)(e);break;case"cosh":r=(0,V.yI)(e);break;case"sin":r=(0,V.F8)(e);break;case"sinh":r=(0,V.L0)(e);break;case"tan":r=(0,V.Ml)(e);break;case"tanh":r=(0,V.ym)(e);break;case"bitwiseand":r=new V.nt((0,V.nf)(new V.Ai(e),new V.Ai(t)));break;case"bitwiseor":r=new V.nt((0,V.pu)(new V.Ai(e),new V.Ai(t)));break;case"bitwiseleftshift":r=new V.nt((0,V.wH)(new V.Ai(e),new V.Ai(t)));break;case"bitwiserightshift":r=new V.nt((0,V.Sj)(new V.Ai(e),new V.Ai(t)));break;case"bitwisenot":r=new V.nt((0,V.FM)(new V.Ai(e)));break;case"bitwisexor":r=new V.nt((0,V.hC)(new V.Ai(e),new V.Ai(t)));break;case"booleanand":r=(0,V.fV)((0,V.Uo)((0,V.Ec)(e,new V.nt(0)),(0,V.Ec)(t,new V.nt(0))));break;case"booleanor":r=(0,V.fV)((0,V.or)((0,V.Ec)(e,new V.nt(0)),(0,V.Ec)(t,new V.nt(0))));break;case"booleannot":r=(0,V.fV)((0,V.LC)(e,new V.nt(0)));break;case"booleanxor":r=(0,V.fV)((0,V.I8)((0,V.Ec)(e,new V.nt(0)),(0,V.Ec)(t,new V.nt(0))));break;case"greaterthan":r=(0,V.fV)((0,V.MM)(e,t));break;case"greaterthanequal":r=(0,V.fV)((0,V.aX)(e,t));break;case"lessthan":r=(0,V.fV)((0,V.Xe)(e,t));break;case"lessthanequal":r=(0,V.fV)((0,V.$5)(e,t));break;case"equalto":r=(0,V.fV)((0,V.LC)(e,t));break;case"notequal":r=(0,V.fV)((0,V.Ec)(e,t));break;case"isnull":r=(0,V.fV)((0,V.LC)(i,new V.nt(0))),i=new V.nt(1);break;case"setnull":{const s=(0,V.fV)((0,V.LC)(e,new V.nt(0)));r=s.multiply(t),i=i.multiply(s);break}default:r=e}return{value:r,alpha:i}}_conditional(e){const{a:t,b:i,c:s,alpha:r}=this._getRasterValues(e),n=new V.nt((0,V.tn)((0,V._S)(t))),o=(0,V.jh)(s,i,n);return this._processResult(o,r)}_isAboveZero(e){return(0,V.fV)((0,V.MM)(e,new V.nt(0)))}_isAbsBiggerThanOne(e){return(0,V.MM)((0,V.tn)(e),new V.nt(1))}}(0,s._)([F.E8],Ve.prototype,"operationName",void 0),(0,s._)([F.E8],Ve.prototype,"isOutputRounded",void 0),(0,s._)([(0,F.Pi)(Fe)],Ve.prototype,"domainRangeConfig",void 0);class Ze extends(Ae(we)){constructor(){super(...arguments),this.type="ComputeChangeShader",this.isOutputRounded=!1}_process(e){const{a:t,b:i,alpha:s}=this._getRasterValues(e);let r=t.subtract(i);"relative-difference"===this.method&&(r=r.multiply(Ce((0,V.T9)((0,V.tn)(t),(0,V.tn)(i)))));const n=Pe(r,this.domainRangeConfig.domainRange),o=new V.Zb(r,r,r,s).multiply(n);return this.isOutputRounded?Te(o):o}}(0,s._)([F.E8],Ze.prototype,"method",void 0),(0,s._)([F.E8],Ze.prototype,"isOutputRounded",void 0),(0,s._)([(0,F.Pi)(Fe)],Ze.prototype,"domainRangeConfig",void 0);class Ee extends F.k2{}(0,s._)([(0,F.Pi)(V.nt)],Ee.prototype,"contrastOffset",void 0),(0,s._)([(0,F.Pi)(V.nt)],Ee.prototype,"brightnessOffset",void 0);class Oe extends we{constructor(){super(...arguments),this.type="ContrastBrightnessShader"}_process(e){const{rgb:t,a:i}=this._getPixel(e),{contrastOffset:s,brightnessOffset:r}=this.contrastBrightnessConfig,n=new V.nt(255),o=new V.nt(128),a=t.multiply(200),l=n.multiply(100),u=n.multiply(2).multiply(r),c=a.subtract(l).add(u),d=(0,V.j1)([(0,V.LC)(s,new V.nt(-100)),new V.eB(o)],[(0,V.LC)(s,new V.nt(100)),(0,V._S)(c).add(1).divide(2).multiply(n)],[(0,V.MM)(s,new V.nt(0)),c.divide(new V.nt(100).subtract(s).multiply(2)).add(o)],[!0,c.multiply(s.add(100)).divide(2e4).add(o)]);return Te(new V.Zb(d,i))}}(0,s._)([(0,F.Pi)(Ee)],Oe.prototype,"contrastBrightnessConfig",void 0);class De extends F.k2{}(0,s._)([(0,F.Pi)(V._i.ofType(V.nt,5,5,!0))],De.prototype,"kernel",void 0),(0,s._)([(0,F.Pi)(V.ZY)],De.prototype,"clampRange",void 0);class Ue extends we{constructor(){super(...arguments),this.type="ConvolutionShader",this.rows=3,this.cols=3}_process(e){const{rows:t,cols:i}=this,s=new V.ZY(Math.floor(t/2),Math.floor(i/2)),{texture:r,srcImageSize:n}=this.config,o=new V.nt(1).divide(n),{kernel:a}=this.convolutionConfig,l=(0,V.$T)(a,{initialValue:new V.Zb(0,0,0,1),xRange:[0,t],yRange:[0,i],callback:(t,i,n,a)=>{const l=new V.ZY(new V.nt(n),new V.nt(a)).subtract(s).multiply(o),u=(0,V.US)(r,X(e.add(l))),c=u.rgb.multiply(i).add(t.rgb),d=u.a.multiply(t.a);return new V.Zb(c,d)}}),{clampRange:u}=this.convolutionConfig;return new V.Zb((0,V.qE)(l.rgb,u.x,u.y),1).multiply(l.a)}}(0,s._)([F.E8],Ue.prototype,"rows",void 0),(0,s._)([F.E8],Ue.prototype,"cols",void 0),(0,s._)([(0,F.Pi)(De)],Ue.prototype,"convolutionConfig",void 0);class Ge extends F.k2{}(0,s._)([(0,F.Pi)(V.nt)],Ge.prototype,"zlFactor",void 0);class Le extends we{constructor(){super(...arguments),this.type="CurvatureShader"}_process(e){const{texture:t}=this.config,i=J(t,e,this.config.srcImageSize),s=i[3].add(i[5]).multiply(.5).subtract(i[4]),r=i[1].add(i[7]).multiply(.5).subtract(i[4]),{zlFactor:n}=this.curvatureConfig,{curvatureType:o}=this;let a;if("standard"===o)a=(0,V.ze)(n).multiply(s.add(r));else{const e=i[2].subtract(i[0]).add(i[6]).subtract(i[8]).divide(4),t=i[5].subtract(i[3]).divide(2),l=i[1].subtract(i[7]).divide(2),u=t.multiply(t),c=l.multiply(l),d=t.multiply(l),h=n.divide(u.add(c));a="profile"===o?(0,V.Om)(new V.eB(s,r,e),new V.eB(u,c,d)).multiply(h):(0,V.Om)(new V.eB(s,r,(0,V.ze)(e)),new V.eB(c,u,d)).multiply((0,V.ze)(h))}return new V.Zb(a,a,a,i[9])}}(0,s._)([F.E8],Le.prototype,"curvatureType",void 0),(0,s._)([(0,F.Pi)(Ge)],Le.prototype,"curvatureConfig",void 0);class je extends F.k2{}(0,s._)([(0,F.Pi)(V.U)],je.prototype,"bandIndexMat3",void 0);class qe extends we{constructor(){super(...arguments),this.type="ExtractBandShader"}_process(e){const t=this._getPixel(e),i=this.extractBandConfig.bandIndexMat3.multiply(t.rgb);return new V.Zb(i,t.a)}}(0,s._)([(0,F.Pi)(je)],qe.prototype,"extractBandConfig",void 0);class Ye extends F.k2{}(0,s._)([(0,F.Pi)(V.ZY)],Ye.prototype,"clampRange",void 0);class We extends we{constructor(){super(...arguments),this.type="FocalStatisticsShader",this.rows=3,this.cols=3,this.fill=!1}_process(e){const t=this._process1(e),i=(0,V.PM)(new V.nt(1),t.a);if(!this.fill)return this._clamp(t.rgb,i);const s=this._getPixel(e),r=(0,V.jh)(t.rgb,s.rgb,s.a);return this._clamp(r,i)}_clamp(e,t){const{clampRange:i}=this.focalStatisticsConfig;return new V.Zb((0,V.qE)(e,i.x,i.y),1).multiply(t)}_process1(e){const{texture:t,srcImageSize:i}=this.config,{rows:s,cols:r}=this,n=new V.ZY(Math.floor(s/2),Math.floor(r/2)),o=new V.nt(1).divide(i),a=this._getPixel(e),{statisticsType:l}=this,u="min"===l||"max"===l?new V.Zb(a.rgb,0):new V.Zb(0,0,0,0);switch(l){case"min":return this._stat(s,r,u,(i,s,r)=>{const a=new V.ZY(new V.nt(s),new V.nt(r)).subtract(n).multiply(o),l=(0,V.US)(t,X(e.add(a))),u=(0,V.jk)(i.rgb,l.rgb);return new V.Zb(u,i.a.add(l.a))});case"max":return this._stat(s,r,u,(i,s,r)=>{const a=new V.ZY(new V.nt(s),new V.nt(r)).subtract(n).multiply(o),l=(0,V.US)(t,X(e.add(a))),u=(0,V.T9)(i.rgb,l.rgb);return new V.Zb(u,i.a.add(l.a))});case"mean":{const i=this._stat(s,r,u,(i,s,r)=>{const a=new V.ZY(new V.nt(s),new V.nt(r)).subtract(n).multiply(o),l=(0,V.US)(t,X(e.add(a))),u=i.rgb.add(l.rgb.multiply(l.a));return new V.Zb(u,i.a.add(l.a))}),a=i.rgb.multiply(Ce(i.a));return new V.Zb(a,i.a)}case"stddev":{const i=this._stat(s,r,u,(i,s,r)=>{const a=new V.ZY(new V.nt(s),new V.nt(r)).subtract(n).multiply(o),l=(0,V.US)(t,X(e.add(a))),u=i.rgb.add(l.rgb.multiply(l.a));return new V.Zb(u,i.a.add(l.a))}),a=this._stat(s,r,u,(i,s,r)=>{const a=new V.ZY(new V.nt(s),new V.nt(r)).subtract(n).multiply(o),l=(0,V.US)(t,X(e.add(a))),u=i.rgb.add(l.a.multiply(l.rgb).multiply(l.rgb));return new V.Zb(u,i.a.add(l.a))}),l=Ce(a.a),c=(0,V.RZ)(a.subtract(i.multiply(i).multiply(l)).multiply(l));return new V.Zb(c.rgb,i.a)}default:return a}}_stat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;const r=new V.Ai(0).setMutable().setDebugName("StatColIterator"),n=new V.Ai(0).setMutable().setDebugName("StatRowIterator"),o=i.setMutable().setDebugName("StatAccumulator"),a=s(o,r,n).setDebugName("StatPredicate"),l=(0,V.om)({iterX:r,iterY:n,accumulator:o},V.Zb,a,i=>{let{out:s,iterX:r,iterY:n,accumulator:o,subgraph:a}=i;return"\n  for (".concat(n," = 0; ").concat(n," < ").concat(e,"; ").concat(n,"++) {\n    for (").concat(r," = 0; ").concat(r," < ").concat(t,"; ").concat(r,"++) {\n  \n    ").concat(a.body,"\n  \n    ").concat(o," = ").concat(a.varName,";\n    }\n  }\n  ").concat(s," = ").concat(o,";\n  ")}).setDebugName("statBody");return l}}(0,s._)([F.E8],We.prototype,"rows",void 0),(0,s._)([F.E8],We.prototype,"cols",void 0),(0,s._)([F.E8],We.prototype,"statisticsType",void 0),(0,s._)([F.E8],We.prototype,"fill",void 0),(0,s._)([(0,F.Pi)(Ye)],We.prototype,"focalStatisticsConfig",void 0);class Ne extends F.k2{}(0,s._)([(0,F.Pi)(V.eB)],Ne.prototype,"weights",void 0);class He extends we{constructor(){super(...arguments),this.type="GrayscaleShader"}_process(e){const t=this._getPixel(e),{weights:i}=this.grayscaleConfig,s=(0,V.Om)(i,t.rgb);return new V.Zb(s,s,s,t.a)}}(0,s._)([(0,F.Pi)(Ne)],He.prototype,"grayscaleConfig",void 0);class Qe extends we{constructor(){super(...arguments),this.type="HillshadeShader",this.isMultidirectional=!1}_process(e){const{texture:t}=this.config,i=te(J(t,e,this.config.srcImageSize),this.hillshadeConfig,this.isMultidirectional);return new V.Zb(i.rgb.multiply(255),i.a)}}(0,s._)([F.E8],Qe.prototype,"isMultidirectional",void 0),(0,s._)([(0,F.Pi)($)],Qe.prototype,"hillshadeConfig",void 0);var Ke=i(52494);class $e extends F.k2{}(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,6))],$e.prototype,"includedRanges",void 0),(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,Ke.et))],$e.prototype,"noDataValues",void 0);class Xe extends we{constructor(){super(...arguments),this.type="MaskShader",this.isMultiband=!0}_process(e){const t=this._getPixel(e),i=this._computeNoDataFactor(t.r),s=this._computeRangeFactor(t.rgb);let r;if(this.isMultiband){const e=this._computeNoDataFactor(t.g),n=this._computeNoDataFactor(t.b),o=new V.eB(i,e,n).multiply(s);r=o.x.multiply(o.y).multiply(o.z)}else r=i.multiply(s.x);return t.multiply(r)}_computeNoDataFactor(e){const{noDataValues:t}=this.maskConfig;let i=new V.eB(1);for(let s=0;s<Ke.et/3;s++){const r=3*s,n=new V.eB(t[r+0],t[r+1],t[r+2]),o=(0,V.tn)((0,V._S)(n.subtract(e)));i=i.multiply(o)}return i.x.multiply(i.y).multiply(i.z)}_computeRangeFactor(e){const{includedRanges:t}=this.maskConfig,i=new V.eB(t[0],t[2],t[4]),s=new V.eB(t[1],t[3],t[5]);return(0,V.PM)(i,e).multiply((0,V.PM)(e,s))}}(0,s._)([F.E8],Xe.prototype,"isMultiband",void 0),(0,s._)([(0,F.Pi)($e)],Xe.prototype,"maskConfig",void 0);class Je extends F.k2{}(0,s._)([(0,F.Pi)(V.U)],Je.prototype,"bandIndexMat3",void 0);class et extends we{constructor(){super(...arguments),this.type="NDVIShader",this.scaled=!0}_process(e){const t=this._getPixel(e),{r:i,g:s}=this.ndviConfig.bandIndexMat3.multiply(t.rgb),r=i.subtract(s),n=i.add(s),o=r.multiply(Ce(n));if(!this.scaled)return new V.Zb(o,o,o,t.a);const a=(0,V.RI)(o.multiply(100).add(100.5));return new V.Zb(a,a,a,t.a)}}(0,s._)([F.E8],et.prototype,"scaled",void 0),(0,s._)([(0,F.Pi)(Je)],et.prototype,"ndviConfig",void 0);class tt extends F.k2{}(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,3*Ke.et))],tt.prototype,"rangeMaps",void 0),(0,s._)([(0,F.Pi)(V.My.ofType(V.nt,2*Ke.et))],tt.prototype,"noDataRanges",void 0),(0,s._)([(0,F.Pi)(V.nt)],tt.prototype,"unmatchMask",void 0),(0,s._)([(0,F.Pi)(V.nt)],tt.prototype,"replacementValue",void 0),(0,s._)([(0,F.Pi)(V.ZY)],tt.prototype,"clampRange",void 0);class it extends we{constructor(){super(...arguments),this.type="RemapShader"}_process(e){const t=this._getPixel(e),{rangeMaps:i,unmatchMask:s,clampRange:r,replacementValue:n}=this.remapConfig,{mapValue:o,includeMask:a}=function(e,t,i){const s=new V.eB(e);let r=new V.eB(0,0,0),n=new V.nt(0);for(let o=0;o<i/3;o++){const e=9*o,i=new V.eB(t[e],t[e+3],t[e+6]),a=new V.eB(t[e+1],t[e+4],t[e+7]),l=(0,V.PM)(i,s).multiply((0,V.PM)(s,a)),u=new V.eB(t[e+2],t[e+5],t[e+8]);n=(0,V.jh)(n,u.x,l.x),n=(0,V.jh)(n,u.y,l.y),n=(0,V.jh)(n,u.z,l.z),r=r.add(l)}return{mapValue:n,includeMask:(0,V._S)((0,V.Om)(r,new V.eB(1,1,1)))}}(t.r,i,Ke.et),l=this.replaceUnmatched?n:s.multiply(t.r),u=(0,V.jh)(l,o,a),c=(0,V.qE)(u,r.x,r.y),d=this._computeNoDataFactor(t.rrr).multiply((0,V.T9)(s,a));return new V.Zb(c,c,c,t.a).multiply(d)}_computeNoDataFactor(e){const{noDataRanges:t}=this.remapConfig;let i=new V.eB(0,0,0);for(let s=0;s<Ke.et/3;s++){const r=6*s,n=new V.eB(t[r],t[r+2],t[r+4]),o=new V.eB(t[r+1],t[r+3],t[r+5]);i=i.add((0,V.PM)(n,e).multiply((0,V.PM)(e,o)))}return(0,Z.zb)((0,V._S)((0,V.Om)(i,new V.eB(1,1,1))))}}(0,s._)([(0,F.Pi)(tt)],it.prototype,"remapConfig",void 0),(0,s._)([F.E8],it.prototype,"replaceUnmatched",void 0);class st extends Y{constructor(){super(...arguments),this.type="ReprojectShader"}_colorize(e){return this._getPixel(e)}}class rt extends Qe{constructor(){super(...arguments),this.type="ShadedReliefShader"}_process(e){const t=super._process(e),{minValue:i,maxValue:s}=this.hillshadeConfig,r=this._getPixel(e),n=s.subtract(i),o=r.r.subtract(i),a=(0,V.qE)(o.divide(n),new V.nt(0),new V.nt(1)),l=N(new V.Zb(a,a,a,1),new V.nt(255),this.colormapConfig),u=Q(l.xyz),c=K(new V.eB(u.xy,t.x.divide(255))).multiply(255);return new V.Zb(c,l.a.multiply(t.a))}}(0,s._)([(0,F.Pi)(W)],rt.prototype,"colormapConfig",void 0);class nt extends F.k2{}(0,s._)([(0,F.Pi)(V.nt)],nt.prototype,"pixelSizePower",void 0),(0,s._)([(0,F.Pi)(V.nt)],nt.prototype,"pixelSizeFactor",void 0),(0,s._)([(0,F.Pi)(V.nt)],nt.prototype,"zFactor",void 0),(0,s._)([(0,F.Pi)(V.ZY)],nt.prototype,"cellSize",void 0);class ot extends we{constructor(){super(...arguments),this.type="SlopeShader",this.isOutputRounded=!1,this.percentRise=!1}_process(e){const{cellSize:t,pixelSizePower:i,pixelSizeFactor:s,zFactor:r}=this.slopeConfig,n=(0,V.n7)(t,new V.ZY(i)).multiply(s).add(r).divide(t.multiply(8)),{texture:o}=this.config,a=J(o,e,this.config.srcImageSize),{x:l,y:u}=ee(a,n),c=(0,V.RZ)(l.multiply(l).add(u.multiply(u))),d=this.percentRise?c.multiply(100):(0,V.rY)(c).multiply(57.2957795),h=new V.Zb(d,d,d,a[9]);return this.isOutputRounded?Te(h):h}}(0,s._)([F.E8],ot.prototype,"isOutputRounded",void 0),(0,s._)([F.E8],ot.prototype,"percentRise",void 0),(0,s._)([(0,F.Pi)(nt)],ot.prototype,"slopeConfig",void 0);class at extends we{constructor(){super(...arguments),this.type="StretchShader",this.isMultiband=!0,this.isOutputRounded=!1,this.useGamma=!1}_process(e){let t=oe(this._getPixel(e),this.stretchConfig,this.useGamma,1);return this.isMultiband||(t=new V.Zb(t.rrr,t.a)),this.isOutputRounded?Te(t):t}}(0,s._)([F.E8],at.prototype,"isMultiband",void 0),(0,s._)([F.E8],at.prototype,"isOutputRounded",void 0),(0,s._)([F.E8],at.prototype,"useGamma",void 0),(0,s._)([(0,F.Pi)(ne)],at.prototype,"stretchConfig",void 0);const lt=new Map([["Aspect",class extends ye{constructor(){super(...arguments),this.name="RasterAspectProcessor",this.type=B.Y.Aspect,this.shaders={aspect:new ve}}_process(e,t){const i={cellSize:t.getRasterCellSize()},s=this._getCommonConfig(e,t),r={shader:this.shaders.aspect,uniforms:{config:s,aspectConfig:i},defines:{},optionalAttributes:null,useComputeBuffer:!1},{painter:n,context:o}=e;n.submitDrawMesh(o,r,n.quadMesh)}}],["BandArithmetic",class extends ye{constructor(){super(...arguments),this.name="RasterBandArithmeticProcessor",this.type=B.Y.BandArithmetic,this.shaders={bandArithmetic:new Me}}_process(e,t){const i=e.rasterFunction.parameters,s={indexType:i.indexType,isOutputRounded:i.isOutputRounded},r={bandIndexMat3:i.bandIndexMat3},n=i.adjustments?{adjustments:[...i.adjustments]}:void 0,o=this._getCommonConfig(e,t),a={shader:this.shaders.bandArithmetic,uniforms:{config:o,bandArithmeticConfig:r,adjustmentConfig:n},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:l,context:u}=e;l.submitDrawMesh(u,a,l.quadMesh)}}],["ColormapToRGB",class extends ye{constructor(){super(...arguments),this.name="RasterColormapToRGBProcessor",this.type=B.Y.ColormapToRGB,this.shaders={colormapToRGB:new ke}}_process(e,t,i){const s=e.rasterFunction.parameters,r={colormapTexture:{texture:i,unit:1},colormapOffset:s.offset,colormapMaxIndex:s.indexedColormap.length/4-1},n=this._getCommonConfig(e,t),o={shader:this.shaders.colormapToRGB,uniforms:{config:n,colormapConfig:r},defines:{},optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["CompositeBand",class extends ye{constructor(){super(...arguments),this.name="RasterCompositeBandProcessor",this.type=B.Y.CompositeBand,this.shaders={compositeBand:new Be}}_process(e,t){var i;const{rasters:s}=e.rasterFunction.parameters,r={constantCount:this._getConstantCount(s),imageCount:null!==(i=null===s||void 0===s?void 0:s.length)&&void 0!==i?i:1},n=this._getMultipleInputConfig(t,s),o=this._getCommonConfig(e,t),a={shader:this.shaders.compositeBand,uniforms:(0,z.A)({config:o},n),defines:r,optionalAttributes:null,useComputeBuffer:!1},{painter:l,context:u}=e;l.submitDrawMesh(u,a,l.quadMesh)}}],["ComputeChange",class extends ye{constructor(){super(...arguments),this.name="RasterComputeChangeProcessor",this.type=B.Y.ComputeChange,this.shaders={computeChange:new Ze}}_process(e,t){const i=e.rasterFunction.parameters,{rasters:s}=i,r={constantCount:this._getConstantCount(s),imageCount:s.length,method:i.method,isOutputRounded:i.isOutputRounded},n={domainRange:i.domainRange},{twoRasterConfig:o}=this._getMultipleInputConfig(t,s),a=this._getCommonConfig(e,t),l={shader:this.shaders.computeChange,uniforms:{config:a,domainRangeConfig:n,twoRasterConfig:o},defines:r,optionalAttributes:null,useComputeBuffer:!1},{painter:u,context:c}=e;u.submitDrawMesh(c,l,u.quadMesh)}}],["ContrastBrightness",class extends ye{constructor(){super(...arguments),this.name="RasterContrastBrightnessProcessor",this.type=B.Y.ContrastBrightness,this.shaders={contrastBrightness:new Oe}}_process(e,t){const i=this._getCommonConfig(e,t),s=e.rasterFunction.parameters,r={shader:this.shaders.contrastBrightness,uniforms:{config:i,contrastBrightnessConfig:s},defines:{},optionalAttributes:null,useComputeBuffer:!1},{painter:n,context:o}=e;n.submitDrawMesh(o,r,n.quadMesh)}}],["Convolution",class extends ye{constructor(){super(...arguments),this.name="RasterConvolutionProcessor",this.type=B.Y.Convolution,this.shaders={convolution:new Ue}}_process(e,t){const i=e.rasterFunction.parameters,s={rows:i.kernelRows,cols:i.kernelCols},r={kernel:[...i.kernel],clampRange:i.clampRange},n=this._getCommonConfig(e,t),o={shader:this.shaders.convolution,uniforms:{config:n,convolutionConfig:r},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["Curvature",class extends ye{constructor(){super(...arguments),this.name="RasterCurvatureProcessor",this.type=B.Y.Curvature,this.shaders={curvature:new Le}}_process(e,t){const i=e.rasterFunction.parameters,s={curvatureType:i.curvatureType},r=t.getRasterCellSize(),n={zlFactor:200*i.zFactor/r[0]/r[1]},o=this._getCommonConfig(e,t),a={shader:this.shaders.curvature,uniforms:{config:o,curvatureConfig:n},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:l,context:u}=e;l.submitDrawMesh(u,a,l.quadMesh)}}],["ExtractBand",class extends ye{constructor(){super(...arguments),this.name="RasterExtractBandProcessor",this.type=B.Y.ExtractBand,this.shaders={extractBand:new qe}}_process(e,t){const i={bandIndexMat3:e.rasterFunction.parameters.bandIndexMat3},s=this._getCommonConfig(e,t),r={shader:this.shaders.extractBand,uniforms:{config:s,extractBandConfig:i},defines:{},optionalAttributes:null,useComputeBuffer:!1},{painter:n,context:o}=e;n.submitDrawMesh(o,r,n.quadMesh)}}],["Grayscale",class extends ye{constructor(){super(...arguments),this.name="RasterGrayscaleProcessor",this.type=B.Y.Grayscale,this.shaders={grayscale:new He}}_process(e,t){const i={weights:e.rasterFunction.parameters.weights},s=this._getCommonConfig(e,t),r={shader:this.shaders.grayscale,uniforms:{config:s,grayscaleConfig:i},defines:{},optionalAttributes:null,useComputeBuffer:!1},{painter:n,context:o}=e;n.submitDrawMesh(o,r,n.quadMesh)}}],["Hillshade",class extends ye{constructor(){super(...arguments),this.name="RasterHillshadeProcessor",this.type=B.Y.Hillshade,this.shaders={hillshade:new Qe}}_process(e,t){const i=e.rasterFunction.parameters,s={isMultidirectional:i.hillshadeType>0},r=se(i,t.getRasterCellSize()),n=(0,z.A)((0,z.A)({},i),{},{factor:r,minValue:0,maxValue:8e3}),o=this._getCommonConfig(e,t),a={shader:this.shaders.hillshade,uniforms:{config:o,hillshadeConfig:n},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:l,context:u}=e;l.submitDrawMesh(u,a,l.quadMesh)}}],["Local",class extends ye{constructor(){super(...arguments),this.name="RasterLocalProcessor",this.type=B.Y.Local,this.shaders={local:new Ve}}_process(e,t){var i;const s=e.rasterFunction.parameters,r={constantCount:this._getConstantCount(s.rasters),imageCount:s.imageCount,operationName:s.operationName,isOutputRounded:s.isOutputRounded},n={domainRange:s.domainRange},o="conditional"===s.operationName?s.rasters:null===(i=s.rasters)||void 0===i?void 0:i.slice(0,2),a=this._getMultipleInputConfig(t,o),l=this._getCommonConfig(e,t),u={shader:this.shaders.local,uniforms:(0,z.A)({config:l,domainRangeConfig:n},a),defines:r,optionalAttributes:null,useComputeBuffer:!1},{painter:c,context:d}=e;c.submitDrawMesh(d,u,c.quadMesh)}}],["Mask",class extends ye{constructor(){super(...arguments),this.name="RasterMaskProcessor",this.type=B.Y.Mask,this.shaders={mask:new Xe}}_process(e,t){const i=e.rasterFunction.parameters,s={isMultiband:i.bandCount>1},r={includedRanges:[...i.includedRanges],noDataValues:[...i.noDataValues]},n=this._getCommonConfig(e,t),o={shader:this.shaders.mask,uniforms:{config:n,maskConfig:r},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["NDVI",class extends ye{constructor(){super(...arguments),this.name="RasterNDVIProcessor",this.type=B.Y.NDVI,this.shaders={ndvi:new et}}_process(e,t){const i=e.rasterFunction.parameters,s={scaled:i.scaled},r={bandIndexMat3:i.bandIndexMat3},n=this._getCommonConfig(e,t),o={shader:this.shaders.ndvi,uniforms:{config:n,ndviConfig:r},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["Remap",class extends ye{constructor(){super(...arguments),this.name="RasterRemapProcessor",this.type=B.Y.Remap,this.shaders={remap:new it}}_process(e,t){var i;const s=e.rasterFunction.parameters,r={replaceUnmatched:s.allowUnmatched&&null!=s.replacementValue},n={rangeMaps:[...s.rangeMaps],noDataRanges:[...s.noDataRanges],unmatchMask:s.allowUnmatched?1:0,replacementValue:null!==(i=s.replacementValue)&&void 0!==i?i:0,clampRange:s.clampRange},o=this._getCommonConfig(e,t),a={shader:this.shaders.remap,uniforms:{config:o,remapConfig:n},defines:r,optionalAttributes:null,useComputeBuffer:!1},{painter:l,context:u}=e;l.submitDrawMesh(u,a,l.quadMesh)}}],["Reproject",class extends ye{constructor(){super(...arguments),this.name="RasterReprojectProcessor",this.type=B.Y.Reproject,this.shaders={reproject:new st}}_process(e,t){const i=e.rasterFunction.parameters,s=this._getInterpolationDefines(t.interpolation,!!i.requireNNEdge),{config:r,projectionConfig:n,projectionDefines:o}=this._getReprojectConfig(t),a={shader:this.shaders.reproject,uniforms:{config:r,projectionConfig:n},defines:(0,z.A)((0,z.A)((0,z.A)({},o),s),{},{applyPixelMask:!1}),optionalAttributes:null,useComputeBuffer:!1},{interpolation:l}=t;t.interpolation="nearest";const{painter:u,context:c}=e;u.submitDrawMesh(c,a,u.quadMesh),t.interpolation=l,t.projected=!0}_getReprojectConfig(e){const{source:t}=e,{names:i,textures:s}=e.getTextures({forProcessing:!0}),r={texture:{texture:s[i.indexOf("u_image")],unit:0},dvsMat3:new Float32Array([2,0,0,0,2,0,-1,-1,0]),coordScale:[1,1],srcImageSize:[t.width,t.height],opacity:1},n=s[i.indexOf("u_transformGrid")],{transformGrid:o}=e,a=!(!n||!o);return{config:r,projectionConfig:a?{transformTexture:{texture:n,unit:1},targetImageSize:[e.width,e.height],transformSpacing:o.spacing,transformGridSize:o.size}:void 0,projectionDefines:{applyProjection:a,lookupProjection:a&&1===o.spacing[0]}}}_getInterpolationDefines(e,t){const i="bilinear"===e&&t;return{bilinear:i,bicubic:"cubic"===e,nearestOnEdge:i}}}],["ShadedRelief",class extends ye{constructor(){super(...arguments),this.name="RasterShadedReliefProcessor",this.type=B.Y.ShadedRelief,this.shaders={shadedRelief:new rt}}_process(e,t,i){const s=e.rasterFunction.parameters,r={isMultidirectional:s.hillshadeType>0},n=se(s,t.getRasterCellSize()),o=(0,z.A)((0,z.A)({},s),{},{factor:n}),a={colormapTexture:{texture:i,unit:1},colormapOffset:s.offset,colormapMaxIndex:s.indexedColormap.length/4-1},l=this._getCommonConfig(e,t),u={shader:this.shaders.shadedRelief,uniforms:{config:l,hillshadeConfig:o,colormapConfig:a},defines:r,optionalAttributes:null,useComputeBuffer:!1},{painter:c,context:d}=e;c.submitDrawMesh(d,u,c.quadMesh)}}],["Slope",class extends ye{constructor(){super(...arguments),this.name="RasterSlopeProcessor",this.type=B.Y.Slope,this.shaders={slope:new ot}}_process(e,t){const i=e.rasterFunction.parameters,s={isOutputRounded:i.isOutputRounded,percentRise:"percent-rise"===i.slopeType},r={cellSize:t.getRasterCellSize(),pixelSizePower:"adjusted"===i.slopeType?i.pixelSizePower:0,pixelSizeFactor:"adjusted"===i.slopeType?i.pixelSizeFactor:0,zFactor:i.zFactor},n=this._getCommonConfig(e,t),o={shader:this.shaders.slope,uniforms:{config:n,slopeConfig:r},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["Statistics",class extends ye{constructor(){super(...arguments),this.name="RasterFocalStatisticsProcessor",this.type=B.Y.Statistics,this.shaders={focalStatistics:new We}}_process(e,t){const i=e.rasterFunction.parameters,s={rows:i.kernelRows,cols:i.kernelCols,statisticsType:i.statisticsType,fill:i.fillNoDataOnly},r={clampRange:i.clampRange},n=this._getCommonConfig(e,t),o={shader:this.shaders.focalStatistics,uniforms:{config:n,focalStatisticsConfig:r},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:a,context:l}=e;a.submitDrawMesh(l,o,a.quadMesh)}}],["Stretch",class extends ye{constructor(){super(...arguments),this.name="RasterStretchProcessor",this.type=B.Y.Stretch,this.shaders={stretch:new at}}_process(e,t){const i=e.rasterFunction.parameters,s={isMultiband:i.bandCount>1,isOutputRounded:i.isOutputRounded,useGamma:i.useGamma},r=this._getCommonConfig(e,t),n={shader:this.shaders.stretch,uniforms:{config:r,stretchConfig:i},defines:s,optionalAttributes:null,useComputeBuffer:!1},{painter:o,context:a}=e;o.submitDrawMesh(a,n,o.quadMesh)}}]]);class ut extends A.j{constructor(){super(...arguments),this.type=B.Y.RasterProcessor,this.shaders={},this._techniques=new Map}shutdown(e){var t;super.shutdown(e),null!==(t=this._fbo)&&void 0!==t&&t.dispose(),this._fbo=void 0;for(const i of this._techniques.values())i.shutdown();this._techniques.clear()}render(e,t){var i;null!==(i=this._fbo)&&void 0!==i||(this._fbo=fe(e.context,ue.CQ,ue.CQ));let{name:s}=e.rasterFunction;if("Arithmetic"===s&&(s="Local"),!this._techniques.has(s)){const e=lt.get(s);if(!e)return;this._techniques.set(s,new e)}this._techniques.get(s).render(e,(0,z.A)((0,z.A)({},t),{},{processorFbo:this._fbo}))}}class ct extends I.A{constructor(){super(...arguments),this.isCustomTilingScheme=!1}createTile(e){const t=this._getTileBounds(e),[i,s]=this.tileInfoView.tileInfo.size,r=this.tileInfoView.getTileResolution(e.level);return new M(e,r,t[0],t[3],i,s)}onAttach(){super.onAttach(),this._colorizerTechnique=new le,this._processorTechnique=new ut}onDetach(){var e,t;super.onDetach(),null!==(e=this._colorizerTechnique)&&void 0!==e&&e.shutdown(),this._colorizerTechnique=void 0,null!==(t=this._processorTechnique)&&void 0!==t&&t.shutdown(),this._processorTechnique=void 0}doRender(e){var t;if(!this.visible||e.drawPhase!==k.S5.MAP||!this._colorizerTechnique)return;const{rasterFunctionChain:i}=this;if(null!==i&&void 0!==i&&null!==(t=i.functions)&&void 0!==t&&t.length){if(!this._processorTechnique)return;const{functions:t,hasBranches:s}=i;for(const i of t){if("Constant"===i.name||"Identity"===i.name)continue;e.rasterFunction=i,e.hasBranches=s,super.doRender(e);const t=this.children.map(e=>e.bitmap);this._processorTechnique.render(e,{bitmaps:t})}}e.rasterFunction=null,super.doRender(e);const s=this.children.map(e=>e.bitmap);this._colorizerTechnique.render(e,{bitmaps:s})}_getTileBounds(e){const t=this.tileInfoView.getTileBounds((0,y.vt)(),e);if(this.isCustomTilingScheme&&e.world){const{tileInfo:i}=this.tileInfoView,s=(0,g.FT)(i.spatialReference);if(s){const r=i.lodAt(e.level);if(!r)return t;const{resolution:n}=r,o=n*i.size[0];t[0]=s*e.world+i.origin.x+e.col*o,t[2]=t[0]+o}}return t}}var dt=i(91967),ht=i(19451),pt=i(76797),mt=i(19247),ft=i(66486),yt=i(88235),gt=i(12838),_t=i(59844),xt=i(40181),wt=(i(93453),i(15302)),bt=i(96345),vt=i(59752),Ct=i(9685);const Tt=[0,0];let Pt=class extends dt.A{constructor(){var e;super(...arguments),e=this,this._updatingHandles=new ht.U,this._emptyTilePixelBlock=null,this._tileStrategy=null,this._tileInfoView=null,this._fetchQueue=null,this._blockCacheRegistryUrl=null,this._blockCacheRegistryId=null,this._srcResolutions=[],this.previousLOD=null,this._needBlockCacheUpdate=!1,this._globalSymbolizerParams=null,this._symbolizerParams=null,this._abortController=null,this._isCustomTilingScheme=!1,this._maxIndexedColormapSize=0,this._rasterFunctionState="na",this._globalUpdateRequested=!1,this.attached=!1,this.timeExtent=null,this.redrawOrRefetch=(0,n.sg)(async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const i=e._rasterFunctionState,s=t.reprocess||"gpu"===i&&!e.canUseWebGLForProcessing||"cpu"===i&&e.canUseWebGLForProcessing;if(s&&(await e._updatingHandles.addPromise(e.layer.updateRasterFunction()),e.updateRasterFunctionParameters()),!e.previousLOD||e.layerView.suspended)return;const r=e._rasterFunctionState,{type:n}=e;return t.refetch||"raster"!==n&&s||"cpu"===r||"cpu"===i?e._updatingHandles.addPromise(e.doRefresh()):e._updatingHandles.addPromise(e._redrawImage(t.signal))})}destroy(){this._updatingHandles.destroy()}get canUseWebGLForProcessing(){return!1}get canUseLocalSymbolizerParams(){return(this.canUseWebGLForProcessing||"rasterVF"===this.type)&&!this.layerView.hasTilingEffects}get useWebGLForProcessing(){var e;return null===(e=this._get("useWebGLForProcessing"))||void 0===e||e}set useWebGLForProcessing(e){this._set("useWebGLForProcessing",e)}get useProgressiveUpdate(){var e;return null===(e=this._get("useProgressiveUpdate"))||void 0===e||e}set useProgressiveUpdate(e){if(this._tileStrategy&&this.useProgressiveUpdate!==e){this._tileStrategy.destroy(),this.container.removeAllChildren();const t=this._getCacheSize(e);this._tileStrategy=new bt.A({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:t,tileInfoView:this._tileInfoView}),this._set("useProgressiveUpdate",e),this.layerView.requestUpdate()}}update(e){this._fetchQueue.pause(),this._fetchQueue.state=e.state,this._tileStrategy.update(e),this._fetchQueue.resume();const{extent:t,resolution:i,scale:s}=e.state,r=this._tileInfoView.getClosestInfoForScale(s);if(this.layer.raster){var n;if(!this.useProgressiveUpdate||this._needBlockCacheUpdate){const e=this._srcResolutions[r.level],s="toJSON"in t?t:pt.A.fromJSON(t);(0,gt.yo)(this._blockCacheRegistryUrl,this._blockCacheRegistryId,s,i,e,this.layer.raster.ioConfig.sampling)}this._needBlockCacheUpdate=!1,(null===(n=this.previousLOD)||void 0===n?void 0:n.level)!==r.level&&(this.previousLOD=r,null!=this._symbolizerParams&&this.canUseLocalSymbolizerParams&&this._updateSymbolizerParams(),this._tileStrategy.updateCacheSize(0))}}moveEnd(){!this.layerView.hasTilingEffects&&this.useProgressiveUpdate||(this._abortController&&this._abortController.abort(),this._abortController=new AbortController,0===this._fetchQueue.length&&this._redrawImage(this._abortController.signal).then(()=>{this._globalUpdateRequested=!1,this.layerView.requestUpdate()}));const e=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy.updateCacheSize(e),this.layerView.requestUpdate()}get updating(){var e;return this._globalUpdateRequested||(null===(e=this._updatingHandles)||void 0===e?void 0:e.updating)}attach(){const e=(0,Ct.C)();this._maxIndexedColormapSize=4*(e.maxTextureSize||4096),this._initializeTileInfo(),this._tileInfoView=new xt.A(this.layerView.tileInfo,this.layerView.fullExtent);const t=this._computeFetchConcurrency();this._fetchQueue=new wt.A({tileInfoView:this._tileInfoView,concurrency:t,process:(e,t)=>this._fetchTile(e,t),priority:vt.W6.MAPVIEW_FETCH_QUEUE,scheduler:this.scheduler});const i=this._getCacheSize(this.useProgressiveUpdate);this._tileStrategy=new bt.A({cachePolicy:"purge",acquireTile:e=>this.acquireTile(e),releaseTile:e=>this.releaseTile(e),cacheSize:i,tileInfoView:this._tileInfoView}),this._updateBlockCacheRegistry()}detach(){this._tileStrategy.destroy(),this._fetchQueue.clear(),this.container.removeAllChildren(),this._fetchQueue=this._tileStrategy=this._tileInfoView=null,(0,gt.ht)(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryUrl=this._blockCacheRegistryId=null}acquireTile(e){const t=this.container.createTile(e);return this._updatingHandles.addPromise(this._enqueueTileFetch(t)),this.layerView.requestUpdate(),this._needBlockCacheUpdate=!0,this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,t}releaseTile(e){this._fetchQueue.abort(e.key.id),this.container.removeChild(e),e.once("detach",()=>{e.destroy(),this.layerView.requestUpdate()}),this.layerView.requestUpdate()}createEmptyTilePixelBlock(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const t=null==e||e.join(",")===this._tileInfoView.tileInfo.size.join(",");if(t&&null!=this._emptyTilePixelBlock)return this._emptyTilePixelBlock;e=e||this._tileInfoView.tileInfo.size;const[i,s]=e,r=new ft.A({width:i,height:s,pixels:[new Uint8Array(i*s)],mask:new Uint8Array(i*s),pixelType:"u8"});return t&&(this._emptyTilePixelBlock=r),r}_getBandIds(){if(!("rasterFunctionChain"in this.container)||!this.container.rasterFunctionChain)return this.layer.bandIds;const{bandIds:e,raster:t}=this.layer,i="rasterFunction"in t?t.rasterFunction.rawInputBandIds:null;return null!==e&&void 0!==e&&e.length&&null!==i&&void 0!==i&&i.length&&1!==t.rasterInfo.bandCount?e.map(e=>i[Math.min(e,i.length-1)]):"rasterFunction"in t?i:e}updateRasterFunctionParameters(){}_fetchTile(e,t){const i=this._getFetchOptions(e.level,t.signal);return this.fetchTile(e,i)}_getFetchOptions(e,t){var i;const{canUseWebGLForProcessing:s}=this,{layerView:r}=this,{tileInfo:n}=r,o=!n.isWrappable&&null!=(0,_t.FT)(r.view.spatialReference),a=s&&this.layer.raster.hasUniqueSourceStorageInfo,{layer:l}=this.layerView,u=null!==(i=l.serviceRasterInfo)&&void 0!==i&&i.storageInfo.isBsqTile?l.bandIds:void 0;return{allowPartialFill:!0,datumTransformation:r.datumTransformation,interpolation:s?"nearest":this.layer.interpolation,registryId:this._blockCacheRegistryId,requestRawData:a,skipRasterFunction:"raster"===this.type&&null!=this.container.rasterFunctionChain,signal:t,srcResolution:this._srcResolutions[e],timeExtent:r.timeExtent,tileInfo:n,bandIds:u,disableWrapAround:o}}_getCacheSize(e){return e?40:0}_initializeTileInfo(){const{layerView:e}=this,t=e.view.spatialReference;if(this._canUseLayerLODs()){const{origin:i,lods:s}=this.layer.tileInfo,r=s.map(e=>{let{scale:t}=e;return t}),n=yt.A.create({spatialReference:t,size:ue.CQ,scales:r,origin:i});return e.set("tileInfo",n),void(this._srcResolutions=s.map(e=>{let{resolution:t}=e;return{x:t,y:t}}))}const{scales:i,srcResolutions:s,isCustomTilingScheme:r}=(0,_t.dK)(this.layer.serviceRasterInfo,t,{tileSize:ue.CQ,alignGlobalDatasetWithAGOL:!0,limitToSrcResolution:!1}),n=yt.A.create({spatialReference:t,size:ue.CQ,scales:i}),o=0===n.origin.x;(0,x.Lw)(e.fullExtent);const{xmin:a,ymax:l}=e.fullExtent;(o||r&&n.origin.x>a)&&(n.origin=new mt.A({x:a,y:l,spatialReference:t})),this._isCustomTilingScheme=r,e.set("tileInfo",n),this._srcResolutions=null!==s&&void 0!==s?s:[]}_canUseLayerLODs(){var e;const{layer:t,layerView:i}=this;if("Map"!==t.raster.tileType)return!1;const{lods:s}=t.tileInfo,r=null===(e=i.view.constraints)||void 0===e?void 0:e.effectiveLODs;return(null===r||void 0===r?void 0:r.length)===s.length&&r.every((e,t)=>{let{scale:i}=e;return Math.abs(i-s[t].scale)<.001})}_computeFetchConcurrency(){const{blockBoundary:e}=this.layer.serviceRasterInfo.storageInfo,t=e[e.length-1];return(t.maxCol-t.minCol+1)*(t.maxRow-t.minRow+1)>64?2:10}async _enqueueTileFetch(e,t){if(!this._fetchQueue.has(e.key.id)){try{const t=await this._fetchQueue.push(e.key),o=this._getBandIds();let a=!this.useProgressiveUpdate||this.layerView.hasTilingEffects&&!this._globalSymbolizerParams;if(this._globalUpdateRequested&&!this.layerView.moving&&0===this._fetchQueue.length){a=!1;try{var i;await this._redrawImage(null===(i=this._abortController)||void 0===i?void 0:i.signal)}catch(s){(0,n.zf)(s)&&r.A.getLogger(this).error(s)}this._globalUpdateRequested=!1}this.canUseLocalSymbolizerParams&&null==this._symbolizerParams&&this._updateSymbolizerParams();const l=this._tileInfoView.getTileCoords(Tt,e.key),u=this._tileInfoView.getTileResolution(e.key);await this.updateTileSource(e,{source:t,symbolizerParams:this._symbolizerParams,globalSymbolizerParams:this._globalSymbolizerParams,suspended:a,bandIds:o,coords:l,resolution:u}),e.once("attach",()=>this.layerView.requestUpdate()),this.container.addChild(e)}catch(s){(0,n.zf)(s)||r.A.getLogger(this).error(s)}this.layerView.requestUpdate()}}async _redrawImage(e){if(0===this.container.children.length)return;await this.layer.updateRenderer(),this.layerView.hasTilingEffects?await this._updateGlobalSymbolizerParams(e):(this.canUseLocalSymbolizerParams&&this._updateSymbolizerParams(),this._globalSymbolizerParams=null);const t=this.container.children.map(async e=>this.updateTileSymbolizerParameters(e,{local:this._symbolizerParams,global:this._globalSymbolizerParams}));await Promise.allSettled(t),this.container.requestRender()}async _updateGlobalSymbolizerParams(e){const t=this._getFetchOptions(this.previousLOD.level,e),i=await this.layer.fetchPixels(this.layerView.view.extent,this.layerView.view.width,this.layerView.view.height,(0,z.A)((0,z.A)({},t),{},{interpolation:"nearest",requestRawData:!1,skipRasterFunction:!1}));if(null===i||void 0===i||!i.pixelBlock)return;const{resolution:s}=this.previousLOD,r=this._getBandIds(),n=this.layer.symbolizer.generateWebGLParameters({pixelBlock:i.pixelBlock.extractBands(r),isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:s,y:s},bandIds:r});!this.canUseWebGLForProcessing&&n&&"stretch"===n.type&&this.layer.renderer&&"raster-stretch"===this.layer.renderer.type&&(n.factor=n.factor.map(e=>255*e),n.minOutput=Math.round(255*n.minOutput),n.maxOutput=Math.round(255*n.maxOutput)),this._globalSymbolizerParams=n}_updateSymbolizerParams(){const{resolution:e}=this.previousLOD,t=this._getBandIds();this._symbolizerParams=this.layer.symbolizer.generateWebGLParameters({pixelBlock:null,isGCS:this.layerView.view.spatialReference.isGeographic,resolution:{x:e,y:e},bandIds:t})}_updateBlockCacheRegistry(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{layer:i,layerView:s}=this,{raster:r}=i,{multidimensionalDefinition:n}=i.normalizeRasterFetchOptions({multidimensionalDefinition:i.multidimensionalDefinition,timeExtent:s.timeExtent}),o=r.rasterInfo.multidimensionalInfo?r.getSliceIndex(n):null,a=r.rasterInfo.storageInfo.isBsqTile&&null!==(e=i.bandIds)&&void 0!==e&&e.length?i.bandIds:null,l=(0,gt.ph)(r.rasterId,o,a);if(l!==this._blockCacheRegistryUrl){if(null!=this._blockCacheRegistryUrl&&(0,gt.ht)(this._blockCacheRegistryUrl,this._blockCacheRegistryId),this._blockCacheRegistryId=(0,gt.kz)(l,r.rasterInfo),t){const{view:e}=s,t=this._tileInfoView.getClosestInfoForScale(e.scale),i=this._srcResolutions[t.level];(0,gt.yo)(l,this._blockCacheRegistryId,e.extent,e.resolution,i,r.ioConfig.sampling)}this._blockCacheRegistryUrl=l}}async doRefresh(){if(!this.attached||!this.previousLOD||this.layerView.suspended)return;await this.layer.updateRenderer(),this.canUseLocalSymbolizerParams&&this._updateSymbolizerParams(),this._updateBlockCacheRegistry(!0),this._fetchQueue.reset();const e=[];this._globalUpdateRequested=this.layerView.hasTilingEffects||!this.useProgressiveUpdate,this._tileStrategy.refresh(t=>e.push(this._enqueueTileFetch(t))),await this._updatingHandles.addPromise(Promise.allSettled(e))}};(0,s._)([(0,a.MZ)()],Pt.prototype,"_globalUpdateRequested",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"attached",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"canUseWebGLForProcessing",null),(0,s._)([(0,a.MZ)()],Pt.prototype,"canUseLocalSymbolizerParams",null),(0,s._)([(0,a.MZ)()],Pt.prototype,"container",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"layerView",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"scheduler",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"type",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"useWebGLForProcessing",null),(0,s._)([(0,a.MZ)()],Pt.prototype,"useProgressiveUpdate",null),(0,s._)([(0,a.MZ)()],Pt.prototype,"timeExtent",void 0),(0,s._)([(0,a.MZ)()],Pt.prototype,"updating",null),Pt=(0,s._)([(0,u.$)("esri.views.2d.layers.imagery.BaseImageryTileSubView2D")],Pt);var Rt=i(13692);let St=class extends Pt{constructor(){super(...arguments),this.type="raster"}get canUseWebGLForProcessing(){var e;const{loaded:t,symbolizer:i}=this.layer;if(!t||!i)return!1;const s=null===(e=i.lookup.colormapLut)||void 0===e?void 0:e.indexedColormap,r=s&&s.length>this._maxIndexedColormapSize,n=(0,m.xN)(this.layer.serviceRasterInfo);return!((0,l.A)("ios")&&n>4)&&this.useWebGLForProcessing&&i.canRenderInWebGL&&!r&&!("majority"===this.layer.interpolation&&(0,Rt.H_)(this.layer))}attach(){super.attach(),this.container=new ct(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this.updateRasterFunctionParameters()}detach(){super.detach(),this.container.removeAllChildren(),this.container=null}fetchTile(e,t){return this.layer.fetchTile(e.level,e.row,e.col,t)}updateRasterFunctionParameters(){var e;const{raster:t,type:i}=this.layer,{container:s}=this;if("Function"!==t.datasetFormat||"wcs"===i)return s.rasterFunctionChain=null,s.children.forEach(e=>{const{bitmap:t}=e;t&&(t.suspended=!0,t.processed=!1,t.projected&&(t.invalidateTexture(),t.rasterTexture=null))}),void(this._rasterFunctionState="na");const r=this._rasterFunctionState,{rasterFunction:n,primaryRasters:o}=t,a=n.supportsGPU&&(!o||o.rasters.length<=1),l=a?n.flatWebGLFunctionChain:null,{renderer:u}=this.layer,c=!a||!(null!==l&&void 0!==l&&l.functions.length)||"raster-stretch"===(null===u||void 0===u?void 0:u.type)&&u.dynamicRangeAdjustment||!this.canUseWebGLForProcessing;s.rasterFunctionChain=c?null:this._addProjection(l);const d=null==n?"na":s.rasterFunctionChain?"gpu":"cpu",h=r===d||"na"===r&&"cpu"===d&&0===(null===l||void 0===l||null===(e=l.functions)||void 0===e?void 0:e.length);s.children.forEach(e=>{const{bitmap:t}=e;t&&(t.suspended=!h,t.processed=!1,t.processedTexture=null)}),this._rasterFunctionState=d}async updateTileSource(e,t){const i=this._getBandIds(),s=this._getLayerInterpolation(),{canUseWebGLForProcessing:r}=this,{source:n,globalSymbolizerParams:o,suspended:a,coords:l,resolution:u}=t,c=this.layerView.hasTilingEffects?o:t.symbolizerParams,{bitmap:d}=e;if([d.x,d.y]=l,d.resolution=u,null!=(null===n||void 0===n?void 0:n.pixelBlock)){const e={extent:n.extent,pixelBlock:n.pixelBlock,srcPixelSize:n.srcTilePixelSize};if(d.rawPixelData=e,r)d.source=n.pixelBlock,d.isRendereredSource=!1;else{const t=await this.layer.applyRenderer(e,"stretch"===(null===o||void 0===o?void 0:o.type)?o:void 0);d.source=t,d.isRendereredSource=!0}d.symbolizerParameters=r?c:null,d.transformGrid=r?n.transformGrid:null}else{const e=this.createEmptyTilePixelBlock();d.source=e,d.symbolizerParameters=r?c:null,d.transformGrid=null}d.bandIds=r?i:null,d.width=this._tileInfoView.tileInfo.size[0],d.height=this._tileInfoView.tileInfo.size[1],d.interpolation=s,d.suspended=a;const{raster:h}=this.layer;if((0,p.q)(h)){const t=h.getClippingGeometry(this.layerView.view.spatialReference);if(t){const i=h.getTileExtentFromTileInfo(e.key.level,e.key.row,e.key.col,this._tileInfoView.tileInfo);d.mask=(0,f.b5)({srcExtent:i,geometry:t,size:[d.width,d.height]})}}d.invalidateTexture()}async updateTileSymbolizerParameters(e,t){const{local:i,global:s}=t,r=this._getBandIds(),n=this._getLayerInterpolation(),{canUseWebGLForProcessing:o}=this,{bitmap:a}=e,{rawPixelData:l}=a;o||null==l?(a.isRendereredSource&&null!=l&&(a.source=l.pixelBlock),a.isRendereredSource=!1):(a.source=await this.layer.applyRenderer(l,"stretch"===(null===s||void 0===s?void 0:s.type)?s:void 0),a.isRendereredSource=!0),a.symbolizerParameters=o?this.layerView.hasTilingEffects?s:i:null,a.bandIds=o?r:null,a.interpolation=n,a.suspended=!1}_getLayerInterpolation(){const{interpolation:e,renderer:t}=this.layer;if(!t)return e;const i=t.type;return"raster-colormap"===i||"unique-value"===i?"nearest":"raster-stretch"===t.type&&null!=t.colorRamp?"bilinear"===e||"cubic"===e?"bilinear":"nearest":e}_addProjection(e){var t;return null!==e&&void 0!==e&&null!==(t=e.functions)&&void 0!==t&&t.length&&!e.hasFocalFunction&&e.functions.unshift({name:"Reproject",parameters:{targetImageSize:this._tileInfoView.tileInfo.size,requireNNEdge:e.isSourceSingleBand},pixelType:"f32",id:0,isNoopProcess:!1}),e}};(0,s._)([(0,a.MZ)()],St.prototype,"canUseWebGLForProcessing",null),(0,s._)([(0,a.MZ)()],St.prototype,"container",void 0),(0,s._)([(0,a.MZ)()],St.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],St.prototype,"type",void 0),St=(0,s._)([(0,u.$)("esri.views.2d.layers.imagery.ImageryTileView2D")],St);var Mt=i(99846),kt=i(17331),It=i(86386);class zt extends S.Y{constructor(e,t,i,s,r,n){let o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;super(e,t,i,s,r,n),this.tileData=new It.X(o),this.tileData.coordScale=[r,n],this.tileData.once("isReady",()=>this.ready())}destroy(){super.destroy(),this.tileData.destroy(),this.tileData=null,this.stage=null}set stencilRef(e){this.tileData.stencilRef=e}get stencilRef(){return this.tileData.stencilRef}_createTransforms(){return{displayViewScreenMat3:(0,_.vt)(),tileMat3:(0,_.vt)()}}setTransform(e){super.setTransform(e);const t=this.resolution/(e.resolution*e.pixelRatio),i=this.transforms.tileMat3,[s,r]=this.tileData.offset,n=[this.x+s*this.resolution,this.y-r*this.resolution],[o,a]=e.toScreenNoRotation([0,0],n),{symbolTileSize:l}=this.tileData.symbolizerParameters,u=Math.round((this.width-this.tileData.offset[0])/l)*l,c=Math.round((this.height-this.tileData.offset[1])/l)*l,d=u/this.rangeX*t,h=c/this.rangeY*t;(0,w.hZ)(i,d,0,0,0,h,0,o,a,1),(0,w.lw)(this.transforms.displayViewScreenMat3,e.displayViewMat3,i),this.tileData.transforms.displayViewScreenMat3=this.transforms.displayViewScreenMat3}onAttach(){this.tileData.stage=this.stage}onDetach(){this.tileData.stage=null}}class At extends I.A{constructor(){super(...arguments),this.isCustomTilingScheme=!1,this.symbolTypes=["triangle"]}createTile(e){const t=this.tileInfoView.getTileBounds((0,y.vt)(),e),[i,s]=this.tileInfoView.tileInfo.size,r=this.tileInfoView.getTileResolution(e.level);return new zt(e,r,t[0],t[3],i,s)}prepareRenderPasses(e){const t=e.registerRenderPass({name:"imagery (vf tile)",brushes:[kt.A],target:()=>this.children.map(e=>e.tileData),drawPhase:k.S5.MAP});return[...super.prepareRenderPasses(e),t]}doRender(e){this.visible&&e.drawPhase===k.S5.MAP&&this.symbolTypes.forEach(t=>{e.renderPass=t,super.doRender(e)})}}let Bt=class extends Pt{constructor(){super(...arguments),this._handle=null,this.type="rasterVF"}async fetchTile(e,t){var i;t=(0,z.A)((0,z.A)({},t),{},{interpolation:"nearest",requestProjectedLocalDirections:!0});const s=await this.layer.fetchTile(e.level,e.row,e.col,t);return"vector-magdir"===(null===(i=this.layer.serviceRasterInfo)||void 0===i?void 0:i.dataType)&&null!==s&&void 0!==s&&s.pixelBlock&&(s.pixelBlock=await this.layer.convertVectorFieldData(s.pixelBlock,"vector-magdir",t)),s}updateTileSource(e,t){const i=t.symbolizerParams,{tileData:s}=e;s.key=e.key,s.width=this._tileInfoView.tileInfo.size[0],s.height=this._tileInfoView.tileInfo.size[1];const{symbolTileSize:r}=i,{source:n}=t;if(s.offset=this._getTileSymbolOffset(s.key,r),null!=(null===n||void 0===n?void 0:n.pixelBlock)){const e={extent:n.extent,pixelBlock:n.pixelBlock};s.rawPixelData=e,s.symbolizerParameters=i,s.source=this._sampleVectorFieldData(n.pixelBlock,i,s.offset)}else{const e=[Math.round((this._tileInfoView.tileInfo.size[0]-s.offset[0])/r),Math.round((this._tileInfoView.tileInfo.size[1]-s.offset[1])/r)],t=this.createEmptyTilePixelBlock(e);s.source=t,s.symbolizerParameters=i}return s.invalidateVAO(),Promise.resolve()}updateTileSymbolizerParameters(e,t){var i;const s=t.local,{symbolTileSize:r}=s,{tileData:n}=e;n.offset=this._getTileSymbolOffset(n.key,r);const o=n.symbolizerParameters.symbolTileSize;n.symbolizerParameters=s;const a=null===(i=n.rawPixelData)||void 0===i?void 0:i.pixelBlock;return null!=a&&o!==r&&(n.source=this._sampleVectorFieldData(a,n.symbolizerParameters,n.offset)),Promise.resolve()}attach(){super.attach(),this.container=new At(this._tileInfoView),this.container.isCustomTilingScheme=this._isCustomTilingScheme,this._updateSymbolType(this.layer.renderer),this._handle=(0,o.wB)(()=>this.layer.renderer,e=>this._updateSymbolType(e))}detach(){var e;super.detach(),this.container.removeAllChildren(),null!==(e=this._handle)&&void 0!==e&&e.remove(),this._handle=null,this.container=null}_getTileSymbolOffset(e,t){const i=e.col*this._tileInfoView.tileInfo.size[0]%t,s=e.row*this._tileInfoView.tileInfo.size[1]%t;return[i>t/2?t-i:-i,s>t/2?t-s:-s]}_sampleVectorFieldData(e,t,i){const{symbolTileSize:s}=t;return(0,Mt.Wu)(e,"vector-uv",s,i)}_updateSymbolType(e){"vector-field"===(null===e||void 0===e?void 0:e.type)&&(this.container.symbolTypes="wind-barb"===e.style?["scalar","triangle"]:"simple-scalar"===e.style?["scalar"]:["triangle"])}};(0,s._)([(0,a.MZ)()],Bt.prototype,"container",void 0),(0,s._)([(0,a.MZ)()],Bt.prototype,"layer",void 0),(0,s._)([(0,a.MZ)()],Bt.prototype,"type",void 0),Bt=(0,s._)([(0,u.$)("esri.views.2d.layers.imagery.VectorFieldTileView2D")],Bt);var Ft=i(28866),Vt=i(91196),Zt=i(771);let Et=class extends((0,Ft.A)((0,Zt.A)((0,h.e)(Vt.A)))){constructor(){super(...arguments),this._useWebGLForProcessing=!0,this._useProgressiveUpdate=!0,this.subview=null}get useWebGLForProcessing(){return this._useWebGLForProcessing}set useWebGLForProcessing(e){this._useWebGLForProcessing=e,this.subview&&"useWebGLForProcessing"in this.subview&&(this.subview.useWebGLForProcessing=e)}get useProgressiveUpdate(){return this._useWebGLForProcessing}set useProgressiveUpdate(e){this._useProgressiveUpdate=e,this.subview&&"useProgressiveUpdate"in this.subview&&(this.subview.useProgressiveUpdate=e)}get displayParameters(){const{layer:e}=this,t=this._get("displayParameters");return e.renderer&&e.visible?{bandIds:e.bandIds,renderer:e.renderer,interpolation:e.interpolation,multidimensionalDefinition:e.multidimensionalDefinition,rasterFunction:"imagery-tile"===e.type?e.rasterFunction:null}:t}update(e){var t;null!==(t=this.subview)&&void 0!==t&&t.update(e),this.notifyChange("updating")}isUpdating(){return!this.subview||this.subview.updating}attach(){this.layer.increaseRasterJobHandlerUsage(),this._updateSubview(),this.addAttachHandles([(0,o.wB)(()=>this.displayParameters,(e,t)=>{var i,s,o;const a=e.interpolation!==(null===t||void 0===t?void 0:t.interpolation)&&("majority"===e.interpolation||"majority"===(null===t||void 0===t?void 0:t.interpolation))&&(0,Rt.H_)(this.layer),l=!(null===(i=this.layer.serviceRasterInfo)||void 0===i||null===(i=i.storageInfo)||void 0===i||!i.isBsqTile)&&(null===(s=e.bandIds)||void 0===s?void 0:s.join())!==(null===t||void 0===t||null===(o=t.bandIds)||void 0===o?void 0:o.join()),u=e.renderer!==(null===t||void 0===t?void 0:t.renderer)&&this._getSubviewType(null===t||void 0===t?void 0:t.renderer)!==this._getSubviewType(e.renderer);u&&this._updateSubview();const c=e.multidimensionalDefinition!==(null===t||void 0===t?void 0:t.multidimensionalDefinition),d=e.rasterFunction!==(null===t||void 0===t?void 0:t.rasterFunction),h=d&&!this._useWebGLForProcessing,p=c||a||u||h||l;this.subview.redrawOrRefetch({refetch:p,reprocess:d}).catch(e=>{(0,n.zf)(e)||r.A.getLogger(this).error(e)}),this.notifyChange("updating")}),(0,o.wB)(()=>{var e;return null!==(e=this.layer.multidimensionalSubset)&&void 0!==e?e:null},(e,t)=>{const{multidimensionalDefinition:i}=this.layer;null!=i&&(0,c.sx)(i,e)!==(0,c.sx)(i,t)&&(this.subview.redrawOrRefetch({refetch:!0}).catch(e=>{(0,n.zf)(e)||r.A.getLogger(this).error(e)}),this.notifyChange("updating"))},o.OH),(0,o.wB)(()=>this.timeExtent,()=>{this.subview.timeExtent=this.timeExtent,this.subview.redrawOrRefetch({refetch:!0}).catch(e=>{(0,n.zf)(e)||r.A.getLogger(this).error(e)})},o.Vh)])}detach(){var e;this.layer.decreaseRasterJobHandlerUsage(),this._detachSubview(this.subview),null!==(e=this.subview)&&void 0!==e&&e.destroy(),this.subview=null}viewChange(){this.requestUpdate()}moveEnd(){this.subview.moveEnd()}doRefresh(){return this.subview?this.subview.doRefresh():Promise.resolve()}_updateSubview(){const{renderer:e}=this.layer;if(!e)return;const t=this._getSubviewType(e);if(this.subview){var i;if(this.subview.type===t)return void this._attachSubview(this.subview);this._detachSubview(this.subview),null!==(i=this.subview)&&void 0!==i&&i.destroy(),this.subview=null}const{layer:s}=this;let r;if(r="rasterVF"===t?new Bt({layer:s,layerView:this,scheduler:this.scheduler}):"flow"===t?new d.A({layer:s,layerView:this,scheduler:this.scheduler}):new St({layer:s,layerView:this,scheduler:this.scheduler}),"useWebGLForProcessing"in r&&(r.useWebGLForProcessing=this._useWebGLForProcessing),"useProgressiveUpdate"in r&&(r.useProgressiveUpdate=this._useProgressiveUpdate),"previousLOD"in r){const{subview:e}=this;r.previousLOD=e&&"previousLOD"in e?e.previousLOD:null}this._attachSubview(r),this.subview=r,this.requestUpdate()}_attachSubview(e){e&&!e.attached&&(e.attach(),e.attached=!0,this.container.addChildAt(e.container,0))}_detachSubview(e){(null===e||void 0===e?void 0:e.attached)&&(this.container.removeChild(e.container),e.detach(),e.attached=!1)}_getSubviewType(e){const t=null===e||void 0===e?void 0:e.type;return"vector-field"===t?"rasterVF":"flow"===t?"flow":"raster"}};(0,s._)([(0,a.MZ)()],Et.prototype,"subview",void 0),(0,s._)([(0,a.MZ)()],Et.prototype,"useWebGLForProcessing",null),(0,s._)([(0,a.MZ)()],Et.prototype,"useProgressiveUpdate",null),(0,s._)([(0,a.MZ)({readOnly:!0})],Et.prototype,"displayParameters",null),Et=(0,s._)([(0,u.$)("esri.views.2d.layers.ImageryTileLayerView2D")],Et);const Ot=Et},46550:(e,t,i)=>{i.d(t,{A:()=>u});var s=i(81806),r=i(61551),n=i(36201),o=i(90548),a=i(44595);const l=(e,t)=>e.key.level-t.key.level!==0?e.key.level-t.key.level:e.key.row-t.key.row!==0?e.key.row-t.key.row:e.key.col-t.key.col;class u extends n.A{constructor(e){super(),this.tileInfoView=e,this.sortFunction=l}renderChildren(e){this.setStencilReference(e),super.renderChildren(e)}createRenderParams(e){const{state:t}=e,i=super.createRenderParams(e);return i.requiredLevel=this.tileInfoView.getClosestInfoForScale(t.scale).level,i.displayLevel=this.tileInfoView.tileInfo.scaleToZoom(t.scale),i}prepareRenderPasses(e){const t=super.prepareRenderPasses(e);return t.push(e.registerRenderPass({name:"stencil",brushes:[o.A],drawPhase:r.S5.DEBUG|r.S5.MAP|r.S5.HIGHLIGHT|r.S5.LABEL,target:()=>this.getStencilTarget()})),(0,s.A)("esri-tiles-debug")&&t.push(e.registerRenderPass({name:"tileInfo",brushes:[a.A],drawPhase:r.S5.DEBUG,target:()=>this.children})),t}getStencilTarget(){return this.children}setStencilReference(e){let t=1;for(const i of this.children)i.stencilRef=t++}}},60853:(e,t,i)=>{i.d(t,{K5:()=>d,Kt:()=>m,M8:()=>a,Rj:()=>f,_9:()=>o,i6:()=>h,mh:()=>c,nb:()=>u,p8:()=>_,tL:()=>l,xf:()=>y,yS:()=>p,zb:()=>g,zy:()=>x});var s=i(5095),r=i(60984),n=i(90113);function o(e){const t=(0,r.fV)(12.9898),i=(0,r.fV)(78.233),s=(0,r.fV)(43758.5453),n=(0,r.Om)(e,(0,r.Zc)(t,i)),o=(0,r.zi)(n,(0,r.fV)(3.14));return(0,r.jc)((0,r.F8)(o).multiply(s))}function a(e){return(0,r.LC)(e,(0,r.fV)(n.qM))}function l(e,t){return e.x.multiply(t.y).subtract(t.x.multiply(e.y))}function u(e){return e.multiply(2).subtract(1)}function c(e,t){const i=(0,r.fV)(2**t);return(0,r.zi)((0,r.RI)(e.divide(i)),(0,r.fV)(2))}function d(e,t){return(0,r.MM)(c(e,t),(0,r.fV)(.5))}function h(e,t){return c(e,t+s.U5)}function p(e,t){return c(e,t)}function m(e){const t=c(e.z,7),i=(0,r.fV)(1).subtract(t),s=e.xyz.subtract((0,r.eR)(0,0,(0,r.fV)(128)));return i.multiply(e).add(t.multiply(s))}function f(e){const t=(0,r.ln)(255/256,255/65536,255/16777216,255/4294967296);return(0,r.Om)(e,t)}function y(e){return(0,r.T9)((0,r.T9)((0,r.T9)(e.x,e.y),e.z),e.w)}function g(e){return new r.nt(1).subtract(e)}function _(e){return e.subtract(new r.nt(1))}function x(e,t){return e.subtract(new r.nt(t))}},61229:(e,t,i)=>{i.d(t,{$Q:()=>a,Sd:()=>c,b5:()=>u,b7:()=>d});var s=i(31633),r=i(76797),n=i(19247),o=i(66486);async function a(e,t,s){if("extent"===s.type)return function(e,t,i){const{width:s,height:r}=e,n=new Uint8Array(s*r),a=t.width/s,l=t.height/r;if(i.width/a<.5||i.height/l<.5)return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,pixels:[...e.pixels]});const{xmin:u,xmax:c,ymin:d,ymax:h}=t,{xmin:p,xmax:m,ymin:f,ymax:y}=i,g=Math.max(u,p),_=Math.min(c,m),x=Math.max(d,f),w=Math.min(h,y),b=.5*a,v=.5*l;if(_-g<b||w-x<v||_<u+b||g>c-b||x>h-v||w<d+v)return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,pixels:[...e.pixels]});const C=Math.max(0,(g-u)/a),T=Math.min(s,Math.max(0,(_-u)/a)),P=Math.max(0,(h-w)/l),R=Math.min(r,Math.max(0,(h-x)/l)),S=Math.round(C),M=Math.round(T)-1,k=Math.round(P),I=Math.round(R)-1;if(S===M&&C%1>.5&&T%1<.5||k===I&&P%1>.5&&R%1<.5)return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,pixels:[...e.pixels]});if(0===S&&0===k&&M===s&&I===r)return e;const z=e.mask;for(let o=k;o<=I;o++)for(let e=S;e<=M;e++){const t=o*s+e;n[t]=z?z[t]:255}return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,pixels:[...e.pixels]})}(e,t,s);const{width:r,height:n}=e,a=new Uint8Array(r*n);return(await Promise.all([i.e(26871),i.e(16364),i.e(82103),i.e(48045),i.e(96483)]).then(i.bind(i,38165))).execute(t,s)?"polyline"===s.type?function(e,t,i){const{width:s,height:r}=e,n=new Uint8Array(s*r),a=t.width/s,l=t.height/r,{xmin:u,ymax:c}=t,{paths:d}=i,h=e.mask;for(let o=0;o<d.length;o++){const e=d[o];for(let t=0;t<e.length-1;t++){const[i,o]=e[t],[d,p]=e[t+1];let m=Math.floor((c-o)/l),f=Math.floor((c-p)/l);if(f<m){const e=m;m=f,f=e}m=Math.max(0,m),f=Math.min(r-1,f);const y=(d-i)/(p-o);for(let e=m;e<=f;e++){const t=e===m?Math.max(o,p):(r+1-e)*l,c=e===f?Math.min(o,p):t-l;let g=p===o?Math.floor((i-u)/a):Math.floor((y*(t-o)+i-u)/a),_=p===o?Math.floor((d-u)/a):Math.floor((y*(c-o)+i-u)/a);if(_<g){const e=g;g=_,_=e}const x=e*s;g=Math.max(0,g),_=Math.min(s-1,_);for(let e=x+g;e<=x+_;e++)n[e]=h?h[e]:255}}}return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,pixels:[...e.pixels]})}(e,t,s):(await Promise.all([i.e(26871),i.e(16364),i.e(82103),i.e(48045),i.e(3528)]).then(i.bind(i,32138))).execute(s,t)?e:l(e,t,s):new o.A({pixelType:e.pixelType,width:r,height:n,mask:a,maskIsAlpha:!1,pixels:[...e.pixels]})}function l(e,t,i){if(!e)return e;const{width:s,height:r}=e,n=u({geometry:i,size:[s,r],srcExtent:t,srcMask:e.mask});return new o.A({pixelType:e.pixelType,width:s,height:r,mask:n,maskIsAlpha:!1,pixels:[...e.pixels]})}function u(e){const{geometry:t,size:i,srcExtent:s,srcMask:r}=e,[n,o]=i;let a;const l=s.width/n,u=s.height/o,{xmin:c,ymax:d}=s;if("extent"===t.type){const e=(t.xmin-c)/l,i=(t.xmax-c)/l,s=(d-t.ymax)/u,r=(d-t.ymin)/u;a=[[[e,s],[e,r],[i,r],[i,s],[e,s]]]}else a=t.rings.map(e=>e.map(e=>{let[t,i]=e;return[(t-c)/l,(d-i)/u]}));return function(e,t,i){const[s,r]=t,n=new OffscreenCanvas(s,r).getContext("2d");n.fillStyle="#f00",n.beginPath(),e.forEach(e=>{n.moveTo(e[0][0],e[0][1]);for(let t=0;t<e.length;t++)n.lineTo(e[t][0],e[t][1]);n.closePath()}),n.fill();const o=n.getImageData(0,0,s,r).data,a=s*r,l=new Uint8Array(a);let u=!1;for(let c=0;c<a;c++)i&&!i[c]||(o[4*c+3]>127?l[c]=255:u=!0);return u||i?l:void 0}(a,i,r)}function c(e,t){const{extent:i}=d(e,t,new n.A({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:s}=e.extent;if(i.xmax=Math.min(i.xmax,s.xmax),i.ymax=Math.min(i.ymax,s.ymax),i.xmin<i.xmax&&i.ymin<i.ymax){const{x:t,y:s}=e.pixelSize,r=Math.round(i.width/t),n=Math.round(i.height/s);e.extent=i,e.width=r,e.height=n}}function d(e,t,i){let n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];const{spatialReference:o}=e,{x:a,y:l}=function(e,t){if(e.spatialReference.equals(t))return e;const i=(0,s.GA)(e.spatialReference),r=(0,s.GA)(t);if(i===r)return e;const n=i/r;return{x:e.x*n,y:e.y*n}}(i,o);let u,c,d;const h="extent"===t.type?t:t.extent;let{xmin:p,xmax:m,ymax:f,ymin:y}=h;const{xmin:g,ymax:_}=e.extent;return n?(p=g+(p>g?a*Math.round((p-g)/a):0),f=_-(f<_?l*Math.round((_-f)/l):0),m=g+(m>g?a*Math.round((m-g)/a):0),y=_-(y<_?l*Math.round((_-y)/l):0),u=new r.A({xmin:p,ymax:f,xmax:m,ymin:y,spatialReference:o}),c=Math.round(u.width/a),d=Math.round(u.height/l)):(c=Math.floor((m-p)/a+.8),d=Math.floor((f-y)/l+.8),p=g+(p>g?a*Math.floor((p-g)/a+.1):0),f=_-(f<_?l*Math.floor((_-f)/l+.1):0),m=p+c*a,y=f-d*l,u=new r.A({xmin:p,ymax:f,xmax:m,ymin:y,spatialReference:o})),{extent:u,width:c,height:d}}},71853:(e,t,i)=>{i.d(t,{OI:()=>m,Pp:()=>h,VC:()=>p,WL:()=>c,b4:()=>a,hE:()=>u,kc:()=>l,xV:()=>d});var s=i(72745),r=i(93345),n=i(29492),o=i(96673);function a(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest";const s=!(arguments.length>3&&void 0!==arguments[3]&&arguments[3]&&"u8"===t.pixelType),a=s?r.ld.FLOAT:r.ld.UNSIGNED_BYTE,l=null==t.pixels||0===t.pixels.length?null:s?t.getAsRGBAFloat():t.getAsRGBA(),u=e.capabilities.textureFloatLinear,c=new o.R;return c.width=t.width,c.height=t.height,c.internalFormat=s?r.H0.RGBA32F:r.Ab.RGBA,c.samplingMode=!u||"bilinear"!==i&&"cubic"!==i?r.Cj.NEAREST:r.Cj.LINEAR,c.dataType=a,c.wrapMode=r.pF.CLAMP_TO_EDGE,new n.g(e,c,l)}function l(e,t){const{spacing:i,offsets:s,coefficients:a,size:[l,u]}=t,c=i[0]>1,d=new o.R;d.width=c?4*l:l,d.height=u,d.internalFormat=r.H0.RGBA32F,d.dataType=r.ld.FLOAT,d.samplingMode=r.Cj.NEAREST,d.wrapMode=r.pF.CLAMP_TO_EDGE;const h=new Float32Array(c?l*u*16:2*s.length);if(c&&null!=a)for(let r=0,n=0;r<a.length;r++)h[n++]=a[r],r%3==2&&(h[n++]=1);else for(let r=0;r<u;r++)for(let e=0;e<l;e++){const t=4*(r*l+e),i=2*(e*u+r);h[t]=s[i],h[t+1]=s[i+1],h[t+3]=-1===s[i]?0:1}return new n.g(e,d,h)}function u(e,t){const i=new o.R;return i.internalFormat=r.Ab.RGBA,i.width=t.length/4,i.height=1,i.samplingMode=r.Cj.NEAREST,i.wrapMode=r.pF.CLAMP_TO_EDGE,new n.g(e,i,t)}function c(e,t,i){const s=new o.R;return s.internalFormat=r.Ab.ALPHA,s.pixelFormat=r.Ab.ALPHA,s.dataType=r.ld.UNSIGNED_BYTE,s.width=i[0],s.height=i[1],s.samplingMode=r.Cj.NEAREST,s.wrapMode=r.pF.CLAMP_TO_EDGE,new n.g(e,s,t)}function d(e,t,i){return{u_flipY:!(arguments.length>4&&void 0!==arguments[4])||arguments[4],u_applyTransform:!!e,u_opacity:arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u_transformSpacing:e?e.spacing:s.uY,u_transformGridSize:e?e.size:s.uY,u_targetImageSize:t,u_srcImageSize:i}}function h(e,t){return{u_colormapOffset:t||0,u_colormapMaxIndex:e?e.length/4-1:0}}function p(e){return{u_bandCount:e.bandCount,u_minOutput:e.minOutput,u_maxOutput:e.maxOutput,u_minCutOff:e.minCutOff,u_maxCutOff:e.maxCutOff,u_factor:e.factor,u_useGamma:e.useGamma,u_gamma:e.gamma,u_gammaCorrection:e.gammaCorrection}}function m(e){return{u_hillshadeType:e.hillshadeType,u_sinZcosAs:e.sinZcosAs,u_sinZsinAs:e.sinZsinAs,u_cosZs:e.cosZs,u_weights:e.weights,u_factor:e.factor,u_minValue:e.minValue,u_maxValue:e.maxValue}}},90113:(e,t,i)=>{var s;i.d(t,{$w:()=>c,Fb:()=>a,Fz:()=>y,H_:()=>s,J5:()=>l,M:()=>h,Ni:()=>d,V5:()=>o,Xx:()=>f,YV:()=>b,au:()=>u,b5:()=>_,bB:()=>P,bg:()=>x,cZ:()=>C,cn:()=>m,eo:()=>v,kx:()=>g,os:()=>r,qM:()=>p,rp:()=>n,ti:()=>w,v9:()=>T}),function(e){e[e.Geographic=0]="Geographic",e[e.Arithmatic=1]="Arithmatic"}(s||(s={}));const r=3.14159265359/180,n=3.14159265359/128,o=1,a=1.1,l=1,u=24,c=8,d=1e-5,h=.05,p=1e-30,m=4,f=0,y=2,g=2,_=3,x=0,w=3,b=16777216,v=1.1,C=16,T=128,P=1}}]);
//# sourceMappingURL=40239.4447c023.chunk.js.map