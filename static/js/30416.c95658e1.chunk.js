"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[30416],{29201:(e,t,r)=>{r.d(t,{I:()=>m,a:()=>T,b:()=>O});var i,s,n=r(57528),o=r(34981),a=r(26917),c=r(59395),p=r(90080),l=r(94192),u=r(80883),d=r(3799),h=r(21390),v=r(86955),f=r(70367),I=r(66470),_=r(91911),P=r(31432),g=r(2687);class T extends P.Y{}function O(e){const t=new g.N5,{vertex:r,fragment:P,varyings:T}=t,{output:O,perspectiveInterpolation:m}=e;return(0,d.NB)(r,e),t.include(c.d,e),t.include(l.Z,e),t.fragment.include(a.HQ,e),t.include(p.g,e),t.include(_.z,e),t.attributes.add(I.r.POSITION,"vec3"),t.attributes.add(I.r.UV0,"vec2"),m&&t.attributes.add(I.r.PERSPECTIVEDIVIDE,"float"),r.main.add((0,v.H)(i||(i=(0,n.A)(["\n    vpos = position;\n    forwardViewPosDepth((view * vec4(vpos, 1.0)).xyz);\n    vTexCoord = uv0;\n    gl_Position = transformPosition(proj, view, vpos);\n    ",""])),(0,v.If)(m,"gl_Position *= perspectiveDivide;"))),T.add("vpos","vec3",{invariant:!0}),T.add("vTexCoord","vec2"),P.include(u.a),P.uniforms.add(new h.m("opacity",e=>e.opacity),new f.N("tex",e=>e.glTexture)).main.add((0,v.H)(s||(s=(0,n.A)(["\n    discardBySlice(vpos);\n    discardByTerrainDepth();\n    ","\n    vec4 finalColor = texture(tex, vTexCoord) * opacity;\n    outputColorHighlightOID(finalColor, vpos, finalColor.rgb);"])),(0,v.If)(O===o.V.ObjectAndLayerIdColor,"fragColor = vec4(0, 0, 0, 1); return;"))),t}const m=Object.freeze(Object.defineProperty({__proto__:null,ImageMaterialPassParameters:T,build:O},Symbol.toStringTag,{value:"Module"}))},30416:(e,t,r)=>{r.d(t,{r:()=>S});var i=r(89379),s=r(88105),n=r(34981),o=r(83490),a=r(59696),c=r(34812),p=r(45463),l=r(60322),u=r(77730),d=r(86994),h=r(66470),v=r(82809),f=r(86401),I=r(63928),_=r(52757),P=r(16506),g=r(59246),T=r(72001),O=r(96643),m=r(29201),E=r(57162);class x extends g.w{constructor(e,t){super(e,t,new P.$(m.I,()=>r.e(48391).then(r.bind(r,48391))),A)}_getPipelineState(e,t){const{oitPass:r,output:i,hasOccludees:s,cullFace:o}=e,a=r===T.Y.NONE;return(0,E.Ey)({blending:(0,n.RN)(i)?a?E.RC:(0,l.ez)(r):null,culling:(0,E.Xt)(o),depthTest:{func:(0,l.K_)(r)},depthWrite:(0,l.z5)(e),drawBuffers:(0,l.m6)(r,i),colorWrite:E.kn,stencilWrite:s?O.v0:null,stencilTest:s?t?O.a9:O.qh:null,polygonOffset:(0,l.mE)(e)})}initializePipeline(e){return this._occludeePipeline=this._getPipelineState(e,!0),this._getPipelineState(e,!1)}getPipeline(e){return e?this._occludeePipeline:super.getPipeline()}}const A=new Map([[h.r.POSITION,0],[h.r.UV0,2],[h.r.PERSPECTIVEDIVIDE,3]]);var y=r(35143),C=r(97808),D=r(42717),w=r(6485),N=r(92656);class b extends N.E{constructor(e){super(),this.draped=e,this.cullFace=o.s2.None,this.enableOffset=!0,this.writeDepth=!0,this.hasOccludees=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.perspectiveInterpolation=!0,this.textureCoordinateType=C.I.None,this.emissionSource=D.ZX.None,this.discardInvisibleFragments=!0,this.occlusionPass=!1,this.objectAndLayerIdColorInstanced=!1,this.snowCover=!1}}(0,y._)([(0,w.W)({count:o.s2.COUNT})],b.prototype,"cullFace",void 0),(0,y._)([(0,w.W)()],b.prototype,"enableOffset",void 0),(0,y._)([(0,w.W)()],b.prototype,"writeDepth",void 0),(0,y._)([(0,w.W)()],b.prototype,"hasOccludees",void 0),(0,y._)([(0,w.W)()],b.prototype,"terrainDepthTest",void 0),(0,y._)([(0,w.W)()],b.prototype,"cullAboveTerrain",void 0),(0,y._)([(0,w.W)()],b.prototype,"perspectiveInterpolation",void 0);class S extends I.W{constructor(e){super(e,V),this.vertexAttributeLocations=A,this.supportsEdges=!0,this.produces=new Map([[u.N.OPAQUE_MATERIAL,e=>(0,n.CL)(e)],[u.N.TRANSPARENT_MATERIAL,e=>(0,n._o)(e)&&this.parameters.writeDepth],[u.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>(0,n._o)(e)&&!this.parameters.writeDepth],[u.N.DRAPED_MATERIAL,e=>(0,n._o)(e)||(0,n.CL)(e)]]),this._configuration=new b(e.draped)}dispose(){this.setParameters({texture:void 0})}getConfiguration(e,t){return super.getConfiguration(e,t,this._configuration),this._configuration.cullFace=this.parameters.cullFace,this._configuration.hasSlicePlane=this.parameters.hasSlicePlane,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.hasOccludees=t.hasOccludees,this._configuration.oitPass=t.oitPass,this._configuration.enableOffset=t.camera.relativeElevation<l.xt,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration.perspectiveInterpolation=this.parameters.perspectiveInterpolation,this._configuration}get visible(){return!0}createGLMaterial(e){return new R(e)}createBufferWriter(){let e=f.l5;return this.parameters.perspectiveInterpolation&&(e=e.clone().f32(h.r.PERSPECTIVEDIVIDE)),new L(e)}}class R extends a.A{constructor(e){super((0,i.A)((0,i.A)({},e),e.material.parameters)),this.parameters=e;const t=this._material.parameters.texture;(0,c.y)(t)&&e.textures.updater.add(t)}dispose(){this.parameters.textures.updater.remove(this._material.parameters.texture)}beginSlot(e){return this.getTechnique(x,e)}}class L extends v.Z{write(e,t,r,i,n,o){for(const a of this.vertexBufferLayout.fields.keys()){const i=r.get(a);if(i)if(a===h.r.PERSPECTIVEDIVIDE){(0,d.vA)(1===i.size);const e=n.getField(a,s.Y$);e&&(0,_.uO)(i,e,o)}else(0,_.zC)(a,i,e,t,n,o)}return null}}class V extends p.qA{constructor(e,t){super(),this.texture=e,this.draped=t,this.writeDepth=!0,this.hasSlicePlane=!1,this.cullFace=o.s2.None,this.opacity=1,this.perspectiveInterpolation=!1}get glTexture(){return this.texture.glTexture}}},63928:(e,t,r)=>{r.d(t,{W:()=>o});var i=r(9392),s=r(45463),n=r(48168);class o extends s.im{constructor(){super(...arguments),this._pp0=(0,i.fA)(0,0,1),this._pp1=(0,i.fA)(0,0,0)}intersect(e,t,r,i,s,o){return(0,n.Uy)(e,r,i,s,void 0,o)}intersectDraped(e,t,r,i){return this._pp0[0]=this._pp1[0]=r[0],this._pp0[1]=this._pp1[1]=r[1],(0,n.Uy)(e,t,this._pp0,this._pp1,void 0,i)}}},86401:(e,t,r)=>{r.d(t,{Ci:()=>n,KL:()=>c,dB:()=>a,l5:()=>o,wB:()=>p});var i=r(48549),s=r(66470);const n=(0,i.BP)().vec3f(s.r.POSITION),o=(0,i.BP)().vec3f(s.r.POSITION).vec2f16(s.r.UV0),a=(0,i.BP)().vec3f(s.r.POSITION).vec4u8(s.r.COLOR),c=((0,i.BP)().vec3f(s.r.POSITION).vec2f16(s.r.UV0).vec4u8(s.r.OLIDCOLOR),(0,i.BP)().vec3f(s.r.POSITION).vec2f(s.r.UV0)),p=(0,i.BP)().vec3f(s.r.POSITION).vec2f(s.r.UV0).vec4u8(s.r.OLIDCOLOR)}}]);
//# sourceMappingURL=30416.c95658e1.chunk.js.map