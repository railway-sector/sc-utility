{"version":3,"file":"static/js/13230.060cbdfe.chunk.js","mappings":"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","sources":["../node_modules/@arcgis/core/views/3d/layers/support/SublayerPopupHighlightHelper3D.js","../node_modules/@arcgis/core/views/3d/layers/support/ImageHighlightHelper3D.js","../node_modules/@arcgis/core/views/3d/layers/MapImageLayerView3D.js","../node_modules/@arcgis/core/layers/support/timeSupport.js","../node_modules/@arcgis/core/support/timeUtils.js","../node_modules/@arcgis/core/views/layers/MapImageLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import i from\"../../../../core/Accessor.js\";import{destroyHandle as r}from\"../../../../core/handleUtils.js\";import{ignoreAbortErrors as t}from\"../../../../core/promiseUtils.js\";import{when as s,watch as p,initial as o,syncAndInitial as h}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import\"../../../../core/RandomLCG.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{ImageHighlightHelper3D as c}from\"./ImageHighlightHelper3D.js\";import{MapServiceLayerViewHelper as g}from\"../../../layers/support/MapServiceLayerViewHelper.js\";import{createQueryGeometry as d}from\"../../../support/drapedUtils.js\";let m=class extends i{constructor(e){super(e)}initialize(){this._highlightHelper=new c({layer:this.layerView.layer,view:this.view,updatingHandles:this.updatingHandles}),this._mapServiceLayerViewHelper=new g({createFetchPopupFeaturesQueryGeometry:(e,i)=>d(e,i,this.view),layerView:this.layerView,updatingHandles:this.updatingHandles,highlightGraphics:this._highlightHelper.graphics,highlightGraphicUpdated:e=>this._highlightHelper.graphicsView?.graphicChanged(e)}),this.addHandles([r(this._mapServiceLayerViewHelper),s(()=>this._mapServiceLayerViewHelper.highlightFeaturesActive&&this.view?.stationary,()=>t(this._mapServiceLayerViewHelper.updateHighlightedFeatures(this.view.resolution)),o),p(()=>this.layerView.suspended,e=>this._highlightHelper.suspended=e,h)])}fetchPopupFeaturesAtLocation(e,i){return this._highlightHelper.preload(),this._mapServiceLayerViewHelper.fetchPopupFeaturesAtLocation(e,i)}highlight(e,i){return this._highlightHelper.highlight(e,i)}};e([a()],m.prototype,\"view\",void 0),e([a()],m.prototype,\"layerView\",void 0),e([a()],m.prototype,\"updatingHandles\",void 0),m=e([l(\"esri.views.3d.layers.support.SublayerPopupHighlightHelper3D\")],m);export{m as SublayerPopupHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as i}from\"tslib\";import e from\"../../../../Color.js\";import t from\"../../../../core/Accessor.js\";import{isSome as r}from\"../../../../core/arrayUtils.js\";import{makeHandle as s,destroyHandle as o}from\"../../../../core/handleUtils.js\";import{watch as h,syncAndInitial as p}from\"../../../../core/reactiveUtils.js\";import{property as a}from\"../../../../core/accessorSupport/decorators/property.js\";import\"../../../../core/has.js\";import\"../../../../core/Logger.js\";import{subclass as l}from\"../../../../core/accessorSupport/decorators/subclass.js\";import{initializeProjection as n,project as c}from\"../../../../geometry/projectionUtils.js\";import{GraphicsCollection as g}from\"../../../../support/GraphicsCollection.js\";import m from\"../../../../symbols/SimpleFillSymbol.js\";import d from\"../../../../symbols/SimpleLineSymbol.js\";import u from\"../../../../symbols/SimpleMarkerSymbol.js\";import{getHighlightGraphics as y}from\"../../../layers/support/highlightUtils.js\";let w=class extends t{get updating(){return this.graphicsView?.updating??!1}constructor(i){super(i),this._highlightCounts=new Map,this._graphicsViewLoader=null,this.graphics=new g,this.graphicsView=null,this.suspended=!1;const t=new e([255,255,255,1/255]);this._symbols=new Map([[\"point\",new u({size:\"2px\",style:\"square\",color:t})],[\"polyline\",new d({width:\"2px\",color:t})],[\"polygon\",new m({outline:null,color:t})]])}highlight(i,e){const t=y(i);if(0===t.length)return s();let r,o=!1;return this.updatingHandles.addPromise(Promise.all([this._createHighlightGraphics(t),this._ensureGraphicsView3D()]).then(([i,t])=>{!o&&t&&(r=this._addHighlightGraphics(t,i,e))})),s(()=>{o=!0,r?.remove()})}preload(){this._ensureGraphicsView3D()}_addHighlightGraphics(i,e,t){for(const s of e)this._highlightCounts.set(s,(this._highlightCounts.get(s)??0)+1);this.graphics.addMany(e);const r=i.highlight(e,t);return s(()=>{this._removeHighlightGraphics(e),r.remove()})}_removeHighlightGraphics(i){this.graphics.removeMany(i.filter(i=>{const e=Math.max(0,(this._highlightCounts.get(i)??0)-1);return 0===e?(this._highlightCounts.delete(i),!0):(this._highlightCounts.set(i,e),!1)}))}async _ensureGraphicsView3D(){if(this.graphicsView)return this.graphicsView;this._graphicsViewLoader||(this._graphicsViewLoader=import(\"../GraphicsView3D.js\"));const{default:i}=await this._graphicsViewLoader;if(this.destroyed)return null;const e=new i({view:this.view,layer:{type:\"graphics-view-3d-dummy\",id:this.layer.id,uid:this.layer.uid,elevationInfo:{mode:\"on-the-ground\"}},getGraphics:()=>this.graphics,drapeSourcePriorityOffset:.5});return this._set(\"graphicsView\",e),this.addHandles([o(this.graphicsView),h(()=>this.suspended,i=>{e.suspended=i},p)]),e}async _createHighlightGraphics(i){const e=i.map(({geometry:i})=>i?.spatialReference).filter(r).reduce((i,e)=>(0!==i.length&&i.at(-1)?.equals(e)||i.push(e),i),[]),t=this.view.spatialReference,s=e.map(i=>({source:i,dest:t}));try{await n(s)}catch{return[]}return i.map(i=>{const{geometry:e}=i;try{const r=e?c(e,t):null,s=i.cloneShallow();return s.geometry=r,s.symbol=this._symbols.get(r?.type),s}catch{return i}})}};i([a()],w.prototype,\"graphics\",void 0),i([a()],w.prototype,\"graphicsView\",void 0),i([a()],w.prototype,\"view\",void 0),i([a()],w.prototype,\"layer\",void 0),i([a()],w.prototype,\"updatingHandles\",void 0),i([a()],w.prototype,\"suspended\",void 0),i([a()],w.prototype,\"updating\",null),w=i([l(\"esri.views.3d.layers.support.ImageHighlightHelper3D\")],w);export{w as ImageHighlightHelper3D};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{destroyHandle as t}from\"../../../core/handleUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/has.js\";import\"../../../core/RandomLCG.js\";import\"../../../core/Error.js\";import{subclass as i}from\"../../../core/accessorSupport/decorators/subclass.js\";import r from\"./DynamicLayerView3D.js\";import{SublayerPopupHighlightHelper3D as s}from\"./support/SublayerPopupHighlightHelper3D.js\";import o from\"../../layers/MapImageLayerView.js\";let p=class extends(o(r)){constructor(){super(...arguments),this.type=\"map-image-3d\"}initialize(){this._updatingHandles.add(()=>this.exportImageVersion,()=>this._updatingHandles.addPromise(this.refreshDebounced())),this._popupHighlightHelper=new s({view:this.view,layerView:this,updatingHandles:this._updatingHandles}),this.addHandles(t(this._popupHighlightHelper))}fetchPopupFeaturesAtLocation(e,t){return this._popupHighlightHelper.fetchPopupFeaturesAtLocation(e,t)}highlight(e,t){return this._popupHighlightHelper.highlight(e,t)}getFetchOptions(){return{timeExtent:this.timeExtent,scale:this.view.scale}}};p=e([i(\"esri.views.3d.layers.MapImageLayerView3D\")],p);const a=p;export{a as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{toLocalTimeExtent as e,toUTCTimeExtent as t}from\"../../support/timeUtils.js\";function i(i,n,s){if(null==i?.timeInfo)return null;const{datesInUnknownTimezone:l=!1,timeOffset:o,useViewTime:m}=i;let u=i.timeExtent;l&&(u=e(u));let r=m?n&&u?n.intersection(u):n||u:u;return!r||r.isEmpty||r.isAllTime?r:(o&&(r=r.offset(-o.value,o.unit)),l&&(r=t(r)),r.equals(s)?s:r)}export{i as combineTimeExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{isSome as t}from\"../core/arrayUtils.js\";import{clone as e}from\"../core/lang.js\";import{offsetDate as n}from\"../core/timeUtils.js\";import i from\"../time/TimeExtent.js\";import{isWebMap as r}from\"../webmap/utils.js\";import{isWebScene as l}from\"../webscene/utils.js\";function s(t){return void 0!==t.timeInfo}async function u(t,e){return t.widgets?.timeSlider?.fullTimeExtent??a(t.allLayers,e)}function o(t){const e=t.numThumbs??2,n=t.currentTimeExtent;if(n){const{start:t,end:i}=n;return null!=t&&null!=i&&t.getTime()===i.getTime()?\"instant\":2===e?\"time-window\":null==t||0===t.getTime()?\"cumulative-from-start\":\"cumulative-from-end\"}return 2===e?\"time-window\":\"cumulative-from-start\"}function m(t){const{numStops:n,stopInterval:i,stops:r}=t;return r?{dates:e(r)}:i?{interval:i.clone()}:{count:n??5}}async function a(e,n){if(0===e.length)return i.allTime;await Promise.all(e.map(t=>t.load({signal:n})));const r=e.filter(s),l=e.filter(t=>!s(t)&&null!=t.visibilityTimeExtent);if(0===r.length&&0===l.length)return i.allTime;const u=[],o=[];for(const t of r)\"feature\"!==t?.type&&\"map-image\"!==t?.type||!t.timeInfo?.hasLiveData?o.push(t):u.push(t);const m=t=>null==t||t.isAllTime,a=[...o.map(t=>{const e=t.timeInfo?.fullTimeExtent,{visibilityTimeExtent:n}=t;return e?.intersection(n)??n}),...l.map(t=>t.visibilityTimeExtent)];if(a.some(m))return i.allTime;const f=u.map(async t=>{const e=(await t.fetchRecomputedExtents({signal:n}))?.timeExtent??t.timeInfo?.fullTimeExtent,{visibilityTimeExtent:i}=t;return e?.intersection(i)??i}),c=(await Promise.allSettled(f)).map(t=>\"fulfilled\"===t.status?t.value:null);if(c.some(m))return i.allTime;const d=[...c,...a].filter(t);if(0===d.length)return i.allTime;return d.reduce((t,e)=>t.union(e))}function f(t,e){const n=t.currentTimeExtent;if(!n)return null;const{start:r,end:l}=n,s=r??l??null;switch(e){case\"time-window\":return new i({start:r,end:l});case\"cumulative-from-start\":return new i({start:null,end:s});case\"cumulative-from-end\":return new i({start:s,end:null});case\"instant\":return new i({start:s,end:s})}}async function c(t,e){if(!r(t)&&!l(t))return null;await t.load({signal:e});const n=t?.widgets?.timeSlider;if(!n)return null;const i=await u(t,e),s=n.loop,a=o(n);return{fullTimeExtent:i,loop:s,mode:a,playRate:n.stopDelay??2e3,stops:m(n),timeExtent:f(n,a)}}function d(t){if(!t)return t;const{start:e,end:r}=t;return new i({start:null!=e?n(e,-e.getTimezoneOffset(),\"minutes\"):e,end:null!=r?n(r,-r.getTimezoneOffset(),\"minutes\"):r})}function p(t){if(!t)return t;const{start:e,end:r}=t;return new i({start:null!=e?n(e,e.getTimezoneOffset(),\"minutes\"):e,end:null!=r?n(r,r.getTimezoneOffset(),\"minutes\"):r})}export{a as getTimeExtentFromLayers,c as getTimeSliderSettingsFromWebDocument,p as toLocalTimeExtent,d as toUTCTimeExtent};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.34/esri/copyright.txt for details.\n*/\nimport{__decorate as e}from\"tslib\";import{property as t}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/has.js\";import\"../../core/Logger.js\";import\"../../core/RandomLCG.js\";import{subclass as r}from\"../../core/accessorSupport/decorators/subclass.js\";import{ExportImageParameters as o}from\"../../layers/support/ExportImageParameters.js\";import{combineTimeExtent as s}from\"../../layers/support/timeSupport.js\";const i=i=>{const p=i;let a=class extends p{initialize(){this.exportImageParameters=new o({layer:this.layer})}destroy(){this.exportImageParameters.destroy(),this.exportImageParameters=null}get floors(){return this.view?.floors??null}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),this.commitProperty(\"floors\"),(this._get(\"exportImageVersion\")||0)+1}get timeExtent(){return s(this.layer,this.view?.timeExtent,this._get(\"timeExtent\"))}canResume(){return!!super.canResume()&&!this.timeExtent?.isEmpty}};return e([t()],a.prototype,\"exportImageParameters\",void 0),e([t({readOnly:!0})],a.prototype,\"floors\",null),e([t({readOnly:!0})],a.prototype,\"exportImageVersion\",null),e([t()],a.prototype,\"layer\",void 0),e([t()],a.prototype,\"suspended\",void 0),e([t({readOnly:!0})],a.prototype,\"timeExtent\",null),a=e([r(\"esri.views.layers.MapImageLayerView\")],a),a};export{i as default};\n"],"names":["m","i","constructor","e","super","initialize","this","_highlightHelper","c","layer","layerView","view","updatingHandles","_mapServiceLayerViewHelper","g","createFetchPopupFeaturesQueryGeometry","d","highlightGraphics","graphics","highlightGraphicUpdated","_this$_highlightHelpe","graphicsView","graphicChanged","addHandles","r","s","_this$view","highlightFeaturesActive","stationary","t","updateHighlightedFeatures","resolution","o","p","suspended","h","fetchPopupFeaturesAtLocation","preload","highlight","a","prototype","l","w","updating","_this$graphicsView$up","_this$graphicsView","_highlightCounts","Map","_graphicsViewLoader","_symbols","u","size","style","color","width","outline","y","length","addPromise","Promise","all","_createHighlightGraphics","_ensureGraphicsView3D","then","_ref","_addHighlightGraphics","_r","remove","_this$_highlightCount","set","get","addMany","_removeHighlightGraphics","removeMany","filter","_this$_highlightCount2","Math","max","delete","default","destroyed","type","id","uid","elevationInfo","mode","getGraphics","drapeSourcePriorityOffset","_set","map","_ref2","geometry","spatialReference","reduce","_i$at","at","equals","push","source","dest","n","_unused","cloneShallow","symbol","_unused2","arguments","_updatingHandles","add","exportImageVersion","refreshDebounced","_popupHighlightHelper","getFetchOptions","timeExtent","scale","timeInfo","datesInUnknownTimezone","timeOffset","useViewTime","start","end","getTimezoneOffset","intersection","isEmpty","isAllTime","offset","value","unit","exportImageParameters","destroy","floors","_this$view$floors","_this$exportImagePara","commitProperty","_get","_this$view2","canResume","_this$timeExtent","readOnly"],"sourceRoot":""}