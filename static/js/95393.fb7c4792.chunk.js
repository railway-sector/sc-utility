"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[95393],{58272:(e,t,r)=>{r.d(t,{X:()=>i,b:()=>n});const i=50,n=5},86524:(e,t,r)=>{r.d(t,{Ge:()=>p,WT:()=>h});var i=r(31633),n=r(19247),o=r(23701),s=r(13312),l=r(7137),a=r(1438),u=r(80963),c=r(45417),d=r(58272);function p(e,t,r){const i=1===e?10:e;return i**(r?Math.round(function(e,t){return Math.log(e)/Math.log(t)}(d.X/t,i)):0)}function h(e,t,r){var d,p;const h="number"==typeof e?null:e,v=null!==r&&void 0!==r?r:null===h||void 0===h?void 0:h.spatialReference;if(null==v||!(0,u.fn)(v)||function(e){const{isGeographic:t,isWebMercator:r}=e;return!t&&!r}(v))return(0,i.GA)(v);let g=null!==(d=null===h||void 0===h?void 0:h.x)&&void 0!==d?d:e,f=null!==(p=null===h||void 0===h?void 0:h.y)&&void 0!==p?p:t;const M=1/Math.sqrt(2);let y=g+M,S=f+M;const{isWebMercator:w,isGeographic:R}=v;let P=R&&!(0,l.TT)(v)?s.A.WGS84:v;if(w){let e=new n.A({x:g,y:f,spatialReference:v});(0,c.ci)(e,!0,e),g=e.x,f=e.y,e=new n.A({x:y,y:S,spatialReference:v}),(0,c.ci)(e,!0,e),y=e.x,S=e.y,P=s.A.WGS84}const x=new o.A({paths:[[[g,f],[y,S]]],spatialReference:P}),_=(0,a.XX)(x,10);let b;try{[b]=(0,l.l1)([_],"meters")}catch(Z){return(0,i.GA)(v)}return b}},95393:(e,t,r)=>{r.d(t,{GridSnappingEngine:()=>w});var i=r(35143),n=r(91967),o=r(76460),s=r(15941),l=r(31633),a=r(46053),u=(r(81806),r(47249),r(85842)),c=r(20664),d=r(9956),p=r(1438),h=r(68002),v=r(58272),g=r(86524),f=r(23862),M=r(70330),y=r(90836),S=r(45633);let w=class extends n.A{constructor(e){super(e),this.options=null}destroy(){this._set("options",null)}get grid(){return this.view.grid}get effectiveViewRotation(){var e,t;return null!==(e=this.grid)&&void 0!==e&&e.rotateWithMap?0:(0,s.kU)(null!==(t=this.view.rotation)&&void 0!==t?t:0)}get gridRotation(){var e,t;return(0,s.kU)(null!==(e=null===(t=this.grid)||void 0===t?void 0:t.rotation)&&void 0!==e?e:0)}get gridCenter(){const{spatialReference:e,grid:t}=this;if(!t||!e||!(0,d.isLoadedOrLoadFor)(t.center.spatialReference,e))return null;try{var r;const i=(0,d.project)(t.center,e),n=e.isWrappable&&null!=(null===(r=this.view)||void 0===r?void 0:r.center)?(0,p.O7)(i.x,this.view.center.x,e):i.x;return(0,f.vt)(n,i.y,i.z)}catch(i){return o.A.getLogger(this).errorOnce("Grid Snapping - Failed to project grid center.",i),null}}get offsetScaleFactor(){const{pixelsPerStride:e,grid:t}=this;if(!t||!e)return 1;const{majorLineInterval:r,dynamicScaling:i}=t;return r<1?null:(0,g.Ge)(r,e,i)}get spatialReference(){return this.view.spatialReference}get gridMetersPerStride(){const{grid:e}=this;return e?(0,l.oU)(e.spacing,e.units,"meters"):null}get viewMetersPerPixel(){const{viewMetersPerSRUnit:e}=this;return null==e?null:e*(0,h.i1)(this.view.scale,this.view.spatialReference)}get viewMetersPerSRUnit(){const{spatialReference:e}=this.view;return this.gridCenter?(0,g.WT)(this.gridCenter[0],this.gridCenter[1],e):null}get pixelsPerStride(){const{gridMetersPerStride:e,viewMetersPerPixel:t}=this;return t&&e?e/t:null}get updating(){return null!=this.grid&&null!=this.spatialReference&&null==this.viewMetersPerSRUnit}async fetchCandidates(e,t,r){var i;const{options:n,view:o}=this;if(null===n||void 0===n||!n.effectiveGridEnabled||!o.grid||null!==(i=r.feature)&&void 0!==i&&i.attributes&&M.io in r.feature.attributes)return[];const s=r.coordinateHelper.arrayToPoint(e),l=n.distance*("touch"===r.pointer?n.touchSensitivityMultiplier:1);return this.fetchCandidatesSync(s,l)}fetchCandidatesSync(e,t){const r=[],{grid:i,effectiveViewRotation:n,gridRotation:o,gridCenter:s,viewMetersPerPixel:l,viewMetersPerSRUnit:a,offsetScaleFactor:u,spatialReference:c,gridMetersPerStride:p,pixelsPerStride:h}=this;if(!(i&&l&&a&&s&&c&&u&&p&&h))return r;if(!i.dynamicScaling&&h<v.b)return r;if(!(0,d.isLoadedOrLoadFor)(e.spatialReference,c))return r;const g=(0,d.project)(e,c),M=(0,f.vt)(g.x,g.y,g.z),w=R(M,-o,s,-n),b=p/a*u,Z=P(w,b,s),{shouldSnapX:G,shouldSnapY:C}=x(Z,w,t,l,a);if(!G&&!C)return[];const A=(0,f.vt)((G?Z:w)[0],(C?Z:w)[1]),U=R(A,o,s,n),W=R(Z,o,s,n);if(C){const e=_(Z,w,b,"y"),t=R(e,o,s,n);r.push(new S.o({lineStart:W,lineEnd:t,targetPoint:U,isDraped:!1}))}if(G){const e=_(Z,w,b,"x"),t=R(e,o,s,n);r.push(new S.o({lineStart:W,lineEnd:t,targetPoint:U,isDraped:!1}))}return G&&C&&r.push(new y.N(U,r[0],r[1],!1)),r}};(0,i._)([(0,a.MZ)({constructOnly:!0})],w.prototype,"view",void 0),(0,i._)([(0,a.MZ)()],w.prototype,"options",void 0),(0,i._)([(0,a.MZ)()],w.prototype,"grid",null),(0,i._)([(0,a.MZ)()],w.prototype,"effectiveViewRotation",null),(0,i._)([(0,a.MZ)()],w.prototype,"gridRotation",null),(0,i._)([(0,a.MZ)()],w.prototype,"gridCenter",null),(0,i._)([(0,a.MZ)()],w.prototype,"offsetScaleFactor",null),(0,i._)([(0,a.MZ)()],w.prototype,"spatialReference",null),(0,i._)([(0,a.MZ)()],w.prototype,"gridMetersPerStride",null),(0,i._)([(0,a.MZ)()],w.prototype,"viewMetersPerPixel",null),(0,i._)([(0,a.MZ)()],w.prototype,"viewMetersPerSRUnit",null),(0,i._)([(0,a.MZ)()],w.prototype,"pixelsPerStride",null),(0,i._)([(0,a.MZ)()],w.prototype,"updating",null),w=(0,i._)([(0,u.$)("esri.views.interactive.snapping.GridSnappingEngine")],w);const R=(e,t,r,i)=>{const n=(0,f.Hh)(e[0],e[1],e[2]);return(0,c.K)(n,(0,c.K)(n,n,r,t),r,i)},P=(e,t,r)=>{const i=(e[0]-r[0])/t,n=(e[1]-r[1])/t,o=Math.trunc(i),s=Math.trunc(n),l=Math.round(i%1),a=Math.round(n%1),u=r[0]+(o+l)*t,c=r[1]+(s+a)*t;return(0,f.vt)(u,c)},x=(e,t,r,i,n)=>{if(i<=0)return{shouldSnapX:!1,shouldSnapY:!1};const o=(e[0]-t[0])/i,s=(e[1]-t[1])/i;return{shouldSnapX:Math.abs(o*n)<r,shouldSnapY:Math.abs(s*n)<r}},_=(e,t,r,i)=>{if("y"===i){const i=t[0]>e[0]?1:-1;return(0,f.vt)(e[0]+r*i,e[1])}const n=t[1]>e[1]?1:-1;return(0,f.vt)(e[0],e[1]+r*n)}}}]);
//# sourceMappingURL=95393.fb7c4792.chunk.js.map