"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[97749],{77515:(e,t,i)=>{i.d(t,{CL:()=>u,Gc:()=>h,OK:()=>d,s7:()=>p,uc:()=>l,zS:()=>c});var n=i(20664),s=i(9392),a=i(65215),r=i(78315),o=i(94966);function l(e,t){const i=(0,r.a)(t);(0,n.i)(i,0,0,0);for(let a=0;a<e.length;++a)(0,n.f)(i,i,e[a]);(0,n.g)(i,i,1/e.length);let s=0;for(let a=0;a<e.length;++a)s=Math.max(s,(0,n.s)(i,e[a]));t[3]=Math.sqrt(s)}function d(e,t){if(e.length<3)throw new Error("need at least 3 points to fit a plane");(0,o.e9)(e[0],e[1],e[2],t)}function u(e,t){return(0,n.e)(e,t)+e[3]}function c(e,t,i,s,a){let{geodesicArea:r}=a;const o=g;return(0,n.c)(o.rings[0][0],e),(0,n.c)(o.rings[0][1],t),(0,n.c)(o.rings[0][2],i),(0,n.c)(o.rings[0][3],e),o.spatialReference=s,o.clearCache(),r(o)}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const s=(e,t)=>{if(0===t[0]&&0===t[1]&&0===t[2])return!1;for(let i=0;i<e.length;++i)if((0,n.e)(t,e[i])<-1e-6)return!1;return!0};if(0===e.length)return!1;if(1===e.length)return t&&(0,n.c)(t,e[0]),!0;(0,n.i)(_,0,0,0);for(let a=0;a<e.length;++a)(0,n.f)(_,_,e[a]);if((0,n.n)(_,_),s(e,_))return t&&(0,n.c)(t,_),!0;if(!i)return!1;for(let a=0;a<e.length;++a)for(let i=0;i<e.length;++i)if(a!==i&&((0,n.h)(_,e[a],e[i]),(0,n.n)(_,_),s(e,_)))return t&&(0,n.c)(t,_),!0;return!1}function p(e){return"mouse"!==e.pointerType||0===e.button}const g=new a.A({hasM:!1,hasZ:!0,rings:[[(0,s.vt)(),(0,s.vt)(),(0,s.vt)(),(0,s.vt)()]],spatialReference:null}),_=(0,s.vt)()},87562:(e,t,i)=>{var n;i.d(t,{G:()=>n}),function(e){e[e.Auto=0]="Auto",e[e.Euclidean=1]="Euclidean",e[e.Geodesic=2]="Geodesic"}(n||(n={}))},90806:(e,t,i)=>{i.d(t,{M:()=>_,b:()=>g});var n,s,a,r=i(57528),o=i(3799),l=i(58350),d=i(21390),u=i(86955),c=i(66470),h=i(2687),p=i(75569);function g(e){const t=new h.N5,{vertex:i,fragment:g}=t;(0,o.NB)(i,e),i.uniforms.add(new d.m("width",e=>e.width)),t.attributes.add(c.r.POSITION,"vec3"),t.attributes.add(c.r.NORMAL,"vec3"),t.attributes.add(c.r.UV0,"vec2"),t.attributes.add(c.r.LENGTH,"float"),t.varyings.add("vtc","vec2"),t.varyings.add("vlength","float"),t.varyings.add("vradius","float"),i.main.add((0,u.H)(n||(n=(0,r.A)(["vec3 bitangent = normal;\nvtc = uv0;\nvlength = length;\nvradius = 0.5 * width;\nvec4 pos = view * vec4(position + vradius * bitangent * uv0.y, 1.0);\ngl_Position = proj * pos;"])))),g.uniforms.add(new d.m("outlineSize",e=>e.outlineSize),new l.E("outlineColor",e=>e.outlineColor),new d.m("stripeLength",e=>e.stripeLength),new l.E("stripeEvenColor",e=>e.stripeEvenColor),new l.E("stripeOddColor",e=>e.stripeOddColor));const _=1/Math.sqrt(2);return g.code.add((0,u.H)(s||(s=(0,r.A)(["\n    const float INV_SQRT2 = ",";\n\n    vec4 arrowColor(vec2 tc, float len) {\n      float d = INV_SQRT2 * (tc.x - abs(tc.y));\n      d = min(d, INV_SQRT2 * (len - tc.x - abs(tc.y)));\n      d = min(d, 1.0 - abs(tc.y));\n\n      if (d < 0.0) {\n        return vec4(0.0);\n      }\n      if (d < outlineSize) {\n        return outlineColor;\n      }\n      return fract(0.5 / stripeLength * tc.x * vradius) >= 0.5 ? stripeOddColor : stripeEvenColor;\n    }"])),u.H.float(_))),g.main.add((0,u.H)(a||(a=(0,r.A)(["\n    vec2 ntc = vec2(vtc.x / vradius, vtc.y);\n    vec4 color = arrowColor(ntc, vlength / vradius);\n    if (color.a < ",") {\n      discard;\n    }\n    fragColor = color;"])),u.H.float(p.Q))),t}const _=Object.freeze(Object.defineProperty({__proto__:null,build:g},Symbol.toStringTag,{value:"Module"}))},97749:(e,t,i)=>{i.r(t),i.d(t,{default:()=>lt});var n=i(35143),s=i(91967),a=(i(81806),i(30726)),r=i(46053),o=i(76460),l=(i(47249),i(85842)),d=i(19747),u=i(2522),c=i(87562),h=i(24648),p=i(68134),g=i(31633),_=i(17430),v=i(29772);let m=class extends s.A{constructor(e){super(e)}initialize(){this.addHandles([(0,p.wB)(()=>({viewData:this.viewData,startPoint:this.analysis.startPoint}),e=>{let{viewData:t,startPoint:i}=e;t.elevationAlignedStartPoint=this._applyProjectionAndElevationAlignment(i)},p.pc),(0,p.wB)(()=>({viewData:this.viewData,endPoint:this.analysis.endPoint}),e=>{let{viewData:t,endPoint:i}=e;t.elevationAlignedEndPoint=this._applyProjectionAndElevationAlignment(i)},p.pc),(0,p.wB)(()=>({result:this._computedResult,viewData:this.viewData}),e=>{let{result:t,viewData:i}=e;i.result=t},p.pc)])}_applyProjectionAndElevationAlignment(e){if(null==e)return e;const{spatialReference:t,elevationProvider:i}=this.view,n=(0,_.B)(e,t,i);return null!==n&&void 0!==n?n:((0,_.V)(this.analysis,e.spatialReference,o.A.getLogger(this)),null)}get _computedResult(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,measurementMode:i,unit:n}=this.viewData;if(null==e||null==t)return null;const s=(0,v.NH)(e,t),a=this.geodesicLengthMeasurementUtils.geodesicDistanceBetweenPoints(e,t);if(null==s)return null;let r,o;switch(i){case c.G.Auto:o=null!=a?"geodesic":"euclidean",r=null!==a&&void 0!==a?a:s.horizontal;break;case c.G.Geodesic:if(null==a)return null;o="geodesic",r=a;break;case c.G.Euclidean:o="euclidean",r=s.horizontal}let l=s.direct,d=s.vertical;const u=(0,g.Vs)(l.value,l.unit,n),p=(0,g.Vs)(r.value,r.unit,n),_=(0,g.jE)(d.value,d.unit,n);return l=(0,h.kM)(l,u),r=(0,h.kM)(r,p),d=(0,h.kM)(d,_),{mode:o,directDistance:l,horizontalDistance:r,verticalDistance:d}}};(0,n._)([(0,r.MZ)({constructOnly:!0})],m.prototype,"view",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],m.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],m.prototype,"viewData",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],m.prototype,"geodesicLengthMeasurementUtils",void 0),(0,n._)([(0,r.MZ)()],m.prototype,"_computedResult",null),m=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementController")],m);var w,y,b,M=i(89379),P=(i(11265),i(59784)),f=i(15941),L=i(11113),A=i(76931),C=i(19555),S=i(20664),V=i(9392);(b=w||(w={}))[b.None=0]="None",b[b.Direct=1]="Direct",b[b.Triangle=2]="Triangle",b[b.ProjectedGeodesic=3]="ProjectedGeodesic",function(e){e[e.Auto=0]="Auto",e[e.AboveSegment=1]="AboveSegment",e[e.BelowSegment=2]="BelowSegment"}(y||(y={}));var O=i(4244),E=i(66747),D=i(7256),z=i(88321),Z=i(13191),T=i(43047),R=i(55855),x=i(75762),G=i(32314),H=i(81923),k=i(71372),B=i(62577),N=i(45463),j=i(48549),I=i(34981),Q=i(59696),W=i(77730),U=i(66470),q=i(16506),F=i(59246),$=i(60322),J=i(90806),X=i(93345),Y=i(57162);class K extends F.w{constructor(e,t){super(e,t,new q.$(J.M,()=>i.e(59492).then(i.bind(i,59492))),ee),this.primitiveType=X.WR.TRIANGLE_STRIP}initializePipeline(e){return(0,Y.Ey)({blending:e.transparent?(0,$.Yf)(e.oitPass):null,polygonOffset:e.polygonOffsetEnabled?{factor:0,units:-4}:null,depthTest:{func:X.MT.LESS},depthWrite:Y.Uy,colorWrite:Y.kn})}}const ee=new Map([[U.r.POSITION,0],[U.r.NORMAL,1],[U.r.UV0,2],[U.r.LENGTH,3]]);var te=i(6485),ie=i(92656);class ne extends ie.E{constructor(){super(...arguments),this.polygonOffsetEnabled=!1,this.transparent=!1}}(0,n._)([(0,te.W)()],ne.prototype,"polygonOffsetEnabled",void 0),(0,n._)([(0,te.W)()],ne.prototype,"transparent",void 0);var se=i(75569);class ae extends N.im{constructor(e){super(e,oe),this._configuration=new ne,this.vertexAttributeLocations=ee,this.intersectDraped=void 0,this.produces=new Map([[W.N.OPAQUE_MATERIAL,e=>!this._transparent&&(0,I.RN)(e)],[W.N.TRANSPARENT_MATERIAL_WITHOUT_DEPTH,e=>this._transparent&&(0,I.RN)(e)]])}getConfiguration(e,t){return super.getConfiguration(e,t,this._configuration),this._configuration.polygonOffsetEnabled=this.parameters.polygonOffset,this._configuration.transparent=this._transparent,this._configuration.oitPass=t.oitPass,this._configuration}get visible(){const{outlineColor:e,stripeEvenColor:t,stripeOddColor:i}=this.parameters;return e[3]>=se.Q||t[3]>=se.Q||i[3]>=se.Q}intersect(){}createGLMaterial(e){return new re(e)}createBufferWriter(){return new ge}get _transparent(){const{parameters:e}=this;return e.outlineColor[3]<1||e.stripeEvenColor[3]<1||e.stripeOddColor[3]<1}}class re extends Q.A{beginSlot(e){return this.getTechnique(K,e)}}class oe extends N.qA{constructor(){super(...arguments),this.width=32,this.outlineSize=.2,this.outlineColor=(0,R.fA)(1,.5,0,1),this.stripeEvenColor=(0,R.fA)(1,1,1,1),this.stripeOddColor=(0,R.fA)(1,.5,0,1),this.stripeLength=1,this.polygonOffset=!1}}const le=(0,j.BP)().vec3f(U.r.POSITION).vec3f(U.r.NORMAL).vec2f(U.r.UV0).f32(U.r.LENGTH),de=(0,V.vt)(),ue=(0,V.vt)(),ce=(0,V.vt)(),he=(0,V.vt)(),pe=(0,V.vt)();class ge{constructor(){this.vertexBufferLayout=le}elementCount(e){return 2*(e.get(U.r.POSITION).indices.length/2+1)}write(e,t,i,n,s,a){const{data:r,indices:o}=i.get(U.r.POSITION),l=i.get(U.r.NORMAL).data,d=r.length/3;o&&o.length!==2*(d-1)&&console.warn("MeasurementArrowMaterial does not support indices");const u=de,c=ue,h=ce,p=he,g=pe,_=s.position,v=s.normal,m=s.uv0;let w=0;for(let b=0;b<d;++b){const i=3*b;if((0,S.i)(u,r[i],r[i+1],r[i+2]),b<d-1){const e=3*(b+1);(0,S.i)(c,r[e],r[e+1],r[e+2]),(0,S.i)(g,l[e],l[e+1],l[e+2]),(0,S.n)(g,g),(0,S.d)(h,c,u),(0,S.n)(h,h),(0,S.h)(p,g,h),(0,S.n)(p,p)}const n=(0,S.j)(u,c);e&&t&&((0,S.t)(u,u,e),(0,S.t)(c,c,e),(0,S.t)(p,p,t));const s=a+2*b,o=s+1;_.setVec(s,u),_.setVec(o,u),v.setVec(s,p),v.setVec(o,p),m.set(s,0,w),m.set(s,1,-1),m.set(o,0,w),m.set(o,1,1),b<d-1&&(w+=n)}const y=s.length;for(let b=0;b<2*d;++b)y.set(a+b,w);return null}}class _e extends G.X{constructor(e){super(e),this._arrowWidth=16,this._arrowSubdivisions=128,this._origin=(0,V.vt)(),this._originTransform=(0,Z.vt)(),this._arrowCenter=(0,V.vt)(),this._renderOccluded=N.m$.OccludeAndTransparent,this._geometry=null,this._stripeLength=1,this._stripesEnabled=!0,this._color=(0,R.vt)(),this._contrastColor=(0,R.vt)(),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){var t;e!==this._renderOccluded&&(this._renderOccluded=e,null===(t=this._arrowMaterial)||void 0===t||t.setParameters({renderOccluded:e}))}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this._geometryChanged()}get stripeLength(){return this._stripeLength}set stripeLength(e){this._stripeLength=e,this.attached&&this._arrowMaterial.setParameters({stripeLength:this._stripeLength})}get stripesEnabled(){return this._stripesEnabled}set stripesEnabled(e){if(this._stripesEnabled=e,this.attached){const e=this._stripesEnabled?this._contrastColor:this._color;this._arrowMaterial.setParameters({stripeEvenColor:e})}}get color(){return this._color}set color(e){(0,P.we)(e,this._color)||((0,T.c)(this._color,e),this._updateArrowColor())}get contrastColor(){return this._contrastColor}set contrastColor(e){(0,P.we)(e,this._color)||((0,T.c)(this._contrastColor,e),this._updateArrowColor())}createExternalResources(){const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e;this._arrowMaterial=new ae({outlineColor:e,stripeEvenColor:i,stripeOddColor:e,renderOccluded:this.renderOccluded,polygonOffset:!0,isDecoration:this.isDecoration}),this._handles=new z.A,this._handles.add((0,p.wB)(()=>this.view.state.camera,()=>{this._viewChanged()}))}destroyExternalResources(){this._arrowMaterial=null,this._handles=(0,a.pR)(this._handles)}forEachMaterial(e){e(this._arrowMaterial)}createGeometries(e){var t;if(null==(null===(t=this._geometry)||void 0===t?void 0:t.startRenderSpace)||null==this._geometry.endRenderSpace)return;const i=this._createArrowGeometry(this._geometry.startRenderSpace,this._geometry.endRenderSpace,this._origin,this._geometry);i.transformation=this._originTransform,e.addGeometry(i),this._viewChanged()}_createArrowGeometry(e,t,i,n){const s=this.view,a=s.renderCoordsHelper,r=[],o=[],l=(e,t)=>{const n=x.rq.get();(0,S.d)(n,e,i),r.push(n),o.push(t)};if("euclidean"===n.type){n.eval(.5,this._arrowCenter);const i=x.rq.get();if(a.worldUpAtPosition(this._arrowCenter,i),function(e,t,i){const n=(0,S.a)(ve,t,e),s=(0,S.h)(ve,n,i);return 0===(0,S.H)(s)}(e,t,i)){const{heading:t,tilt:n}=s.camera,{direction:a}=(0,H.ZC)(s,e,t,n,me);(0,S.c)(i,a)}l(e,i),l(t,i)}else{n.eval(.5,this._arrowCenter);const e=this._arrowSubdivisions+1&-2;for(let t=0;t<e;++t){const i=t/(e-1),s=x.rq.get(),r=x.rq.get();n.eval(i,s),a.worldUpAtPosition(s,r),l(s,r)}}return(0,B.Z8)(this._arrowMaterial,r,o)}_geometryChanged(){this.recreateGeometry()}_viewChanged(){if(this.view.ready&&this.attached&&null!=this._geometry){const e=this.view.state.camera.computeScreenPixelSizeAt(this._arrowCenter);this._arrowMaterial.setParameters({width:this._arrowWidth*e})}}_updateArrowColor(){if(!this.attached)return;const e=this._color,t=this._contrastColor,i=this._stripesEnabled?t:e,n=e,s=e;this._arrowMaterial.setParameters({stripeEvenColor:i,outlineColor:n,stripeOddColor:s})}}const ve=(0,V.vt)(),me=(0,k.NP)();var we=i(47996),ye=i(25191),be=i(35925),Me=i(90659),Pe=i(38042),fe=i(63860);let Le=class extends s.A{get _parameters(){const e=this.view.effectiveTheme,{accentColor:t,textColor:i}=e,n=(0,P.QP)(t),s=(0,P.f6)(t,.75),a=(0,P.QP)((0,P.bJ)(t)),r=(0,P.bJ)(i,P.pW.Low);return{accentColor:n,contrastColor:a,translucentAccentColor:s,triangleLineWidth:3,geodesicProjectionLineWidth:2,guideLineWidth:2,guideStippleLengthPixels:3,directLabelFontSize:16,horizontalLabelFontSize:12,verticalLabelFontSize:12,textColor:i,textBackgroundColor:(0,P._L)(r,.6),textCalloutColor:(0,P._L)(r,.5)}}get visible(){return this.analysisView.visible}get viewMode(){const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView;if(null==e||null==t||e.equals(t))return w.None;const i=this.analysisView.result;if(null==i)return w.Direct;if("geodesic"===this.actualVisualizedMeasurement)return this._requiresGeodesicGuideAt(this._startPosition)||this._requiresGeodesicGuideAt(this._endPosition)?w.ProjectedGeodesic:w.Direct;const{verticalDistance:n,horizontalDistance:s}=i,a=(0,h.kM)(n,"meters").value,r=(0,h.kM)(s,"meters").value;return Math.min(a/r,r/a)<this.triangleCollapseRatioThreshold?w.Direct:w.Triangle}get actualVisualizedMeasurement(){const{measurementMode:e,result:t}=this.analysisView;switch(e){case c.G.Auto:return null!=t&&(0,h.kM)(t.horizontalDistance,"meters").value>Me.U7?"geodesic":"euclidean";case c.G.Euclidean:return"euclidean";case c.G.Geodesic:return"geodesic"}}get allowVisualElementsOrientationChange(){return null==this._triangleOrientationOverride}set allowVisualElementsOrientationChange(e){null==this._triangleOrientationOverride!==e&&(null==this._triangleOrientationOverride?this._triangleOrientationOverride=this._actualVisualElementsOrientation:this._triangleOrientationOverride=null)}get labels(){return"geodesic"===this.actualVisualizedMeasurement?{direct:null,horizontal:this._segmentLabel,vertical:this._verticalLabel}:{direct:this._segmentLabel,horizontal:this._horizontalLabel,vertical:this._verticalLabel}}constructor(e){super(e),this._segmentVisualElement=null,this._triangleVisualElement=null,this._rightAngleQuad=null,this._projectedGeodesicLine=null,this._geodesicStartHint=null,this._geodesicEndHint=null,this._segmentLabel=null,this._verticalLabel=null,this._horizontalLabel=null,this._startPosition=(0,V.vt)(),this._endPosition=(0,V.vt)(),this._cornerPosition=(0,V.vt)(),this._startPositionAtSeaLevel=(0,V.vt)(),this._endPositionAtSeaLevel=(0,V.vt)(),this._triangleOrientationOverride=null,this.messages=null,this.loadingMessages=!0,this.visualElementOrientation=y.Auto,this.triangleCollapseRatioThreshold=.03}initialize(){const e={attached:!0,view:this.view,isDecoration:!0},{guideLineWidth:t,guideStippleLengthPixels:i,triangleLineWidth:n,geodesicProjectionLineWidth:s,directLabelFontSize:a,verticalLabelFontSize:r,horizontalLabelFontSize:o}=this._parameters;this._segmentVisualElement=new _e((0,M.A)((0,M.A)({},e),{},{geometry:null,renderOccluded:N.m$.OccludeAndTransparent})),this._triangleVisualElement=new D.t((0,M.A)((0,M.A)({},e),{},{width:n,renderOccluded:N.m$.OccludeAndTransparent})),this._rightAngleQuad=new we.n((0,M.A)((0,M.A)({},e),{},{renderOccluded:N.m$.OccludeAndTransparent}));const l=(0,M.A)((0,M.A)({},e),{},{polygonOffset:!0,renderOccluded:N.m$.OccludeAndTransparent});this._projectedGeodesicLine=new D.t((0,M.A)((0,M.A)({},l),{},{width:s,stipplePattern:(0,be.wk)(i)})),this._geodesicStartHint=new D.t((0,M.A)((0,M.A)({},l),{},{width:t,stipplePattern:(0,be.wk)(i)})),this._geodesicEndHint=new D.t((0,M.A)((0,M.A)({},l),{},{width:t,stipplePattern:(0,be.wk)(i)})),this._segmentLabel=new E.N((0,M.A)((0,M.A)({},e),{},{fontSize:a})),this._verticalLabel=new E.N((0,M.A)((0,M.A)({},e),{},{fontSize:r})),this._horizontalLabel=new E.N((0,M.A)((0,M.A)({},e),{},{fontSize:o})),this.addHandles([(0,p.wB)(()=>{const{elevationAlignedStartPoint:e,elevationAlignedEndPoint:t}=this.analysisView,i=this.view;return{view:i,camera:i.state.camera,viewMode:this.viewMode,elevationAlignedStartPoint:e,elevationAlignedEndPoint:t,orientation:this._actualVisualElementsOrientation,visualizedMeasurement:this.actualVisualizedMeasurement,stripeLength:this._measurementArrowStripeLength}},e=>this._updateGeometryAndViewMode(e),p.pc),(0,p.wB)(()=>({visible:this.visible,viewMode:this.viewMode}),e=>this._updateVisualElementVisibility(e),p.pc),(0,p.wB)(()=>({text:this._labelsText,visualizedMeasurement:this.actualVisualizedMeasurement}),e=>this._updateLabelText(e),p.pc),(0,p.wB)(()=>({visible:this.visible,viewMode:this.viewMode}),e=>this._updateLabelVisibility(e),p.pc),(0,p.wB)(()=>this._measurementArrowStripeLength,e=>this._updateSegmentStripeLength(e),p.pc),(0,Pe.oQ)(async()=>this._updateMessageBundle()),(0,p.wB)(()=>this._parameters,e=>{let{textBackgroundColor:t,textCalloutColor:i,textColor:n,translucentAccentColor:s,accentColor:a,contrastColor:r}=e;const{_segmentLabel:o,_verticalLabel:l,_horizontalLabel:d,_triangleVisualElement:u,_rightAngleQuad:c,_projectedGeodesicLine:h,_geodesicStartHint:p,_geodesicEndHint:g,_segmentVisualElement:_}=this;o.backgroundColor=t,o.calloutColor=i,o.textColor=n,l.backgroundColor=t,l.calloutColor=i,l.textColor=n,d.backgroundColor=t,d.calloutColor=i,d.textColor=n,u.color=s,c.color=s,h.color=s,p.color=s,g.color=s,_.color=a,_.contrastColor=r},p.Vh)]),this._updateMessageBundle()}destroy(){this._segmentVisualElement=(0,a.pR)(this._segmentVisualElement),this._triangleVisualElement=(0,a.pR)(this._triangleVisualElement),this._rightAngleQuad=(0,a.pR)(this._rightAngleQuad),this._projectedGeodesicLine=(0,a.pR)(this._projectedGeodesicLine),this._geodesicStartHint=(0,a.pR)(this._geodesicStartHint),this._geodesicEndHint=(0,a.pR)(this._geodesicEndHint),this._segmentLabel=(0,a.pR)(this._segmentLabel),this._verticalLabel=(0,a.pR)(this._verticalLabel),this._horizontalLabel=(0,a.pR)(this._horizontalLabel),this.set("view",null)}_updateVisualElementVisibility(e){let{visible:t,viewMode:i}=e;if(this._segmentVisualElement.visible=!1,this._triangleVisualElement.visible=!1,this._rightAngleQuad.visible=!1,this._projectedGeodesicLine.visible=!1,this._geodesicStartHint.visible=!1,this._geodesicEndHint.visible=!1,t)switch(i){case w.None:break;case w.Direct:this._segmentVisualElement.visible=!0;break;case w.Triangle:this._segmentVisualElement.visible=!0,this._triangleVisualElement.visible=!0,this._rightAngleQuad.visible=!0;break;case w.ProjectedGeodesic:this._segmentVisualElement.visible=!0,this._projectedGeodesicLine.visible=!0,this._geodesicStartHint.visible=!0,this._geodesicEndHint.visible=!0}}_updateGeometryAndViewMode(e){let{view:t,camera:i,viewMode:n,elevationAlignedStartPoint:s,elevationAlignedEndPoint:a,orientation:r,visualizedMeasurement:o,stripeLength:l}=e;const d=t.renderCoordsHelper;if(null==d||null==s||null==a||s.equals(a))return;let u=this._startPosition,c=this._endPosition;d.toRenderCoords(s,u),d.toRenderCoords(a,c);const h=r===y.AboveSegment?1:-1,p=h*(d.getAltitude(c)-d.getAltitude(u));p<0&&(u=this._endPosition,c=this._startPosition);const g="geodesic"===o?new ye.J(this._startPosition,this._endPosition,d.spatialReference):new ye.C(this._startPosition,this._endPosition);switch(this._segmentVisualElement.geometry=g,this._updateSegmentStripeLength(l),n){case w.Direct:this._updateSegment(g,r);break;case w.Triangle:this._updateSegmentAndTriangle({view:t,camera:i,segment:g,orientation:r,startPosition:u,endPosition:c,deltaSign:h,altitudeDelta:p});break;case w.ProjectedGeodesic:this._updateSegmentAndProjection({view:t,orientation:r,startPosition:u,endPosition:c})}}_updateSegment(e,t){this._segmentLabel.anchor=t===y.AboveSegment?"top":"bottom",this._segmentLabel.geometry={type:"segment",segment:e,sampleLocation:"center"}}_updateSegmentAndTriangle(e){let{view:{renderCoordsHelper:t},camera:i,segment:n,orientation:s,startPosition:a,endPosition:r,deltaSign:o,altitudeDelta:l}=e;const d=this._cornerPosition;t.worldUpAtPosition(a,d),(0,S.g)(d,d,o*Math.abs(l)),(0,S.f)(d,d,a),this._triangleVisualElement.geometry=[[[a[0],a[1],a[2]],[d[0],d[1],d[2]],[r[0],r[1],r[2]]]],this._rightAngleQuad.geometry={previous:a,center:d,next:r};const u=new ye.C(a,d),c=new ye.C(d,r),h=function(e,t,i,n,s){const a=Ce,r=Se;s.projectToRenderScreen(i,a),s.projectToRenderScreen(t,r);const o={segment:"bottom",horizontal:"top",vertical:a[0]<r[0]?"left":"right"};{const n=Ve,a=Oe;if((0,O.Q)(e,i,s,n),(0,O.Q)(e,t,s,a),(0,C.Om)(n,a)>=Ae){const e=Math.sign(n[1])===Math.sign(a[1]);o.segment=e?(0,E.R)(o.vertical):o.vertical}else{const e=Ee;(0,O.Q)(i,t,s,e),(0,C.Om)(e,a)>=Ae&&(o.segment=Math.sign(e[0])===Math.sign(a[0])?(0,E.R)(o.horizontal):o.horizontal)}}if(n===y.BelowSegment){const e=e=>"top"===e?"bottom":"top";o.segment=e(o.segment),o.horizontal=e(o.horizontal),o.vertical=e(o.vertical)}return o}(a,r,d,s,i);this._segmentLabel.anchor=h.segment,this._segmentLabel.geometry={type:"segment",segment:n,sampleLocation:"center"},this._verticalLabel.geometry={type:"segment",segment:u,sampleLocation:"center"},this._verticalLabel.anchor=h.vertical,this._horizontalLabel.geometry={type:"segment",segment:c,sampleLocation:"center"},this._horizontalLabel.anchor=h.horizontal}_updateSegmentAndProjection(e){let{view:{renderCoordsHelper:t},orientation:i,startPosition:n,endPosition:s}=e;t.setAltitude(this._startPositionAtSeaLevel,0,n),t.setAltitude(this._endPositionAtSeaLevel,0,s);const a=new ye.J(this._startPositionAtSeaLevel,this._endPositionAtSeaLevel,t.spatialReference);this._projectedGeodesicLine.setGeometryFromSegment(a),this._geodesicStartHint.setGeometryFromSegment(new ye.C(this._startPositionAtSeaLevel,n)),this._geodesicEndHint.setGeometryFromSegment(new ye.C(this._endPositionAtSeaLevel,s)),this._segmentLabel.geometry={type:"segment",segment:a,sampleLocation:"center"},this._segmentLabel.anchor=i===y.AboveSegment?"top":"bottom"}_updateLabelText(e){let{text:t,visualizedMeasurement:i}=e;null!=t?(this._segmentLabel.text="euclidean"===i?t.directDistance:t.horizontalDistance,this._horizontalLabel.text=t.horizontalDistance,this._verticalLabel.text=t.verticalDistance):(this._segmentLabel.text=null,this._horizontalLabel.text=null,this._verticalLabel.text=null),this.notifyChange("labels")}_updateLabelVisibility(e){let{visible:t,viewMode:i}=e;const n=this._segmentLabel,s=this._horizontalLabel,a=this._verticalLabel;if(n.visible=!1,s.visible=!1,a.visible=!1,t)switch(i){case w.Direct:n.visible=!0;break;case w.Triangle:n.visible=!0,s.visible=!0,a.visible=!0;break;case w.ProjectedGeodesic:n.visible=!0;case w.None:}}get _labelsText(){if(this.destroyed)return null;const e=this.messages,t=this.analysisView.result;if(null==t||null==e)return null;const{directDistance:i,horizontalDistance:n,verticalDistance:s}=t,a=this.analysisView.unit,r=e=>(0,M.A)({directDistance:"",horizontalDistance:"",verticalDistance:""},e);switch(a){case"metric":return r({directDistance:i&&(0,L.Ee)(e,i),horizontalDistance:n&&(0,L.Ee)(e,n),verticalDistance:s&&(0,L.W4)(e,s)});case"imperial":return r({directDistance:i&&(0,L.tr)(e,i),horizontalDistance:n&&(0,L.tr)(e,n),verticalDistance:s&&(0,L.t_)(e,s)});default:return r({directDistance:i&&(0,L.zJ)(e,i,a),horizontalDistance:n&&(0,L.zJ)(e,n,a),verticalDistance:s&&(0,L.zJ)(e,s,a)})}}_updateSegmentStripeLength(e){const t=this._segmentVisualElement;null!=e?(t.stripeLength=e,t.stripesEnabled=!0):t.stripesEnabled=!1}get _actualVisualElementsOrientation(){if(null!=this._triangleOrientationOverride)return this._triangleOrientationOverride;const e=this.visualElementOrientation;return e===y.Auto?this.view.state.camera.aboveGround?y.AboveSegment:y.BelowSegment:e}_requiresGeodesicGuideAt(e){const t=this.view;if(null===t||void 0===t||!t.state)return!1;const i=t.state.camera,n=t.renderCoordsHelper;if(!n)return!1;const s=i.computeScreenPixelSizeAt(e);return n.getAltitude(e)/s>=10}get _measurementArrowStripeLength(){const{result:e,unit:t}=this.analysisView;if(null==e)return null;let i=null;const n=e.directDistance;switch(t){case"metric":i=n&&(0,h.kM)(n,"meters");break;case"imperial":i=n&&(0,h.kM)(n,(0,g.OU)(n.value,n.unit));break;default:i=n&&(0,h.kM)(n,t)}return null==i?null:(0,f.Vr)(i.value/30)*(0,g.oU)(1,i.unit,"meters")}_updateMessageBundle(){this.loadingMessages=!0,(0,fe.ud)("esri/core/t9n/Units").then(e=>{this.messages=e}).finally(()=>{this.loadingMessages=!1})}get testData(){}};(0,n._)([(0,r.MZ)()],Le.prototype,"_parameters",null),(0,n._)([(0,r.MZ)()],Le.prototype,"_triangleOrientationOverride",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"messages",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"analysisView",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"loadingMessages",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"visible",null),(0,n._)([(0,r.MZ)()],Le.prototype,"viewMode",null),(0,n._)([(0,r.MZ)()],Le.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],Le.prototype,"visualElementOrientation",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"triangleCollapseRatioThreshold",void 0),(0,n._)([(0,r.MZ)()],Le.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],Le.prototype,"labels",null),(0,n._)([(0,r.MZ)()],Le.prototype,"_labelsText",null),(0,n._)([(0,r.MZ)()],Le.prototype,"_actualVisualElementsOrientation",null),(0,n._)([(0,r.MZ)()],Le.prototype,"_measurementArrowStripeLength",null),Le=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurement.DirectLineMeasurementVisualization")],Le);const Ae=Math.cos((0,f.kU)(12)),Ce=(0,A.r_)(),Se=(0,A.r_)(),Ve=(0,A.QG)(),Oe=(0,A.QG)(),Ee=(0,A.QG)();var De,ze=i(56002),Ze=i(19451),Te=i(19247),Re=i(32535),xe=i(77515),Ge=i(70836),He=i(7947),ke=i(69539),Be=i(44230),Ne=i(56121),je=i(38317),Ie=i(91175),Qe=i(1307);!function(e){e.Manipulators="manipulators",e.AnalysisViewDestroyed="analysis-view-destroyed",e.AnalysisView="analysis-view"}(De||(De={}));let We=class extends s.A{constructor(e){super(e),this.cursorPoint=null,this._visible=!1,this._laserLine=null,this.laserLineEnabled=!0,this._lastDraggedHandle=null}initialize(){this._laserLine=new Qe.o({view:this.view,attached:!0,isDecoration:!0}),this._updateVisibility(this._visible),this._connectToAnalysisView(),this.addHandles((0,p.wB)(()=>this._params,e=>{let{laserLineGlowColor:t,laserLineInnerColor:i,laserLineGlobalAlpha:n}=e;const s=this._laserLine,a=s.style;s.style=(0,M.A)((0,M.A)({},a),{},{innerColor:i,glowColor:t,globalAlpha:n})}))}destroy(){this._laserLine=(0,a.pR)(this._laserLine)}get _params(){const{accentColor:e}=this.view.effectiveTheme;return{laserLineGlowColor:ke.A.toUnitRGB(e),laserLineGlowWidth:8,laserLineGlowFalloff:8,laserLineInnerColor:ke.A.toUnitRGB((0,P.bJ)(e)),laserLineInnerWidth:.75,laserLineGlobalAlpha:.75*e.a,handleColor:(0,P.f6)(e,.5),handleRadius:5}}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){}get _cursorPosition(){const e=(0,V.vt)(),t=this.cursorPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _startPosition(){const e=(0,V.vt)(),t=this.analysis.startPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _endPosition(){const e=(0,V.vt)(),t=this.analysis.endPoint;return t&&this.view.renderCoordsHelper.toRenderCoords(t,e),e}get _laserLineParams(){const e=this._focusPosition,{active:t,lineState:i}=this.toolState,n=this.analysisViewData,s=this.laserLineEnabled&&!!e&&"measured"!==i&&t;if(!s||!this.visible||null==n||n.destroyed)return{heightManifoldTarget:null,pointDistanceLine:null,lineVerticalPlaneSegment:null};const a=n.actualVisualizedMeasurement,r="local"!==this.view.viewingMode&&s&&!!this.analysis.startPoint&&"geodesic"===a,o=s&&n.viewMode===w.Triangle;return{heightManifoldTarget:"euclidean"===a?e:null,pointDistanceLine:r?this._pointDistanceLine:null,lineVerticalPlaneSegment:o?(0,Be.Cr)(this._startPosition,this._endPosition):null}}get _focusPosition(){const{lineState:e}=this.toolState,t=this.analysisViewData,i=null!=t&&!t.destroyed&&t.measurementMode===c.G.Euclidean&&t.viewMode===w.Direct;switch(e){case"drawing":return i?this._startPosition:this.analysis.endPoint?this._endPosition:this._startPosition;case"editing":return i?"start"===this._lastDraggedHandle?this._endPosition:this._startPosition:"start"===this._lastDraggedHandle?this._startPosition:this._endPosition;default:return null!=this.cursorPoint?this._cursorPosition:null}}get _pointDistanceLine(){return{origin:"drawing"===this.toolState.lineState||"end"===this._lastDraggedHandle?this._startPosition:this._endPosition,target:this._focusPosition}}createManipulators(){const e=this._params,{view:t}=this,i=()=>{const i=(0,je.UM)(e.handleColor),n=[new Ie.M((0,B.CM)(i,1,32,32))],s=new Ne.q({view:t,renderObjects:n});return s.available=!1,s.radius=e.handleRadius,[s,i]},[n,s]=i(),[a,r]=i(),o=new Ne.q({view:this.view,available:!1,interactive:!1});null!=this.analysis.startPoint&&(n.location=this.analysis.startPoint,n.available=!0),null!=this.analysis.endPoint&&(a.location=this.analysis.endPoint,a.available=!0);const l=()=>{let e=this._lastDraggedHandle;n.grabbing&&!a.grabbing&&(e="start"),a.grabbing&&!n.grabbing&&(e="end"),n.grabbing||a.grabbing||(e=null),this._lastDraggedHandle=e},d=n.events.on("grab-changed",l),u=a.events.on("grab-changed",l);return this.addHandles([d,u,(0,p.wB)(()=>(0,P.pf)(this._params.handleColor),e=>{s.setParameters({color:e}),r.setParameters({color:e})},{equals:P.we})],De.Manipulators),{start:n,end:a,cursor:o}}show(){this.destroyed||this._visible||this._updateVisibility(!0)}hide(){!this.destroyed&&this._visible&&this._updateVisibility(!1)}_connectToAnalysisView(){this.removeHandles(De.AnalysisView),this.addHandles([(0,p.wB)(()=>{var e;return null===(e=this.analysisViewData)||void 0===e?void 0:e.destroyed},e=>{e&&this.removeHandles(De.AnalysisView)},p.Vh),(0,p.wB)(()=>["measured"===this.toolState.lineState,this.analysisViewData],e=>{let[t,i]=e;null==i||i.destroyed||(i.allowVisualElementsOrientationChange=!t)},p.Vh),(0,p.wB)(()=>this._laserLineParams,e=>{const t=this._laserLine;t.heightManifoldTarget=e.heightManifoldTarget,t.pointDistanceLine=e.pointDistanceLine,t.lineVerticalPlaneSegment=e.lineVerticalPlaneSegment},p.Vh)],De.AnalysisView)}_updateVisibility(e){this.initialized&&(this._visible=e,e?this._laserLine.style={innerColor:this._params.laserLineInnerColor,innerWidth:this._params.laserLineInnerWidth,glowColor:this._params.laserLineGlowColor,glowWidth:this._params.laserLineGlowWidth,glowFalloff:this._params.laserLineGlowFalloff,globalAlpha:this._params.laserLineGlobalAlpha}:this.view.cursor=null,this._laserLine.visible=e)}};(0,n._)([(0,r.MZ)({constructOnly:!0})],We.prototype,"view",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"_params",null),(0,n._)([(0,r.MZ)({constructOnly:!0})],We.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],We.prototype,"analysisViewData",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"cursorPoint",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"toolState",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"visible",null),(0,n._)([(0,r.MZ)()],We.prototype,"testData",null),(0,n._)([(0,r.MZ)()],We.prototype,"_visible",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"_laserLine",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],We.prototype,"laserLineEnabled",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"_cursorPosition",null),(0,n._)([(0,r.MZ)()],We.prototype,"_startPosition",null),(0,n._)([(0,r.MZ)()],We.prototype,"_endPosition",null),(0,n._)([(0,r.MZ)()],We.prototype,"_lastDraggedHandle",void 0),(0,n._)([(0,r.MZ)()],We.prototype,"_laserLineParams",null),(0,n._)([(0,r.MZ)()],We.prototype,"_focusPosition",null),(0,n._)([(0,r.MZ)()],We.prototype,"_pointDistanceLine",null),We=(0,n._)([(0,l.$)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DView")],We);var Ue=i(80935),qe=i(5109),Fe=i(89238),$e=i(17046),Je=i(974),Xe=i(59833),Ye=i(13284),Ke=i(61237),et=i(82887),tt=i(70330),it=i(11500);let nt=class extends qe.k{constructor(e){super(e),this._updatingHandles=new Ze.U,this._emulatedDrag=null,this.lineState="initial",this.removeIncompleteOnCancel=!1,this.startPointSurfaceLocation=null,this.endPointSurfaceLocation=null,this.cursorPointSurfaceLocation=null,this.startManipulator=null,this.endManipulator=null,this.cursorManipulator=null,this._getSnappingContext=(0,ze.B)(e=>new Ye.e({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new Xe.p(new Je.ZE("point",(0,Fe.BV)(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new Ge.s}))}initialize(){const{view:e,analysis:t,analysisViewData:i,visible:n}=this;this.measurementView=new We({toolState:this,view:e,analysis:t,analysisViewData:i,visible:n});const s=(0,et.X)(e);this._snappingManagerResult=s,this.addHandles(s);const{start:a,end:r,cursor:o}=this.measurementView.createManipulators(),l=(e,t,i)=>{const n=(0,$e.Xt)(e,(e,n,s,a)=>{const r=(0,He.z7)(e),o=this._snappingManager,l=this._getSnappingContext(a),d=this._updatingHandles,{lineState:u}=this;s=s.next(r).next((0,$e.VG)(this,[i,t])).next(i=>{if("cursorPoint"!==t){const i=this.analysis[t];null!=i&&(e.location=i)}return i});const c=(0,He.xk)(this.view);let h=n.next(r).next(e=>{const n=c(e);return n||"drawing"!==this.lineState&&"initial"!==this.lineState||(this[t]=null,this[i]=null),n});if("touch"!==a||"editing"===u){const{snappingStep:e,cancelSnapping:t}=(0,Ke.L)({snappingManager:o,snappingContext:l,updatingHandles:d});s=s.next(t),h=h.next(...e)}h.next(e=>"start"!==e.action?e:null).next(n=>{const s=(0,Re.EL)(n.mapEnd,new Te.A);this[t]=s,e.location=s,this[i]=this._surfaceLocation(s,n.surfaceType)})});return"cursorPoint"===t?[n]:[n,e.events.on("grab-changed",()=>{const e=a.grabbing||r.grabbing;this.lineState=e?"editing":"measured"}),(0,p.wB)(()=>this.analysis[t],t=>{t&&(e.location=t)})]};this.startManipulator=a,this.endManipulator=r,this.cursorManipulator=o,this.manipulators.add(a),this.manipulators.add(r),this.manipulators.add(o),this.addHandles([...l(a,"startPoint","startPointSurfaceLocation"),...l(r,"endPoint","endPointSurfaceLocation"),...l(o,"cursorPoint","cursorPointSurfaceLocation"),(0,p.z7)(()=>"measured"===this.state,()=>{this.finishToolCreation(),this.active&&(this.view.activeTool=null)},p.pc),(0,p.wB)(()=>({startPointAvailable:null!=this.startPoint,endPointAvailable:null!=this.endPoint}),e=>{let{startPointAvailable:t,endPointAvailable:i}=e;this.startManipulator.available=t,this.endManipulator.available=i},p.pc)]),(0,tt.BY)(this)}destroy(){this._updatingHandles=(0,a.pR)(this._updatingHandles),this.measurementView=(0,a.pR)(this.measurementView)}get _snappingManager(){return this._snappingManagerResult.snappingManager}get state(){const{analysis:e}=this;if(null==e.startPoint&&null==e.endPoint)return"ready";const{lineState:t}=this;return this.validMeasurement&&"editing"!==t&&"drawing"!==t?"measured":"measuring"}get cursor(){return!this.active||"ready"!==this.state&&"measured"===this.lineState?null:"crosshair"}get startPoint(){return this.analysis.startPoint}set startPoint(e){this.analysis.startPoint=e}get endPoint(){return this.analysis.endPoint}set endPoint(e){this.analysis.endPoint=e}get cursorPoint(){return this.measurementView.cursorPoint}set cursorPoint(e){this.measurementView.cursorPoint=e}get snappingOptions(){return this._snappingManager.options}get validMeasurement(){return null!=this.analysis.startPoint&&null!=this.analysis.endPoint}get updating(){return this._updatingHandles.updating||this._snappingManager.updating}resetCreated(){super.resetCreated(),this.lineState="initial",this.cursorPoint=null,"measured"===this.state&&this.finishToolCreation()}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onDeactivate(){var e;null!==(e=this._emulatedDrag)&&void 0!==e&&e.cancel(),this._emulatedDrag=null}onInputEvent(e){switch(e.type){case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e)}}_handlePointerMove(e){var t,i;if(!this.active||this.view.navigating)return;const{pointerType:n}=e;if("mouse"!==n)return;const s=(0,it.ZV)(e),{lineState:a,cursorManipulator:r,endManipulator:o}=this;let l=!1;null==this.cursorPoint&&(null!==(t=this._emulatedDrag)&&void 0!==t&&t.cancel(),this._emulatedDrag=st(r,n,s),l=!0),"initial"===a&&(null!==(i=this._emulatedDrag)&&void 0!==i&&i.update(s),l=!0),"drawing"===a&&(o.events.emit("drag",{action:"update",start:s,screenPoint:s}),l=!0),l&&e.stopPropagation()}_handleImmediateClick(e){var t,i,n,s;if(!this.active||!(0,xe.s7)(e))return;const a=(0,it.ZV)(e),{pointerType:r}=e,{cursorManipulator:o,startManipulator:l,endManipulator:d,lineState:u}=this;let c=!1;switch(null==this.cursorPoint&&(null!==(t=this._emulatedDrag)&&void 0!==t&&t.cancel(),this._emulatedDrag=st(o,r,a)),u){case"initial":if(null!==(i=this._emulatedDrag)&&void 0!==i&&i.update(a),null!=this.cursorPoint){var h;null!==(h=this._emulatedDrag)&&void 0!==h&&h.end(a),this._emulatedDrag=null,this.endPoint=null;const{cursorPoint:e}=this;this.startPoint=e,this.startPointSurfaceLocation=this.cursorPointSurfaceLocation,l.location=e,l.interactive=!1,d.interactive=!1,this.lineState="drawing",this._emulatedDrag=st(d,r,a),c=!0}break;case"drawing":null!==(n=this._emulatedDrag)&&void 0!==n&&n.update(a),null!=this.endPoint&&(null!==(s=this._emulatedDrag)&&void 0!==s&&s.end(a),this._emulatedDrag=null,l.interactive=!0,d.interactive=!0,this.lineState="measured",c=!0)}c&&e.stopPropagation()}_surfaceLocation(e,t){var i;return t===He.Og.GROUND?"on-the-surface":(null!==(i=e.z)&&void 0!==i?i:0)>=this._getElevation(e)?"above-the-surface":"below-the-surface"}_getElevation(e){var t;return this.view.basemapTerrain.ready&&null!==(t=(0,Ue.R1)(this.view.elevationProvider,e))&&void 0!==t?t:0}get test(){}};function st(e,t,i){return e.events.emit("drag",{action:"start",pointerType:t,start:i,screenPoint:i}),{update:t=>e.events.emit("drag",{action:"update",start:t,screenPoint:t}),end:t=>e.events.emit("drag",{action:"end",start:t,screenPoint:t}),cancel:()=>e.events.emit("drag",{action:"cancel"})}}(0,n._)([(0,r.MZ)({readOnly:!0})],nt.prototype,"state",null),(0,n._)([(0,r.MZ)()],nt.prototype,"lineState",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],nt.prototype,"cursor",null),(0,n._)([(0,r.MZ)()],nt.prototype,"startPoint",null),(0,n._)([(0,r.MZ)()],nt.prototype,"endPoint",null),(0,n._)([(0,r.MZ)()],nt.prototype,"cursorPoint",null),(0,n._)([(0,r.MZ)({constructOnly:!0})],nt.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],nt.prototype,"analysisViewData",void 0),(0,n._)([(0,r.MZ)()],nt.prototype,"measurementView",void 0),(0,n._)([(0,r.MZ)()],nt.prototype,"removeIncompleteOnCancel",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0})],nt.prototype,"view",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],nt.prototype,"validMeasurement",null),(0,n._)([(0,r.MZ)({value:null})],nt.prototype,"startPointSurfaceLocation",void 0),(0,n._)([(0,r.MZ)({value:null})],nt.prototype,"endPointSurfaceLocation",void 0),(0,n._)([(0,r.MZ)({value:null})],nt.prototype,"cursorPointSurfaceLocation",void 0),(0,n._)([(0,r.MZ)()],nt.prototype,"updating",null),nt=(0,n._)([(0,l.$)("esri.views.3d.interactive.measurementTools.directLineMeasurement3D.DirectLineMeasurement3DTool")],nt);var at=i(10260),rt=i(23739);let ot=class extends((0,u.P)(s.A)){constructor(e){super(e),this.type="direct-line-measurement-view-3d",this.analysis=null,this.tool=null,this.result=null,this.measurementMode=c.G.Auto,this.elevationAlignedStartPoint=null,this.elevationAlignedEndPoint=null,this.userOperation=null}initialize(){const{analysis:e,view:t}=this;this._analysisVisualization=new Le({view:t,analysis:e,analysisView:this}),this.addResolvingPromise((0,rt.V)().then(i=>{this.destroyed||(this._analysisController=new m({view:t,analysis:e,viewData:this,geodesicLengthMeasurementUtils:i}))})),this.addHandles((0,at.Hd)(this,nt))}destroy(){(0,at.aS)(this),this.userOperation=(0,a.DC)(this.userOperation),this._analysisController=(0,a.pR)(this._analysisController),this._analysisVisualization=(0,a.pR)(this._analysisVisualization)}get updating(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}get viewMode(){return this._analysisVisualization.viewMode}get actualVisualizedMeasurement(){return this._analysisVisualization.actualVisualizedMeasurement}get visualElementOrientation(){return this._analysisVisualization.visualElementOrientation}set visualElementOrientation(e){this._analysisVisualization.visualElementOrientation=e}get allowVisualElementsOrientationChange(){return this._analysisVisualization.allowVisualElementsOrientationChange}set allowVisualElementsOrientationChange(e){this._analysisVisualization.allowVisualElementsOrientationChange=e}get triangleCollapseRatioThreshold(){return this._analysisVisualization.triangleCollapseRatioThreshold}set triangleCollapseRatioThreshold(e){this._analysisVisualization.triangleCollapseRatioThreshold=e}get directLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.direct)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get horizontalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.horizontal)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get verticalLabelText(){var e,t;return null!==(e=null===(t=this._analysisVisualization.labels.vertical)||void 0===t?void 0:t.text)&&void 0!==e?e:""}get unit(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:(0,d.c)(this.view)}get testData(){}place(e){return(0,at.ZX)(this,{placementOptions:e})}};(0,n._)([(0,r.MZ)()],ot.prototype,"_analysisVisualization",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"_analysisController",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"updating",null),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"type",void 0),(0,n._)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],ot.prototype,"analysis",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"tool",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"result",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"measurementMode",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"elevationAlignedStartPoint",void 0),(0,n._)([(0,r.MZ)()],ot.prototype,"elevationAlignedEndPoint",void 0),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"viewMode",null),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"actualVisualizedMeasurement",null),(0,n._)([(0,r.MZ)()],ot.prototype,"visualElementOrientation",null),(0,n._)([(0,r.MZ)()],ot.prototype,"allowVisualElementsOrientationChange",null),(0,n._)([(0,r.MZ)()],ot.prototype,"triangleCollapseRatioThreshold",null),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"directLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"horizontalLabelText",null),(0,n._)([(0,r.MZ)({readOnly:!0})],ot.prototype,"verticalLabelText",null),(0,n._)([(0,r.MZ)()],ot.prototype,"unit",null),(0,n._)([(0,r.MZ)()],ot.prototype,"userOperation",void 0),ot=(0,n._)([(0,l.$)("esri.views.3d.analysis.DirectLineMeasurementAnalysisView3D")],ot);const lt=ot}}]);
//# sourceMappingURL=97749.a38581c8.chunk.js.map