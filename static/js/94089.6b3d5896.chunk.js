"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[94089],{14318:(e,t,i)=>{i.d(t,{O:()=>d});var s=i(89379),n=i(6326),r=i(91967),a=i(30726),o=i(50346),l=i(46053),h=(i(81806),i(76460),i(47249),i(87990)),u=i(59752);let d=class extends r.A{constructor(e){super(e),this.constrainResult=e=>e,this._snapPoints=null,this._frameTask=null,this._abortController=null,this._stagedPoint=null,this._snap=(0,o.sg)(async(e,t,i,n)=>{const r=this._frameTask;if(null==r)return;const a=await r.schedule(()=>t.snap((0,s.A)((0,s.A)({},e),{},{context:i,signal:n})),n);a.valid&&await r.schedule(()=>{this.stagedPoint=a.apply(),e!==this._snapPoints&&null!=this._snapPoints&&(this.stagedPoint=t.update((0,s.A)((0,s.A)({},this._snapPoints),{},{context:i})))},n)})}get stagedPoint(){return this._stagedPoint}set stagedPoint(e){this._stagedPoint=this.constrainResult(e)}initialize(){var e;const t="3d"===this.view.type?null===(e=this.view)||void 0===e||null===(e=e.resourceController)||void 0===e?void 0:e.scheduler:null;this._frameTask=null!=t?t.registerTask(u.W6.SNAPPING):u.nu}destroy(){this._abortController=(0,a.DC)(this._abortController),this._frameTask=(0,a.xt)(this._frameTask)}update(e,t,i){this._snapPoints=e;const{point:s,scenePoint:n}=e,r=t.update({point:s,scenePoint:n,context:i});return this.stagedPoint=r,r}async snap(e,t,i){const{point:s,scenePoint:n}=e;return this.stagedPoint=t.update({point:s,scenePoint:n,context:i}),this._snapPoints=e,null==this._abortController&&(this._abortController=new AbortController),this._snap(e,t,i,this._abortController.signal)}async snapAgainNearPreviousMapPoint(e,t){null!=this._snapPoints&&await this.snap(this._snapPoints,e,t)}abort(){this._abortController=(0,a.DC)(this._abortController),this._snapPoints=null}};(0,n.Cg)([(0,l.MZ)({constructOnly:!0})],d.prototype,"view",void 0),(0,n.Cg)([(0,l.MZ)()],d.prototype,"stagedPoint",null),(0,n.Cg)([(0,l.MZ)()],d.prototype,"constrainResult",void 0),(0,n.Cg)([(0,l.MZ)()],d.prototype,"_stagedPoint",void 0),d=(0,n.Cg)([(0,h.$)("esri.views.interactive.snapping.SnappingOperation")],d)},38983:(e,t,i)=>{function s(e,t,i){i=i||2;var s,r,o,l,h,u,p,c=t&&t.length,g=c?t[0]*i:e.length,m=n(e,0,g,i,!0),_=[];if(!m||m.next===m.prev)return _;if(c&&(m=d(e,t,m,i)),e.length>80*i){s=o=e[0],r=l=e[1];for(var v=i;v<g;v+=i)(h=e[v])<s&&(s=h),(u=e[v+1])<r&&(r=u),h>o&&(o=h),u>l&&(l=u);p=0!==(p=Math.max(o-s,l-r))?1/p:0}return a(m,_,i,s,r,p),_}function n(e,t,i,s,n){var r,a;if(n===Z(e,t,i,s)>0)for(r=t;r<i;r+=s)a=b(r,e[r],e[r+1],a);else for(r=i-s;r>=t;r-=s)a=b(r,e[r],e[r+1],a);if(a&&M(a,a.next)){var o=a.next;D(a),a=o}return a}function r(e,t){if(!e)return e;t||(t=e);var i,s=e;do{if(i=!1,s.steiner||!M(s,s.next)&&0!==w(s.prev,s,s.next))s=s.next;else{var n=s.prev;if(D(s),(s=t=n)===s.next)break;i=!0}}while(i||s!==t);return t}function a(e,t,i,s,n,d,p){if(e){!p&&d&&_(e,s,n,d);for(var c,g,m=e;e.prev!==e.next;)if(c=e.prev,g=e.next,d?l(e,s,n,d):o(e))t.push(c.i/i),t.push(e.i/i),t.push(g.i/i),D(e),e=g.next,m=g.next;else if((e=g)===m){p?1===p?a(e=h(r(e),t,i),t,i,s,n,d,2):2===p&&u(e,t,i,s,n,d):a(r(e),t,i,s,n,d,1);break}}}function o(e){var t=e.prev,i=e,s=e.next;if(w(t,i,s)>=0)return!1;for(var n=e.next.next;n!==e.prev;){if(f(t.x,t.y,i.x,i.y,s.x,s.y,n.x,n.y)&&w(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function l(e,t,i,s){var n=e.prev,r=e,a=e.next;if(w(n,r,a)>=0)return!1;for(var o=n.x<r.x?n.x<a.x?n.x:a.x:r.x<a.x?r.x:a.x,l=n.y<r.y?n.y<a.y?n.y:a.y:r.y<a.y?r.y:a.y,h=n.x>r.x?n.x>a.x?n.x:a.x:r.x>a.x?r.x:a.x,u=n.y>r.y?n.y>a.y?n.y:a.y:r.y>a.y?r.y:a.y,d=v(o,l,t,i,s),p=v(h,u,t,i,s),c=e.prevZ,g=e.nextZ;c&&c.z>=d&&g&&g.z<=p;){if(c!==e.prev&&c!==e.next&&f(n.x,n.y,r.x,r.y,a.x,a.y,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;if(c=c.prevZ,g!==e.prev&&g!==e.next&&f(n.x,n.y,r.x,r.y,a.x,a.y,g.x,g.y)&&w(g.prev,g,g.next)>=0)return!1;g=g.nextZ}for(;c&&c.z>=d;){if(c!==e.prev&&c!==e.next&&f(n.x,n.y,r.x,r.y,a.x,a.y,c.x,c.y)&&w(c.prev,c,c.next)>=0)return!1;c=c.prevZ}for(;g&&g.z<=p;){if(g!==e.prev&&g!==e.next&&f(n.x,n.y,r.x,r.y,a.x,a.y,g.x,g.y)&&w(g.prev,g,g.next)>=0)return!1;g=g.nextZ}return!0}function h(e,t,i){var s=e;do{var n=s.prev,a=s.next.next;!M(n,a)&&C(n,s,s.next,a)&&S(n,a)&&S(a,n)&&(t.push(n.i/i),t.push(s.i/i),t.push(a.i/i),D(s),D(s.next),s=e=a),s=s.next}while(s!==e);return r(s)}function u(e,t,i,s,n,o){var l=e;do{for(var h=l.next.next;h!==l.prev;){if(l.i!==h.i&&x(l,h)){var u=L(l,h);return l=r(l,l.next),u=r(u,u.next),a(l,t,i,s,n,o),void a(u,t,i,s,n,o)}h=h.next}l=l.next}while(l!==e)}function d(e,t,i,s){var a,o,l,h=[];for(a=0,o=t.length;a<o;a++)(l=n(e,t[a]*s,a<o-1?t[a+1]*s:e.length,s,!1))===l.next&&(l.steiner=!0),h.push(y(l));for(h.sort(p),a=0;a<h.length;a++)i=r(i=g(h[a],i),i.next);return i}function p(e,t){return e.x-t.x}function c(e){if(e.next.prev===e)return e;let t=e;for(;;){const i=t.next;if(i.prev===t||i===t||i===e)break;t=i}return t}function g(e,t){var i=function(e,t){var i,s=t,n=e.x,r=e.y,a=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var o=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(o<=n&&o>a){if(a=o,o===n){if(r===s.y)return s;if(r===s.next.y)return s.next}i=s.x<s.next.x?s:s.next}}s=s.next}while(s!==t);if(!i)return null;if(n===a)return i;var l,h=i,u=i.x,d=i.y,p=1/0;s=i;do{n>=s.x&&s.x>=u&&n!==s.x&&f(r<d?n:a,r,u,d,r<d?a:n,r,s.x,s.y)&&(l=Math.abs(r-s.y)/(n-s.x),S(s,e)&&(l<p||l===p&&(s.x>i.x||s.x===i.x&&m(i,s)))&&(i=s,p=l)),s=s.next}while(s!==h);return i}(e,t);if(!i)return t;var s=L(i,e),n=r(i,i.next);let a=c(s);return r(a,a.next),n=c(n),c(t===i?n:t)}function m(e,t){return w(e.prev,e,t.prev)<0&&w(t.next,e,e.next)<0}function _(e,t,i,s){var n=e;do{null===n.z&&(n.z=v(n.x,n.y,t,i,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,s,n,r,a,o,l,h=1;do{for(i=e,e=null,r=null,a=0;i;){for(a++,s=i,o=0,t=0;t<h&&(o++,s=s.nextZ);t++);for(l=h;o>0||l>0&&s;)0!==o&&(0===l||!s||i.z<=s.z)?(n=i,i=i.nextZ,o--):(n=s,s=s.nextZ,l--),r?r.nextZ=n:e=n,n.prevZ=r,r=n;i=s}r.nextZ=null,h*=2}while(a>1)}(n)}function v(e,t,i,s,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-s)*n)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function y(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function f(e,t,i,s,n,r,a,o){return(n-a)*(t-o)-(e-a)*(r-o)>=0&&(e-a)*(s-o)-(i-a)*(t-o)>=0&&(i-a)*(r-o)-(n-a)*(s-o)>=0}function x(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&C(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(S(e,t)&&S(t,e)&&function(e,t){var i=e,s=!1,n=(e.x+t.x)/2,r=(e.y+t.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==e);return s}(e,t)&&(w(e.prev,e,t.prev)||w(e,t.prev,t))||M(e,t)&&w(e.prev,e,e.next)>0&&w(t.prev,t,t.next)>0)}function w(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function M(e,t){return e.x===t.x&&e.y===t.y}function C(e,t,i,s){var n=V(w(e,t,i)),r=V(w(e,t,s)),a=V(w(i,s,e)),o=V(w(i,s,t));return n!==r&&a!==o||!(0!==n||!P(e,i,t))||!(0!==r||!P(e,s,t))||!(0!==a||!P(i,e,s))||!(0!==o||!P(i,t,s))}function P(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function V(e){return e>0?1:e<0?-1:0}function S(e,t){return w(e.prev,e,e.next)<0?w(e,t,e.next)>=0&&w(e,e.prev,t)>=0:w(e,t,e.prev)<0||w(e,e.next,t)<0}function L(e,t){var i=new A(e.i,e.x,e.y),s=new A(t.i,t.x,t.y),n=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,s.next=i,i.prev=s,r.next=s,s.prev=r,s}function b(e,t,i,s){var n=new A(e,t,i);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function D(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function A(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Z(e,t,i,s){for(var n=0,r=t,a=i-s;r<i;r+=s)n+=(e[a]-e[r])*(e[r+1]+e[a+1]),a=r;return n}i.d(t,{e:()=>s}),s.deviation=function(e,t,i,s){var n=t&&t.length,r=n?t[0]*i:e.length,a=Math.abs(Z(e,0,r,i));if(n)for(var o=0,l=t.length;o<l;o++){var h=t[o]*i,u=o<l-1?t[o+1]*i:e.length;a-=Math.abs(Z(e,h,u,i))}var d=0;for(o=0;o<s.length;o+=3){var p=s[o]*i,c=s[o+1]*i,g=s[o+2]*i;d+=Math.abs((e[p]-e[g])*(e[c+1]-e[p+1])-(e[p]-e[c])*(e[g+1]-e[p+1]))}return 0===a&&0===d?0:Math.abs((d-a)/a)},s.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)for(var a=0;a<t;a++)i.vertices.push(e[n][r][a]);n>0&&(s+=e[n-1].length,i.holes.push(s))}return i}},46576:(e,t,i)=>{i.d(t,{T:()=>n});var s=i(96342);function n(e){const t=new s.n(e);return t.options.store=0,t.options.excludeLabels=!0,t}},66678:(e,t,i)=>{i.d(t,{c:()=>o});var s=i(24648),n=i(7137),r=i(90659);const a=e=>({geodesicArea(t){const{spatialReference:i}=t;return(0,r.M0)(i,l,t=>function(e,t){try{return(0,s.gT)(Math.abs(e.geodesicArea(t,"square-meters")),"square-meters")}catch(i){return null}}(e,t),t)}});async function o(){const e=await Promise.all([i.e(52612),i.e(62481)]).then(i.bind(i,62481));return a(e)}function l(e){return(0,s.gT)(Math.abs((0,n.qy)([e],"square-meters")[0]),"square-meters")}},78009:(e,t,i)=>{i.d(t,{EI:()=>p,lO:()=>y,qh:()=>c,u0:()=>v});var s=i(24648),n=i(31633),r=i(38983),a=i(20664),o=i(9392),l=i(14487),h=i(13927),u=i(45097),d=i(41868);function p(e){return g(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]})}function c(e){return g(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{positionsWorldCoords:[]},!1)}function g(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.hasZ;const r=(0,d.l)(e.spatialReference),p=(0,n.B5)(r);if(null==p)return null;const c=(e,t)=>!(t.length<2)&&((0,a.j)(e,t[0],t[1],i&&t[2]||0),!0);let g=0;for(const s of e.rings){const i=s.length;if(i<3)continue;const{positionsWorldCoords:n}=t;for(;n.length<i;)n.push((0,o.vt)());const d=m,p=(0,a.j)(_,0,0,0),v=1/i;for(let t=0;t<i;t++){if(!c(d,s[t]))return null;if(!(0,l.F)(d,e.spatialReference,n[t],r))return null;(0,a.c)(p,p,n[t],v)}const f=(0,h.Cr)(n[0],n[1],p,(0,h.LV)());if(0===(0,a.m)((0,h.Qj)(f)))continue;for(let e=0;e<i;e++)(0,h.Z1)(f,p,n[e],n[e]);const x=y(n);for(let e=0;e<x.length;e+=3)g+=(0,u.Fm)(n[x[e]],n[x[e+1]],n[x[e+2]])}return(0,s.gT)(g,p)}const m=(0,o.vt)(),_=(0,o.vt)();function v(){return{positionsWorldCoords:[]}}function y(e){return(0,r.e)(function(e){const t=new Float64Array(2*e.length);for(let i=0;i<e.length;++i){const s=e[i],n=2*i;t[n]=s[0],t[n+1]=s[1]}return t}(e),[],2)}},86401:(e,t,i)=>{i.d(t,{Ci:()=>n,KL:()=>o,dB:()=>a,l5:()=>r,wB:()=>l});var s=i(48549);const n=(0,s.BP)().vec3f("position").freeze(),r=(0,s.BP)().vec3f("position").vec2f16("uv0").freeze(),a=(0,s.BP)().vec3f("position").vec4u8("color").freeze(),o=(0,s.BP)().vec3f("position").vec2f("uv0").freeze(),l=(0,s.BP)().vec3f("position").vec2f("uv0").vec4u8("olidColor").freeze()},87230:(e,t,i)=>{i.d(t,{C:()=>_,b:()=>m});var s,n,r=i(57528),a=i(26917),o=i(94192),l=i(80883),h=i(3799),u=i(95756),d=i(58350),p=i(86955),c=i(91911),g=i(2687);function m(e){const t=new g.N5,{vertex:i,fragment:m,varyings:_}=t;return t.fragment.include(a.HQ,e),t.include(o.Z,e),t.include(c.z,e),(0,h.NB)(i,e),t.attributes.add("position","vec3"),t.attributes.add("uv0","vec2"),_.add("vUV","vec2"),_.add("vpos","vec3"),i.main.add((0,p.H)(s||(s=(0,r.A)(["vUV = uv0;\nvpos = position;\nforwardViewPosDepth((view * vec4(position, 1.0)).xyz);\ngl_Position = proj * view * vec4(position, 1.0);"])))),m.uniforms.add(new u.G("size",e=>e.size)),m.uniforms.add(new d.E("color1",e=>e.color1)),m.uniforms.add(new d.E("color2",e=>e.color2)),m.include(l.a),m.main.add((0,p.H)(n||(n=(0,r.A)(["discardByTerrainDepth();\nvec2 uvScaled = vUV / (2.0 * size);\nvec2 uv = fract(uvScaled - 0.25);\nvec2 ab = clamp((abs(uv - 0.5) - 0.25) / fwidth(uvScaled), -0.5, 0.5);\nfloat fade = smoothstep(0.25, 0.5, max(fwidth(uvScaled.x), fwidth(uvScaled.y)));\nfloat t = mix(abs(ab.x + ab.y), 0.5, fade);\nfragColor = mix(color2, color1, t);\noutputColorHighlightOID(fragColor, vpos, fragColor.rgb);"])))),t}const _=Object.freeze(Object.defineProperty({__proto__:null,build:m},Symbol.toStringTag,{value:"Module"}))},94089:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ct});var s=i(6326),n=(i(81806),i(30726)),r=i(46053),a=i(76460),o=(i(47249),i(87990)),l=i(19747),h=i(2522),u=i(91967),d=i(68134),p=i(15941),c=i(24648),g=i(31633),m=i(19555),_=i(72745),v=i(20664),y=i(9392),f=i(55855),x=i(34111),w=i(56611),M=i(98510),C=i(14487);function P(e,t,i,s,n){(0,v.d)(V,e),(0,v.g)(S,e,t),(0,C.F)(V,i,V,n),(0,C.F)(S,i,S,n),(0,v.e)(s,S,V),(0,v.n)(s,s)}const V=(0,y.vt)(),S=(0,y.vt)();var L=i(64232),b=i(38496),D=i(65658),A=i(78315),Z=i(45097),R=i(77515),O=i(80935),z=i(94966),G=i(78009),k=i(29772),T=i(90659),I=i(41868);class H{get numVertices(){return this._length}get hasStagedVertex(){return null!=this._lastCursorPoint}constructor(e,t,i){var s,n;this._sceneView=e,this._geodesicAreaMeasurementUtils=t,this._geodesicLengthMeasurementUtils=i,this.validMeasurement=!1,this.positionsWorld=[],this.positionsRender=[],this.positionsFittedWorld=[],this.positionsFittedRender=[],this.positionsGeodesic=[],this.positionsSpherical=[],this.positionsStereographic=[],this.pathSegmentLengths=[],this.geodesicPathSegmentLengths=[],this.perimeterSegmentLengths=[],this.intersectingSegments=new Set,this.geodesicIntersectingSegments=new Set,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.areaCentroidWorldCoords=(0,y.vt)(),this.areaCentroidRenderCoords=(0,y.vt)(),this.geodesicAreaCentroidRenderCoords=(0,y.vt)(),this.fittingMode=null,this.area=null,this.geodesicArea=null,this.pathLength=null,this.geodesicPathLength=null,this.perimeterLength=null,this._length=0,this._centroidRenderCoords=(0,y.vt)(),this._planeWorldCoords=(0,f.vt)(),this._worldUp=(0,y.vt)(),this._worldTangent=(0,y.vt)(),this._frame=[(0,y.vt)(),(0,y.vt)(),(0,y.vt)()],this._lastPathVersion=-1,this._lastCursorPoint=null,this._mode=null,this._tempU=(0,y.vt)(),this._tempV=(0,y.vt)(),this._tempVec3=(0,y.vt)(),this._tempSphere=(0,A.c)();const r=(0,I.l)(e.spatialReference);this._measurementSR=r,this._lengthMeasurementUnit=null!==(s=(0,g._H)(r))&&void 0!==s?s:"meters",this._areaMeasurementUnit=null!==(n=(0,g.B5)(r))&&void 0!==n?n:"square-meters"}update(e,t,i,s,n,r){const a=this._lastPathVersion===e.version,o=t?t.equals(this._lastCursorPoint):null==this._lastCursorPoint,l=this._mode===n;return!(a&&!r&&l&&o)&&(this._lastPathVersion=e.version,this._lastCursorPoint=t,this._updateCursorSegmentLength(e,t),this._update(e,t,i,s,n),!0)}_update(e,t,i,s,n){const r=this._sceneView.renderSpatialReference,a=this._measurementSR,o=i.spatialReference;let l=e.numVertices;const h=!(null==t||t.equals(e.lastPoint)||l>2&&t.equals(e.firstPoint)||e.polygonIsClosed);h&&(l+=1);const u=!e.polygonIsClosed&&l>2,d=e.polygonIsClosed||u;this._resize(l);const p=(0,M.lO)(o),g=null!=o&&(0,T.yF)(o)?o:null,m=null!=g&&(0,w.canProjectWithoutEngine)(o,p),{positionsGeodesic:_,positionsWorld:y,positionsRender:f,positionsSpherical:x}=this,C=(e,t)=>{(function(e,t){var i;t.hasZ||(t.z=null!==(i=(0,O.R1)(e,t,"ground"))&&void 0!==i?i:0)})(i.elevationProvider,e),(0,L.g)(e,y[t],a),(0,L.g)(e,f[t],r),m&&((0,L.g)(e,_[t],g),(0,L.g)(e,x[t],p),(0,v.n)(x[t],x[t]))};e.forEachVertexPosition((e,t)=>C(e,t)),h&&C(t,l-1);const P=this._updatePathLengths(d);if(this.pathLength=this._length>1?(0,c.d_)(P,this._lengthMeasurementUnit):null,m){const e=this._updateGeodesicPathLengths(d,g);this.geodesicPathLength=null!=e&&this._length>1?e:null}else this.geodesicPathLength=null;if(this._updateMode(n),!d)return this.area=null,this.geodesicArea=null,this.perimeterLength=null,this.triangleIndices=null,this.geodesicTriangleIndices=null,this.intersectingSegments.clear(),this.geodesicIntersectingSegments.clear(),void(this.validMeasurement=!1);this._updateAreaAndPerimeterLength(i,r,a,s),m&&this._updateGeodesicArea(i,g),this.validMeasurement=!0}getData(){return{validMeasurement:this.validMeasurement,numVertices:this.numVertices,hasStagedVertex:this.hasStagedVertex,positionsRender:this.positionsRender,positionsFittedWorld:this.positionsFittedWorld,positionsFittedRender:this.positionsFittedRender,intersectingSegments:this.intersectingSegments,geodesicIntersectingSegments:this.geodesicIntersectingSegments,triangleIndices:this.triangleIndices,geodesicTriangleIndices:this.geodesicTriangleIndices,areaCentroidRenderCoords:this.areaCentroidRenderCoords,geodesicAreaCentroidRenderCoords:this.geodesicAreaCentroidRenderCoords,area:this.area,geodesicArea:this.geodesicArea,pathLength:this.pathLength,geodesicPathLength:this.geodesicPathLength,perimeterLength:this.perimeterLength,actualMeasurementMode:this.actualMeasurementMode}}_resize(e){for(e<this._length&&(this.positionsWorld.length=e,this.positionsRender.length=e,this.positionsFittedWorld.length=e,this.positionsFittedRender.length=e,this.positionsGeodesic.length=e,this.positionsSpherical.length=e,this.positionsStereographic.length=e,this.pathSegmentLengths.length=e,this.geodesicPathSegmentLengths.length=e,this.perimeterSegmentLengths.length=e,this._length=e);this._length<e;)this.positionsWorld.push((0,y.vt)()),this.positionsRender.push((0,y.vt)()),this.positionsFittedWorld.push((0,_.vt)()),this.positionsFittedRender.push((0,y.vt)()),this.positionsGeodesic.push((0,y.vt)()),this.positionsSpherical.push((0,y.vt)()),this.positionsStereographic.push((0,_.vt)()),this.pathSegmentLengths.push(0),this.geodesicPathSegmentLengths.push(0),this.perimeterSegmentLengths.push(0),++this._length}_updatePathLengths(e){const t=this.positionsWorld,i=this.pathSegmentLengths;let s=0;const n=this._length;for(let r=0;r<n;++r){const a=i[r]=(0,v.k)(t[r],t[(r+1)%n]);(r<n-1||e)&&(s+=a)}return s}_updateGeodesicPathLengths(e,t){const i=this.positionsGeodesic,s=this.geodesicPathSegmentLengths;let n=0;const r=this._length;for(let a=0;a<r;++a){const o=this._geodesicLengthMeasurementUtils.geodesicDistance(i[a],i[(a+1)%r],t);if(null==o)return null;const l=(0,c.kM)(o,"meters").value,h=s[a]=l;(a<r-1||e)&&(n+=h)}return(0,c.d_)(n,"meters")}_updateAreaAndPerimeterLength(e,t,i,s){const n=e.renderCoordsHelper,r=this.positionsWorld,a=this.positionsRender,o=this.positionsFittedWorld,l=this.positionsFittedRender,h=this._planeWorldCoords,u=this._centroidRenderCoords;(0,z.ix)(a,u),n.worldUpAtPosition(u,this._worldUp),n.worldBasisAtPosition(u,0,this._worldTangent),P(u,this._worldUp,t,this._worldUp,i),P(u,this._worldTangent,t,this._worldTangent,i),r.length>2&&(0,R.OK)(r,h),this.fittingMode=this._selectFittingMode(h,r,this._worldUp,s);let d=0;if("horizontal"===this.fittingMode){let e=-1/0;a.forEach((t,i)=>{const s=n.getAltitude(a[i]);s>e&&(e=s,d=i)})}const p=r[d];let c=h,g=this._worldTangent;"horizontal"===this.fittingMode?c=this._worldUp:"vertical"===this.fittingMode&&(c=this._tempVec3,g=this._worldUp,(0,z.YH)(h,this._worldUp,c)),(0,v.d)(this._frame[2],c),(0,z.YH)(g,c,this._frame[0]),(0,v.i)(this._frame[1],this._frame[0],this._frame[2]),(0,v.u)(this._frame[1],this._frame[1]);const _=this._tempVec3,y=this._tempU,f=this._tempV;for(let x=0;x<this._length;++x){const e=o[x],s=l[x];(0,v.e)(_,r[x],p),(0,m.hZ)(e,(0,v.f)(this._frame[0],_),(0,v.f)(this._frame[1],_)),(0,v.h)(y,this._frame[0],e[0]),(0,v.h)(f,this._frame[1],e[1]),(0,v.g)(_,y,f),(0,v.g)(_,_,p),(0,C.F)(_,i,s,t)}this.perimeterLength=this._length>0?this._updatePerimeterLengths():null,(0,z.ix)(l,this.areaCentroidRenderCoords),(0,C.F)(this.areaCentroidRenderCoords,t,this.areaCentroidWorldCoords,i),this._updateIntersectingSegments(),this.area=0===this.intersectingSegments.size?this._computeArea():null}_updateGeodesicArea(e,t){const{renderCoordsHelper:i,spatialReference:s}=e,{positionsSpherical:n,positionsStereographic:r}=this,a=this._tempVec3,o=(0,R.Gc)(n,a);if(!o)return void(this.geodesicArea=null);const l=this._tempU,h=this._tempV;(0,z.VV)(a,l,h);for(let u=0;u<this._length;++u){const e=(0,v.f)(n[u],l),t=(0,v.f)(n[u],h),i=(0,v.f)(n[u],a);(0,m.hZ)(r[u],e/i,t/i)}(0,v.h)(a,a,(0,x.tO)(s).radius),i.toRenderCoords(a,(0,M.lO)(s),this.geodesicAreaCentroidRenderCoords),this._updateGeodesicIntersectingSegments(),this.geodesicArea=o&&0===this.geodesicIntersectingSegments.size?this._computeGeodesicArea(t):null}_updatePerimeterLengths(){const e=this.positionsFittedWorld,t=this.perimeterSegmentLengths;let i=0;for(let s=0;s<this._length;++s)i+=t[s]=(0,m.Io)(e[s],e[(s+1)%this._length]);return(0,c.d_)(i,this._lengthMeasurementUnit)}_updateIntersectingSegments(){const e=this.positionsFittedWorld,t=this.intersectingSegments;t.clear();for(let i=0;i<this._length;++i)for(let s=i+2;s<this._length;++s){if((s+1)%this._length===i)continue;const n=e[i],r=e[(i+1)%this._length],a=e[s],o=e[(s+1)%this._length];(0,D.Ql)(n,r,a,o)&&(t.add(i),t.add(s))}}_computeArea(){const e=this.positionsFittedWorld,t=this.triangleIndices=(0,b.Dg)((0,G.lO)(e));let i=0;for(let s=0;s<t.length;s+=3)i+=(0,Z.Fm)(e[t[s]],e[t[s+1]],e[t[s+2]]);return(0,c.gT)(i,this._areaMeasurementUnit)}_updateGeodesicIntersectingSegments(){const e=this.positionsStereographic,t=this.geodesicIntersectingSegments;t.clear();for(let i=0;i<this._length;++i)for(let s=i+2;s<this._length;++s){if((s+1)%this._length===i)continue;const n=e[i],r=e[(i+1)%this._length],a=e[s],o=e[(s+1)%this._length];(0,D.Ql)(n,r,a,o)&&(t.add(i),t.add(s))}}_computeGeodesicArea(e){const t=this.positionsGeodesic,i=this.positionsStereographic,s=this.geodesicTriangleIndices=(0,b.Dg)((0,G.lO)(i));let n=0;for(let r=0;r<s.length;r+=3){const i=(0,R.zS)(t[s[r]],t[s[r+1]],t[s[r+2]],e,this._geodesicAreaMeasurementUtils);if(null==i)return null;n+=(0,c.kM)(i,"square-meters").value}return(0,c.gT)(n,"square-meters")}_selectFittingMode(e,t,i,s){const n=t.map(t=>Math.abs((0,R.CL)(e,t))).reduce((e,t)=>Math.max(e,t),0);(0,R.uc)(t,this._tempSphere);const r=n/(2*this._tempSphere[3]),a=r<s.maxRelativeErrorCoplanar,o=r<s.maxRelativeErrorAlmostCoplanar;let l="horizontal";return a?l="oblique":o&&(l=Math.abs((0,v.f)(i,e))>Math.cos((0,p.kU)(s.verticalAngleThreshold))?"horizontal":"vertical"),l}_updateCursorSegmentLength(e,t){var i;const s=e.lastPoint;e.isValidPolygon||null==s||null==t?(this.geodesicStagedSegmentLength=null,this.stagedSegmentLength=null):(this.geodesicStagedSegmentLength=this._geodesicLengthMeasurementUtils.geodesicDistanceBetweenPoints(s,t),this.stagedSegmentLength=null===(i=(0,k.NH)(s,t))||void 0===i?void 0:i.direct)}_updateMode(e){if(0===e){this.actualMeasurementMode="euclidean";let e=0;null!=this.geodesicPathLength&&(e+=this.geodesicPathLength.value),e>W&&(this.actualMeasurementMode="geodesic")}else this.actualMeasurementMode=1===e?"euclidean":"geodesic";null==this.geodesicPathLength&&(this.actualMeasurementMode="euclidean"),this._mode=e}}const W=1e5;let E=class extends u.A{constructor(e){super(e)}initialize(){this._measurementDataManager=new H(this.view,this.geodesicAreaMeasurementUtils,this.geodesicLengthMeasurementUtils),this.addHandles([this.analysisViewData.path.on("change",()=>this._update()),(0,d.wB)(()=>this.analysisViewData.stagedPoint,()=>this._update(),d.OH),(0,d.wB)(()=>this.analysisViewData.mode,()=>this._update(),d.OH)]),this._update()}_update(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const{analysisViewData:t,view:i}=this;this._measurementDataManager.update(t.path,t.stagedPoint,i,{maxRelativeErrorCoplanar:.005,maxRelativeErrorAlmostCoplanar:.01,verticalAngleThreshold:80},t.mode,e)&&(t.measurementData=this._measurementDataManager.getData())}};(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],E.prototype,"view",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],E.prototype,"analysis",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],E.prototype,"analysisViewData",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],E.prototype,"geodesicAreaMeasurementUtils",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],E.prototype,"geodesicLengthMeasurementUtils",void 0),E=(0,s.Cg)([(0,o.$)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementController")],E);var F=i(54099),B=i(19247),U=i(2413),q=i(17430),j=i(89238),N=i(974),Q=i(56497);let J=class extends F.nJ{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}),this._version=0,this._internalGeometryChange=!1,this._extent=(0,U.Ie)()}set areaMeasurement(e){this._set("areaMeasurement",e),null!=e&&null!=this.view&&this._initialize(e,this.view)}set view(e){this._set("view",e),null!=e&&null!=this.areaMeasurement&&this._initialize(this.areaMeasurement,e)}get constructed(){return null!=this.areaMeasurement&&null!=this.view}get version(){return this._version}get isEmptyPolygon(){return!this.constructed||0===this._editGeometry.parts.length}get isValidPolygon(){return this.constructed&&this.polygonIsClosed}get extent(){var e;if(this.constructed&&null!==(e=this._editGeometry.parts[0])&&void 0!==e&&e.vertices.length){const e=(0,U.Ie)(this._extent);return this.forEachVertex(t=>{(0,U.tK)(e,t.pos)}),e}return null}get spatialReference(){return this.constructed?this._editGeometry.coordinateHelper.spatialReference:null}_initialize(e,t){this.removeAllHandles(),this.addHandles((0,d.wB)(()=>e.geometry,()=>{this._updateEditGeometryFromModelGeometry(e,t)},d.pc)),this._makeDirty(!0)}_makeDirty(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.notifyChange("polygonIsClosed"),this.notifyChange("isValidPolygon"),this.notifyChange("initialized"),this.notifyChange("extent"),e&&this.notifyChange("numVertices")}_updateEditGeometryFromModelGeometry(e,t){if(this._version++,this._internalGeometryChange)return;this.removeHandles("EditGeometry");let i=e.geometry;if(null!=i){const s=(0,w.tryProjectWithZConversion)(i,t.spatialReference);null==s&&(0,q.V)(e,i.spatialReference,a.A.getLogger(this)),i=s}this._editGeometryOperations=null!=i?Q.p.fromGeometry(i,t.state.viewingMode):new Q.p(new N.ZE("polygon",(0,j.BV)(!0,!1,t.spatialReference)),t.state.viewingMode),this._makeDirty(!0),this.emit("change"),this.addHandles(this._editGeometry.on("change",t=>{this._makeDirty(null!=t.addedVertices||null!=t.removedVertices),this._internalGeometryChange=!0,e.geometry=this.numVertices>0?this._editGeometry.geometry:null,this._internalGeometryChange=!1}),"EditGeometry")}get _editGeometry(){return this._editGeometryOperations.data}get vertices(){const e=[];return this.forEachVertex(t=>{e.push(t)}),e}get numVertices(){var e,t;return this.constructed&&null!==(e=null===(t=this._editGeometry.parts[0])||void 0===t?void 0:t.vertices.length)&&void 0!==e?e:0}get polygonIsClosed(){var e,t;return null!==(e=null===(t=this._editGeometry.parts[0])||void 0===t?void 0:t.isClosed())&&void 0!==e&&e}get firstPoint(){if(this.constructed){var e;const{coordinateHelper:t,parts:i}=this._editGeometry,s=null===(e=i[0])||void 0===e?void 0:e.getFirstVertex();if(null!=s)return t.vectorToPoint(s.pos)}return null}get lastPoint(){if(this.constructed){var e;const{coordinateHelper:t,parts:i}=this._editGeometry,s=null===(e=i[0])||void 0===e?void 0:e.getLastVertex();if(null!=s)return t.vectorToPoint(s.pos)}return null}getVertex(e){var t;if(!this.constructed||null===(t=this._editGeometry.parts[0])||void 0===t||!t.vertices.length)return null;const i=this._editGeometry.parts[0].vertices[0];let s=i;do{if(s.index===e)return s;s=s.rightSegment.rightVertex}while(s!==i&&null!=s);return null}getVertexPositionAsPoint(e){return this._editGeometry.coordinateHelper.vectorToPoint(e.pos)}getVertexPositionAsPointFromIndex(e){return this._editGeometry.coordinateHelper.vectorToPoint(this.getVertex(e).pos)}forEachVertex(e){if(this.constructed&&this._editGeometry.parts.length>0)for(const t of this._editGeometry.parts[0].iterateVertices())e(t,t.index)}forEachVertexPosition(e){const t=this._editGeometry.coordinateHelper;this.forEachVertex((i,s)=>{t.vectorToPoint(i.pos,$),e($,s)})}clear(){null!=this.areaMeasurement&&(this.areaMeasurement.geometry=null)}add(e){if(!this.constructed)return null;const t=this._editGeometryOperations.appendVertex(this._editGeometry.coordinateHelper.pointToVector(e),this._editGeometry.parts.at(0));return this.emit("change"),t}close(){if(!this.constructed||0===this._editGeometry.parts.length)return null;const e=this._editGeometryOperations.closePart(this._editGeometry.parts[0]);return this.emit("change"),e}ensureContains(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=!1;if(this._editGeometry.parts.forEach(t=>{for(const s of t.iterateVertices())s===e&&(i=!0)}),!i)throw new Error("vertex doesn't exist ".concat(t));return i}setVertexPosition(e,t){if(!this.constructed)return null;const i=this._editGeometryOperations.setVertexPosition(e,this._editGeometry.coordinateHelper.pointToVector(t));return this.emit("change"),i}equals(e){if(this.numVertices!==e.numVertices)return!1;let t=!0;return this.forEachVertexPosition((i,s)=>{const n=e.getVertexPositionAsPointFromIndex(s);i.equals(n)||(t=!1)}),!!t}};(0,s.Cg)([(0,r.MZ)({value:null})],J.prototype,"areaMeasurement",null),(0,s.Cg)([(0,r.MZ)({value:null})],J.prototype,"view",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"isEmptyPolygon",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"isValidPolygon",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"extent",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"spatialReference",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"numVertices",null),(0,s.Cg)([(0,r.MZ)()],J.prototype,"polygonIsClosed",null),J=(0,s.Cg)([(0,o.$)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementPathHelper")],J);const $=new B.A;var K=i(89379),X=(i(11265),i(59784)),Y=i(11113),ee=i(34761),te=i(13191);function ie(e,t){return(0,c.kM)(e,(0,g.cT)(e.value,e.unit,t))}function se(e,t){return(0,c.kM)(e,ne(e,t))}function ne(e,t){const i=function(e){switch(e){case"metric":case"ares":case"hectares":return"metric";case"imperial":case"acres":return"imperial";case"square-inches":return"inches";case"square-feet":return"feet";case"square-yards":return"yards";case"square-miles":return"miles";case"square-nautical-miles":return"nautical-miles";case"square-us-feet":return"us-feet";case"square-millimeters":return"millimeters";case"square-centimeters":return"centimeters";case"square-decimeters":return"decimeters";case"square-meters":return"meters";case"square-kilometers":return"kilometers"}throw new Error("unhandled area unit")}(t);return(0,g.Vs)(e.value,e.unit,i)}var re=i(66747),ae=i(7256),oe=i(43047),le=i(32314),he=i(50468),ue=i(17345),de=i(34981),pe=i(59696),ce=i(45463),ge=i(82809),me=i(86401),_e=i(63928),ve=i(16506),ye=i(59246),fe=i(60322),xe=i(87230),we=i(57162);class Me extends ye.w{constructor(e,t){super(e,t,new ve.$(xe.C,()=>i.e(62028).then(i.bind(i,62028))),me.l5.locations)}initializePipeline(e){const{oitPass:t,transparent:i,polygonOffset:s,output:n}=e,r=0===t,a=2===t;return(0,we.Ey)({blending:i?(0,fe.Yf)(t):null,depthTest:{func:(0,fe.K_)(t)},depthWrite:(0,fe.z5)(e),drawBuffers:(0,fe.m6)(t,n),colorWrite:we.kn,polygonOffset:r||a?s?Ce:null:{factor:-1,units:-25}})}}const Ce={factor:0,units:-25};var Pe=i(6485),Ve=i(92656);class Se extends Ve.E{constructor(){super(...arguments),this.transparent=!1,this.writeDepth=!0,this.polygonOffset=!1,this.terrainDepthTest=!1,this.cullAboveTerrain=!1,this.textureCoordinateType=0,this.emissionSource=0,this.output=0,this.occlusionPass=!1,this.olidColorInstanced=!1,this.overlayEnabled=!1,this.draped=!1,this.snowCover=!1}get discardInvisibleFragments(){return this.transparent&&this.writeDepth}}(0,s.Cg)([(0,Pe.W)()],Se.prototype,"transparent",void 0),(0,s.Cg)([(0,Pe.W)()],Se.prototype,"writeDepth",void 0),(0,s.Cg)([(0,Pe.W)()],Se.prototype,"polygonOffset",void 0),(0,s.Cg)([(0,Pe.W)()],Se.prototype,"terrainDepthTest",void 0),(0,s.Cg)([(0,Pe.W)()],Se.prototype,"cullAboveTerrain",void 0);var Le=i(75569);class be extends _e.W{constructor(e){super(e,Ae),this._configuration=new Se,this.produces=new Map([[2,e=>(0,de.RN)(e)&&!this.transparent],[4,e=>(0,de.RN)(e)&&this.transparent&&this.parameters.writeDepth],[8,e=>(0,de.RN)(e)&&this.transparent&&!this.parameters.writeDepth]])}getConfiguration(e,t){return super.getConfiguration(e,t,this._configuration),this._configuration.transparent=this.transparent,this._configuration.writeDepth=this.parameters.writeDepth,this._configuration.polygonOffset=this.parameters.polygonOffset,this._configuration.oitPass=t.oitPass,this._configuration.terrainDepthTest=t.terrainDepthTest,this._configuration.cullAboveTerrain=t.cullAboveTerrain,this._configuration}get visible(){return this.parameters.color1[3]>=Le.Q||this.parameters.color2[3]>=Le.Q}get transparent(){return this.parameters.color1[3]<1||this.parameters.color2[3]<1}createGLMaterial(e){return new De(e)}createBufferWriter(){return new ge.Z(me.l5)}}class De extends pe.A{beginSlot(e){return this.getTechnique(Me,e)}}class Ae extends ce.q{constructor(){super(...arguments),this.size=(0,_.fA)(1,1),this.color1=(0,f.fA)(.75,.75,.75,1),this.color2=(0,f.fA)(.5,.5,.5,1),this.writeDepth=!0,this.polygonOffset=!1}}class Ze extends le.X{constructor(e){super(e),this._checkerBoardMaterial=null,this._renderOccluded=4,this._geometry=null,this._size=(0,_.fA)(1,1),this._color1=(0,f.fA)(1,.5,0,.5),this._color2=(0,f.fA)(1,1,1,.5),this.applyProperties(e)}get renderOccluded(){return this._renderOccluded}set renderOccluded(e){e!==this._renderOccluded&&(this._renderOccluded=e,this._updateMaterial())}get geometry(){return this._geometry}set geometry(e){this._geometry=e,this.recreateGeometry()}get size(){return this._size}set size(e){(0,m.C)(this._size,e),this._updateMaterial()}get color1(){return this._color1}set color1(e){(0,oe.a)(e,this._color1)||((0,oe.d)(this._color1,e),this._updateMaterial())}get color2(){return this._color2}set color2(e){(0,oe.a)(e,this._color2)||((0,oe.d)(this._color2,e),this._updateMaterial())}_updateMaterial(){var e;null===(e=this._checkerBoardMaterial)||void 0===e||e.setParameters({size:this._size,color1:this._color1,color2:this._color2,renderOccluded:this._renderOccluded})}createExternalResources(){this._checkerBoardMaterial=new be({size:this._size,color1:this._color1,color2:this._color2,writeDepth:!1,polygonOffset:!0,renderOccluded:4,isDecoration:this.isDecoration})}destroyExternalResources(){this._checkerBoardMaterial=null}forEachMaterial(e){e(this._checkerBoardMaterial)}createGeometries(e){if(null==this._geometry||null==this._checkerBoardMaterial)return;const t=Re;(0,ee.sC)(t,this.transform);const i=this._geometry,s=[],n=(0,y.vt)();i.position.forEach(e=>{(0,v.e)(n,e,t),s.push(n[0],n[1],n[2])});const r=[];i.uv.forEach(e=>{r.push(e[0],e[1])});const a=new ue.V(this._checkerBoardMaterial,[["position",new he.n(s,i.triangleIndices,3,!0)],["uv0",new he.n(r,i.triangleIndices,2,!0)]]);e.addGeometry(a)}}const Re=(0,y.vt)();var Oe=i(25191),ze=i(35925),Ge=i(38042),ke=i(63860);let Te=class extends u.A{get _parameters(){const{accentColor:e,textColor:t}=this.view.effectiveTheme,i=(0,X.QP)(e),s=(0,X.f6)(e,.5),n=(0,X.f6)((0,X.bJ)(e),.5),r=(0,X.bJ)(t,160);return{accentColor:i,transparentAccentColor:s,transparentContrastColor:n,intersectingLineColor:[1,.2,0,1],textColor:t,textBackgroundColor:(0,X._L)(r,.6),textCalloutColor:(0,X._L)(r,.5),pathLineWidth:3,perimeterLineWidth:2,projectionLineWidth:2,projectionLineStippleSize:5,labelDistance:25}}get visible(){return this.analysisViewData.visible}get _renderUnits(){var e;const t=this.view.renderCoordsHelper.spatialReference;return null!==(e=(0,g._H)(t))&&void 0!==e?e:"meters"}get testData(){}constructor(e){super(e),this._path=null,this._intersectedPath=null,this._perimeter=null,this._intersectedPerimeter=null,this._projectionLines=null,this._measurementArea=null,this._areaLabel=null,this._perimeterLengthLabel=null,this._pathSegments=[],this._perimeterSegments=[],this._origin=(0,y.vt)(),this._originTransform=(0,te.vt)(),this.messages=null,this.viewData=Ie,this.areaLabel=null,this.perimeterLengthLabel=null,this.loadingMessages=!0}initialize(){const{analysisViewData:e,_parameters:t,view:i}=this;this._path=new ae.t({view:i,attached:!0,width:t.pathLineWidth,polygonOffset:!0,renderOccluded:4,isDecoration:!0}),this._intersectedPath=new ae.t({view:i,attached:!0,width:t.pathLineWidth,polygonOffset:!0,renderOccluded:4,isDecoration:!0}),this._perimeter=new ae.t({view:i,attached:!0,width:t.perimeterLineWidth,polygonOffset:!0,renderOccluded:4,isDecoration:!0}),this._intersectedPerimeter=new ae.t({view:i,attached:!0,width:t.perimeterLineWidth,color:t.intersectingLineColor,polygonOffset:!0,renderOccluded:4,isDecoration:!0}),this._projectionLines=new ae.t({view:i,attached:!0,width:t.projectionLineWidth,stipplePattern:(0,ze.wk)(t.projectionLineStippleSize),polygonOffset:!0,renderOccluded:4,isDecoration:!0}),this._measurementArea=new Ze({view:i,attached:!0,isDecoration:!0});const s={attached:!0,view:i,isDecoration:!0};this._areaLabel=new re.N((0,K.A)((0,K.A)({},s),{},{fontSize:16})),this._perimeterLengthLabel=new re.N((0,K.A)((0,K.A)({},s),{},{fontSize:12})),this.addHandles([(0,d.wB)(()=>[e.mode,this.visible,e.unit,e.measurementData,e.stagedPoint],()=>this._update(),d.pc),(0,d.wB)(()=>{var e;return null===(e=i.state)||void 0===e?void 0:e.camera},()=>this._updateLabels(),d.pc),(0,Ge.oQ)(()=>this._updateMessageBundle()),(0,d.wB)(()=>this._parameters,e=>{let{accentColor:t,transparentAccentColor:i,transparentContrastColor:s,textColor:n,textBackgroundColor:r,textCalloutColor:a}=e;const{_path:o,_intersectedPath:l,_perimeter:h,_projectionLines:u,_measurementArea:d,_areaLabel:p,_perimeterLengthLabel:c}=this;o.color=t,l.color=t,h.color=t,u.color=t,d.color1=i,d.color2=s,p.textColor=n,p.backgroundColor=r,p.calloutColor=a,c.textColor=n,c.backgroundColor=r,c.calloutColor=a},d.Vh)]),this._updateMessageBundle()}destroy(){this._measurementArea=(0,n.pR)(this._measurementArea),this._path=(0,n.pR)(this._path),this._intersectedPath=(0,n.pR)(this._intersectedPath),this._perimeter=(0,n.pR)(this._perimeter),this._intersectedPerimeter=(0,n.pR)(this._intersectedPerimeter),this._areaLabel=(0,n.pR)(this._areaLabel),this._perimeterLengthLabel=(0,n.pR)(this._perimeterLengthLabel),this._projectionLines=(0,n.pR)(this._projectionLines),this.set("view",null)}_update(){if(this.destroyed||!this.view.ready||!this.view.renderCoordsHelper)return;const{analysisViewData:{measurementData:e},analysisViewData:t}=this;null!=e&&(this._updateViewData(e,t.path),this._updateOrigin(),this._updatePathSegments(),this._updatePerimeterSegments(),this._updateArea(),this._updateProjectionLines(),this._updateLabels())}_updateViewData(e,t){const i=e.validMeasurement,s="geodesic"===e.actualMeasurementMode,n=s?e.geodesicArea:e.area;let r=1;if(n){const e=ie(n,this.analysisViewData.unit);r=(0,p.Vr)(Math.sqrt(e.value)/Math.sqrt(300)),r*=Math.sqrt((0,g.oU)(1,e.unit,"square-meters")),r=(0,g.oU)(r,"meters",this._renderUnits)}const a={validMeasurement:i,numVertices:e.numVertices,hasStagedVertex:e.hasStagedVertex,path:t,mode:e.actualMeasurementMode,positionsRender:e.positionsRender,positionsFittedWorld:e.positionsFittedWorld,positionsFittedRender:e.positionsFittedRender,intersectingSegments:s?e.geodesicIntersectingSegments:e.intersectingSegments,triangleIndices:s?e.geodesicTriangleIndices:e.triangleIndices,areaCentroid:s?e.geodesicAreaCentroidRenderCoords:e.areaCentroidRenderCoords,perimeterLengthLabelSegmentIndex:0,area:s?e.geodesicArea:e.area,pathLength:s?e.geodesicPathLength:e.pathLength,perimeterLength:e.perimeterLength,checkerSize:r};this._set("viewData",a)}_updateOrigin(){const e=this.viewData;(0,z.ix)(e.positionsRender,this._origin),(0,ee.kN)(this._originTransform,this._origin),this._measurementArea.transform=this._originTransform,this._projectionLines.transform=this._originTransform}_createSegments(e){const t=this.viewData,i=this.view.renderCoordsHelper.spatialReference,s=t.mode,n=[],r=[],a=[],o=t.numVertices,l=t.validMeasurement?o:o-1;for(let u=0;u<l;++u){const l=t[e][u],h=t[e][(u+1)%o];let d=null;switch(s){case"euclidean":d=new Oe.C(l,h);break;case"geodesic":d=new Oe.J(l,h,i)}t.intersectingSegments.has(u)?a.push(d):r.push(d),n.push(d)}let h=null;return t.validMeasurement&&t.hasStagedVertex&&l>=2?h=n[n.length-2]:t.hasStagedVertex&&l>=1&&(h=n[n.length-1]),{all:n,nonIntersecting:r,intersecting:a,stagedSegment:h}}_updatePathSegments(){const{visible:e}=this,t=this._createSegments("positionsRender");this._path.setGeometryFromSegments(t.nonIntersecting,this._origin),this._path.visible=e,this._intersectedPath.setGeometryFromSegments(t.intersecting,this._origin),this._intersectedPath.visible=e,this._pathSegments=t.all}_updatePerimeterSegments(){const e=this.visible&&"euclidean"===this.viewData.mode&&this.viewData.path.numVertices>2,t=this._createSegments("positionsFittedRender");this._perimeter.setGeometryFromSegments(t.nonIntersecting,this._origin),this._perimeter.visible=e,this._intersectedPerimeter.setGeometryFromSegments(t.intersecting,this._origin),this._intersectedPerimeter.visible=e,this._perimeterSegments=t.all}_updateArea(){const e=this.viewData;switch(e.mode){case"euclidean":this._updateAreaEuclidean(e);break;case"geodesic":this._updateAreaGeodesic()}}_updateAreaEuclidean(e){const t=this.visible;e.validMeasurement&&0===e.intersectingSegments.size&&e.triangleIndices?(this._measurementArea.geometry={uv:e.positionsFittedWorld,position:e.positionsFittedRender,triangleIndices:e.triangleIndices},this._measurementArea.size=[e.checkerSize,e.checkerSize],this._measurementArea.visible=t):this._measurementArea.visible=!1}_updateAreaGeodesic(){this._measurementArea.visible=!1}_updateProjectionLines(){const e=this.viewData,t=this.visible,i=e.mode,s=e.numVertices;if(s>0&&e.validMeasurement&&"euclidean"===i){const i=[];for(let t=0;t<s;++t){const s=(0,y.vt)();(0,v.e)(s,e.positionsRender[t],this._origin);const n=(0,y.vt)();(0,v.e)(n,e.positionsFittedRender[t],this._origin),i.push([s,n])}this._projectionLines.geometry=i,this._projectionLines.visible=t}else this._projectionLines.geometry=null,this._projectionLines.visible=!1}_updateLabels(){if(this.destroyed)return;const{viewData:e}=this,{area:t,path:i}=e;if(!i)return;const s=this.visible,n=this._areaLabel,r=this._perimeterLengthLabel,a=e.validMeasurement;n.visible=!0,r.visible=!0;let o=!1;const l=function(e,t,i){return e&&t&&(0,Y.zJ)(e,t,(0,g.cT)(t.value,t.unit,i))}(this.messages,t,this.analysisViewData.unit);if(null!=l&&s&&(n.geometry={type:"point",point:e.areaCentroid},n.text=l,o=e.validMeasurement&&0===e.intersectingSegments.size),this._set("areaLabel",l),s&&a&&0===e.intersectingSegments.size){const t="geodesic"===e.mode,i=t?e.pathLength:e.perimeterLength,s=function(e,t,i){return e&&t&&(0,Y.zJ)(e,t,ne(t,i))}(this.messages,i,this.analysisViewData.unit);this._set("perimeterLengthLabel",s),r.distance=this._parameters.labelDistance,r.anchor="top",r.text=s;let n=!0;for(let a=0;a<e.numVertices;++a){const i=(e.perimeterLengthLabelSegmentIndex+a)%e.numVertices,s=t?this._pathSegments[i]:this._perimeterSegments[i];if(n=!0,r.geometry={type:"segment",segment:s,sampleLocation:"center"},!r.overlaps(this._areaLabel))break;n=!1}r.visible=n}else r.visible=!1;n.visible=o}_updateMessageBundle(){this.loadingMessages=!0,(0,ke.ud)("esri/core/t9n/Units").then(e=>{this.messages=e,this.view&&this._update()}).finally(()=>{this.loadingMessages=!1})}};(0,s.Cg)([(0,r.MZ)()],Te.prototype,"_parameters",null),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"view",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"messages",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"analysis",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"viewData",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"analysisViewData",void 0),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],Te.prototype,"areaLabel",void 0),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],Te.prototype,"perimeterLengthLabel",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"loadingMessages",void 0),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"visible",null),(0,s.Cg)([(0,r.MZ)()],Te.prototype,"_renderUnits",null),Te=(0,s.Cg)([(0,o.$)("esri.views.3d.analysis.AreaMeasurement.support.AreaMeasurementVisualization")],Te);const Ie={validMeasurement:!1,numVertices:0,hasStagedVertex:!1,path:null,mode:null,positionsRender:null,positionsFittedWorld:null,positionsFittedRender:null,intersectingSegments:null,triangleIndices:null,areaCentroid:null,perimeterLengthLabelSegmentIndex:null,checkerSize:null,area:null,pathLength:null,perimeterLength:null};var He=i(56002),We=i(50346),Ee=i(19451),Fe=i(32535),Be=i(70836),Ue=i(7947),qe=i(69539),je=i(88321),Ne=i(76931),Qe=i(56121),Je=i(38317),$e=i(91175);class Ke{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.screenPoint=e,this.result=t}}class Xe{constructor(e,t){this.scenePoint=e,this.mapPoint=t}}var Ye=i(1307),et=i(72017),tt=i(38386),it=i(46576);class st{constructor(e){this.vertexManipulators=[],this._destroyed=!1,this._isManipulatorsOwner=!0,this._visible=!0,this._listenerHandles=null,this._tempHandlePosition=(0,y.vt)();const{analysisViewData:t,manipulators:i,toolState:s,view:n,visible:r}=e;this._analysisViewData=t,this._toolState=s,null!=i?(this._manipulators=i,this._isManipulatorsOwner=!1):this._manipulators=new tt.t,this._view=n,this._intersector=(0,it.T)(n.state.viewingMode);const a=(0,Je.UM)(this._handleColor),o=[new $e.M((0,et.CM)(a,1,32,32))],l=new Qe.q({view:n,renderObjects:o});l.available=!1,l.radius=ot,l.interactive=!1,this._manipulators.add(l),this._cursorManipulator=l,this._cursorManipulatorMaterial=a,this._laserLine=new Ye.o({view:n,attached:!0,style:{glowWidth:nt,glowFalloff:rt,innerWidth:at},isDecoration:!0}),this._updateVisibility(null===r||void 0===r||r)}destroy(){this._listenerHandles=(0,n.pR)(this._listenerHandles),this._isManipulatorsOwner?this._manipulators=(0,n.pR)(this._manipulators):this._manipulators=null,this._laserLine=(0,n.pR)(this._laserLine),this._destroyed=!0}get destroyed(){return this._destroyed}get visible(){return this._visible}set visible(e){e?this.show():this.hide()}get testData(){}show(){this._setVisibility(!0)}hide(){this._setVisibility(!1)}_setVisibility(e){this._destroyed||this._visible===e||this._updateVisibility(e)}_updateVisibility(e){this._visible=e,this._laserLine.visible=e,e?(this._initializeListeners(),this._updateAll()):(this._destroyListeners(),this.vertexManipulators.forEach(e=>{let{manipulator:t}=e;return this._removeVertexManipulator(t)}),this.vertexManipulators=[])}vertexHandleAt(e,t){const i=this._manipulators.intersect(e,t);return null===i||void 0===i?void 0:i.metadata}pick(e){const t=this._view.spatialReference,i=(0,Ne.WA)(e.screenPoint);this._view.sceneIntersectionHelper.intersectToolIntersectorScreen(i,this._intersector);const s=this._intersector.results.min,n=(0,y.vt)();if(!s.getIntersectionPoint(n))return null;const r=this._view.renderCoordsHelper.fromRenderCoords(n,new B.A({spatialReference:t}));return null==r?null:new Xe(n,r)}_updateAll(){this._visible&&(this._updateVertexManipulators(),this._updateLaserLine())}_createVertexManipulator(){const e=(0,Je.UM)(this._handleColor),t=[new $e.M((0,et.CM)(e,1,32,32))],i=new Qe.q({view:this._view,renderObjects:t});return i.radius=ot,this._manipulators.add(i),{manipulator:i,material:e}}_removeVertexManipulator(e){this._manipulators.remove(e)}_updateVertexManipulators(){const{viewData:e}=this._analysisViewData,t=this._analysisViewData.path?this._analysisViewData.path.vertices:[],i=this.vertexManipulators;(function(e,t,i,s){for(;e.length<t;)e.push(i());if(s)for(;e.length>t;)s(e.pop());else e.length=t})(i,t.length,()=>this._createVertexManipulator(),e=>{let{manipulator:t}=e;return this._removeVertexManipulator(t)}),i.forEach((i,s)=>{let{manipulator:n}=i;n.metadata=t[s],n.renderLocation=e.positionsRender[s],n.cursor=0===s&&"drawing"===this._toolState.polygonState?"crosshair":null}),"drawing"===this._toolState.polygonState&&null!=this._analysisViewData.stagedPoint?(this._cursorManipulator.available=!0,this._cursorManipulator.location=this._analysisViewData.stagedPoint):this._cursorManipulator.available=!1}get _handleColor(){return(0,X.f6)(this._view.effectiveTheme.accentColor,.5)}_getFocusPoint(){const{lastDraggedVertex:e}=this._analysisViewData;switch(this._toolState.polygonState){case"drawing":return null!=this._analysisViewData.stagedPoint?this._analysisViewData.stagedPoint:null!=e?this._analysisViewData.path.getVertexPositionAsPoint(e):this._analysisViewData.path.lastPoint;case"editing":return null!=e?this._analysisViewData.path.getVertexPositionAsPoint(e):null;default:return this._analysisViewData.stagedPoint}}_updateLaserLine(){const e="measured"!==this._toolState.polygonState&&this._toolState.active,t=this._getFocusPoint();if(e&&null!=t){const e=this._tempHandlePosition;this._view.renderCoordsHelper.toRenderCoords(t,e),this._laserLine.heightManifoldTarget=e}else this._laserLine.heightManifoldTarget=null}_initializeListeners(){this._listenerHandles=new je.A,this._listenerHandles.add([(0,d.wB)(()=>this._toolState.polygonState,()=>this._updateLaserLine()),(0,d.wB)(()=>this._analysisViewData.viewData,()=>this._updateAll(),d.OH),(0,d.wB)(()=>({lastDraggedVertex:this._analysisViewData.lastDraggedVertex,cursorPoint:this._analysisViewData.stagedPoint}),()=>this._updateLaserLine()),(0,d.wB)(()=>this._toolState.active,()=>this._updateAll()),(0,d.wB)(()=>this._view.effectiveTheme.accentColor,e=>{const t=(0,X.f6)(e,.5);for(const{material:o}of this.vertexManipulators)o.setParameters({color:t});this._cursorManipulatorMaterial.setParameters({color:t});const i=qe.A.toUnitRGB(e),s=qe.A.toUnitRGB((0,X.bJ)(e)),n=.75*e.a,r=this._laserLine,a=r.style;r.style=(0,K.A)((0,K.A)({},a),{},{glowColor:i,innerColor:s,globalAlpha:n})},{initial:!0,equals:X.hw})])}_destroyListeners(){this._listenerHandles=(0,n.pR)(this._listenerHandles)}}const nt=8,rt=8,at=1,ot=5;var lt=i(5109),ht=i(17046),ut=i(82307),dt=i(13284),pt=i(61237),ct=i(75218),gt=i(14318),mt=i(70330),_t=i(11500);let vt=class extends lt.k{constructor(e){super(e),this._updatingHandles=new Ee.U,this._snappingManagerResult=null,this.polygonState="initial",this.removeIncompleteOnCancel=!1,this.manipulators=new tt.t,this._getSnappingContext=(0,He.B)(e=>new dt.e({elevationInfo:{mode:"absolute-height",offset:0},pointer:e,editGeometryOperations:new Q.p(new N.ZE("point",(0,j.BV)(!0,!1,this.view.spatialReference)),this.view.state.viewingMode),visualizer:new Be.s}))}initialize(){const{view:e,analysisViewData:t,manipulators:i,visible:s}=this;this.measurementView=new st({view:e,analysisViewData:t,toolState:this,manipulators:i,visible:s}),this._snappingOperation=new gt.O({view:e}),this._updatingHandles.add(()=>this.stagedPoint,e=>{this.analysisViewData.stagedPoint=null!=e?(0,Fe.EL)(e,new B.A):null},d.pc),(0,mt.BY)(this,()=>{var e,t;const i=null!==(e=null===(t=this.view.inputManager.latestPointerInfo)||void 0===t?void 0:t.type)&&void 0!==e?e:"mouse",s=this._getSnappingContext(i);this._updatingHandles.addPromise((0,We.QZ)(this._snappingOperation.snapAgainNearPreviousMapPoint(this._ensureSnappingManager(),s)))}),this._setupManipulators(),this.addHandles([(0,d.z7)(()=>"measured"===this.state,()=>this.finishToolCreation(),d.pc),this.analysisViewData.path.on("change",()=>{const e=this.analysisViewData.path;"initial"!==this.polygonState||e.isEmptyPolygon||(e.isValidPolygon?this.polygonState="measured":this.polygonState="drawing")})])}destroy(){this.measurementView.destroy(),this._set("measurementView",null),this._updatingHandles=(0,n.pR)(this._updatingHandles)}get _snappingManager(){var e;return null===(e=this._snappingManagerResult)||void 0===e?void 0:e.snappingManager}_ensureSnappingManager(){if(null==this._snappingManagerResult){const e=(0,ct.X)(this.view);this._snappingManagerResult=e,this.addHandles(e)}return this._snappingManagerResult.snappingManager}get state(){return 0===this.analysisViewData.path.numVertices?"ready":this.analysisViewData.path.isValidPolygon&&"editing"!==this.polygonState?"measured":"measuring"}get cursor(){return this.active?"crosshair":null}get updating(){var e;return this._updatingHandles.updating||!(null===(e=this._snappingManager)||void 0===e||!e.updating)}get stagedPoint(){return this._snappingOperation.stagedPoint}set stagedPoint(e){this._snappingOperation.stagedPoint=e}get snappingOptions(){var e;return null===(e=this._snappingManager)||void 0===e?void 0:e.options}finishMeasurement(){const{path:e}=this.analysisViewData;e.numVertices<=2||(e.close(),this.polygonState="measured",this._resetSnappingState(),this.active&&(this.view.activeTool=null))}resetCreated(){super.resetCreated(),this._resetSnappingState(),this.polygonState="initial","measured"===this.state&&(this.polygonState="measured",this.finishToolCreation())}onShow(){this.measurementView.show()}onHide(){this.measurementView.hide()}onDeactivate(){this._resetSnappingState()}onInputEvent(e){switch(e.type){case"immediate-double-click":this._handleImmediateDoubleClick(e);break;case"immediate-click":this._handleImmediateClick(e);break;case"pointer-move":this._handlePointerMove(e);break;case"drag":this._handleDrag(e);break;case"key-down":this._handleKeyDown(e)}}_setupManipulators(){const e=e=>e.events.on("grab-changed",()=>{if(this.analysisViewData.path.isValidPolygon){const e=this.manipulators.some(e=>e.manipulator.grabbing);this.polygonState=e?"editing":"measured"}}),t=t=>{this.addHandles([(0,ht.Xt)(t,(e,t,i,s)=>{const n=(0,Ue.z7)(e),r=e.metadata,a=this._snappingManager,o=this._getSnappingContext(s),l=this._updatingHandles,{snappingStep:h,cancelSnapping:u}=(0,pt.L)({snappingManager:a,snappingContext:o,updatingHandles:l});i=i.next(n).next(t=>(this.analysisViewData.lastDraggedVertex=null,this.analysisViewData.path.setVertexPosition(r,d),e.location=d,t)).next(u),t.next(n).next((0,Ue.xk)(this.view)).next(...h).next(t=>{e.location=t.mapEnd,this.analysisViewData.lastDraggedVertex="end"===t.action?null:r,this.analysisViewData.path.setVertexPosition(r,(0,Fe.EL)(t.mapEnd))});const d=(0,Fe.EL)(this.analysisViewData.path.getVertexPositionAsPoint(r))}),e(t)],t)};this.manipulators.forEach(e=>{let{manipulator:i}=e;t(i)}),this.addHandles([this.manipulators.on("after-add",e=>{let{item:{manipulator:i}}=e;t(i)}),this.manipulators.on("after-remove",e=>{let{item:{manipulator:t}}=e;return this.removeHandles(t)})])}_handleImmediateDoubleClick(e){(0,R.s7)(e)&&("drawing"===this.polygonState&&this.finishMeasurement(),e.stopPropagation())}_handleDrag(e){"editing"===this.polygonState&&e.stopPropagation()}_handleImmediateClick(e){if(!(0,R.s7)(e))return;const t=(0,_t.ZV)(e),{pointerType:i}=e;if(this.active)switch(this.polygonState){case"initial":case"measured":if(this._addVertexAt(t,i))return this.stagedPoint=null,this.polygonState="drawing",void e.stopPropagation();break;case"drawing":{const s=this.measurementView.vertexHandleAt(t,i);if(null==s){if(this._addVertexAt(t,i))return this.stagedPoint=null,void e.stopPropagation()}else 0===s.index&&(this.finishMeasurement(),e.stopPropagation());break}}"mouse"===e.pointerType&&this._hoverAt(t)}_handlePointerMove(e){if("mouse"===e.pointerType){const t=(0,_t.ZV)(e);this._hoverAt(t)}}_handleKeyDown(e){const{path:t}=this.analysisViewData;e.key===ut.NE.complete&&"drawing"===this.polygonState&&t.numVertices>=3&&(this.stagedPoint=null,this.finishMeasurement(),e.stopPropagation())}_hoverAt(e){const{polygonState:t}=this;if(this.active&&yt.has(t)){const t=this._pick(e);if(null!=(null===t||void 0===t?void 0:t.mapPoint)){const e=this._getSnappingContext("mouse");this._updatingHandles.addPromise((0,We.QZ)(this._snappingOperation.snap({point:t.mapPoint},this._ensureSnappingManager(),e)))}}else this.stagedPoint=null}_addVertexAt(e,t){const i=this._pick(e),s=null===i||void 0===i?void 0:i.mapPoint;if(null==s)return!1;this.analysis.valid&&"measured"===this.polygonState&&(this.analysis.clear(),this._set("created",!1),this.polygonState="initial");const n=this._getSnappingContext(t),r=this._snappingOperation.update({point:s},this._ensureSnappingManager(),n),a=(0,Fe.EL)(r,new B.A);return this.analysisViewData.path.add(a),!0}_pick(e){const t=new Ke(e);return this.measurementView.pick(t)}_resetSnappingState(){this._ensureSnappingManager().doneSnapping(),this._snappingOperation.abort(),this._snappingOperation.stagedPoint=null}get test(){}};(0,s.Cg)([(0,r.MZ)()],vt.prototype,"_snappingManagerResult",void 0),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"_snappingManager",null),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],vt.prototype,"state",null),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"polygonState",void 0),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],vt.prototype,"cursor",null),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"measurementView",void 0),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"removeIncompleteOnCancel",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],vt.prototype,"view",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],vt.prototype,"analysis",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0})],vt.prototype,"analysisViewData",void 0),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],vt.prototype,"manipulators",void 0),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"updating",null),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"stagedPoint",null),(0,s.Cg)([(0,r.MZ)()],vt.prototype,"snappingOptions",null),vt=(0,s.Cg)([(0,o.$)("esri.views.3d.interactive.measurementTools.areaMeasurement3D.AreaMeasurement3DTool")],vt);const yt=new Set(["initial","drawing","measured"]);var ft=i(10260),xt=i(66678),wt=i(23739);let Mt=class extends h.P{constructor(e){super(e),this.type="area-measurement-view-3d",this.analysis=null,this.measurementData=null,this.lastDraggedVertex=null,this.stagedPoint=null,this.mode=0,this.tool=null,this.userOperation=null}initialize(){const{analysis:e,view:t}=this;this.path=new J({view:t,areaMeasurement:e}),this._analysisVisualization=new Te({view:t,analysis:e,analysisViewData:this}),this.addResolvingPromise(Promise.all([(0,xt.c)(),(0,wt.V)()]).then(i=>{let[s,n]=i;this.destroyed||(this._analysisController=new E({view:t,analysis:e,analysisViewData:this,geodesicAreaMeasurementUtils:s,geodesicLengthMeasurementUtils:n}))})),this.addHandles((0,ft.Hd)(this,vt))}destroy(){(0,ft.aS)(this),this.userOperation=(0,n.DC)(this.userOperation),this._analysisController=(0,n.pR)(this._analysisController),this._analysisVisualization=(0,n.pR)(this._analysisVisualization),this.path.destroy()}get visible(){return super.visible}set visible(e){super.visible=e}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get updating(){var e;return!(null===(e=this._analysisVisualization)||void 0===e||!e.loadingMessages)}get result(){const{measurementData:e}=this;if(null==e)return{area:null,mode:null,perimeter:null};const{unit:t}=this;if("euclidean"===e.actualMeasurementMode){const{area:i,perimeterLength:s}=e;return{area:null!=i?ie(i,t):null,perimeter:null!=s?se(s,t):null,mode:"euclidean"}}const{geodesicArea:i,pathLength:s}=e;return{area:null!=i?ie(i,t):null,perimeter:null!=s?se(s,t):null,mode:"geodesic"}}get viewData(){return this._analysisVisualization.viewData}get areaLabel(){return this._analysisVisualization.areaLabel}get perimeterLengthLabel(){return this._analysisVisualization.perimeterLengthLabel}get validMeasurement(){return this.path.isValidPolygon}get unit(){var e;return null!==(e=this.analysis.unit)&&void 0!==e?e:(0,l.c)(this.view)}get testData(){}place(e){return(0,ft.ZX)(this,{placementOptions:e})}};(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"_analysisVisualization",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"_analysisController",void 0),(0,s.Cg)([(0,r.MZ)({readOnly:!0})],Mt.prototype,"type",void 0),(0,s.Cg)([(0,r.MZ)({constructOnly:!0,nonNullable:!0})],Mt.prototype,"analysis",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"updating",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"result",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"measurementData",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"viewData",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"areaLabel",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"perimeterLengthLabel",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"validMeasurement",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"path",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"lastDraggedVertex",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"stagedPoint",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"mode",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"unit",null),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"tool",void 0),(0,s.Cg)([(0,r.MZ)()],Mt.prototype,"userOperation",void 0),Mt=(0,s.Cg)([(0,o.$)("esri.views.3d.analysis.AreaMeasurementAnalysisView3D")],Mt);const Ct=Mt}}]);
//# sourceMappingURL=94089.6b3d5896.chunk.js.map