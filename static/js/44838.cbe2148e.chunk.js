"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[44838],{10231:(e,t,i)=>{i.d(t,{i:()=>s});class s{constructor(e,t,i,s){this.toMapSpace=e,this.transform=t,this.obb=i,this.geometry=s}}},11941:(e,t,i)=>{var s,n;i.d(t,{D:()=>n,f:()=>s}),function(e){e[e.None=0]="None",e[e.Int16=1]="Int16",e[e.Int32=2]="Int32"}(s||(s={})),function(e){e[e.Replace=0]="Replace",e[e.Outside=1]="Outside",e[e.Inside=2]="Inside",e[e.Finished=3]="Finished"}(n||(n={}))},14303:(e,t,i)=>{i.d(t,{A:()=>v});var s,n=i(35143),r=i(42553),o=i(53084),a=i(62754),l=i(46053),u=(i(81806),i(76460),i(85842)),p=i(17707),d=i(37546),c=i(65215),h=i(9956);let v=s=class extends r.A{constructor(e){super(e),this.geometry=null,this.type="clip"}writeGeometry(e,t,i,s){var n;if(null!==(n=s.layer)&&void 0!==n&&n.spatialReference&&!s.layer.spatialReference.equals(this.geometry.spatialReference)){if(!(0,h.canProjectWithoutEngine)(e.spatialReference,s.layer.spatialReference))return void((null===s||void 0===s?void 0:s.messages)&&s.messages.push(new a.A("scenemodification:unsupported","Scene modifications with incompatible spatial references are not supported",{modification:this,spatialReference:s.layer.spatialReference,context:s})));const n=new c.A;(0,h.projectPolygon)(e,n,s.layer.spatialReference),t[i]=n.toJSON(s)}else t[i]=e.toJSON(s);delete t[i].spatialReference}clone(){return new s({geometry:(0,o.o8)(this.geometry),type:this.type})}};(0,n._)([(0,l.MZ)({type:c.A}),(0,d.P)()],v.prototype,"geometry",void 0),(0,n._)([(0,p.K)(["web-scene","portal-item"],"geometry")],v.prototype,"writeGeometry",null),(0,n._)([(0,l.MZ)({type:["clip","mask","replace"],nonNullable:!0}),(0,d.P)()],v.prototype,"type",void 0),v=s=(0,n._)([(0,u.$)("esri.layers.support.SceneModification")],v)},21479:(e,t,i)=>{i.d(t,{f:()=>a});var s=i(20664),n=i(482),r=i(14556),o=i(80963);function a(e,t,i,a){const l=(0,n.Tp)(t,a);if(null==l)return!1;const u=l.source.spatialReferenceId,p=l.dest.spatialReferenceId;if(u===p&&u!==n.rz.UNKNOWN||(0,o.aI)(t,a))return i[0]=1,i[1]=1,i[2]=1,!0;if(u===n.rz.SPHERICAL_ECEF){const t=(0,s.l)(e),o=t/Math.sqrt(e[0]*e[0]+e[1]*e[1]),a=t/r.$O.radius;if(p===n.rz.WEB_MERCATOR)return i[0]=o*a,i[1]=o*a,i[2]=1,!0;if(p===n.rz.WGS84||p===n.rz.CGCS2000){const e=n.iE;return i[0]=e*o*a,i[1]=e*a,i[2]=1,!0}}else if(u===n.rz.PLATE_CARREE){if(p===n.rz.WGS84||p===n.rz.CGCS2000)return i[0]=n.iE,i[1]=n.iE,i[2]=1,!0;if(p===n.rz.WEB_MERCATOR){const t=e[1]/r.$O.radius;return i[0]=1,i[1]=1/Math.cos(t),i[2]=1,!0}}return!1}},35493:(e,t,i)=>{i.d(t,{e:()=>E});var s=i(35143),n=i(91967),r=i(54099),o=i(76460),a=i(46053),l=(i(81806),i(47249),i(85842)),u=i(34761),p=i(13191),d=i(20664),c=i(9392),h=i(79115),v=i(2413),y=i(78315),f=i(95225),g=i(15255),m=i(29808),_=i(3112);let E=class extends(r.A.EventedMixin(n.A)){constructor(e){super(e),this._tmpEvent=new g.L,this._renderCoordsHelper=e.view.renderCoordsHelper,this._renderSR=this._renderCoordsHelper.spatialReference,this._layerElevationSource=e.layerElevationSource}initialize(){this._intersector=new m.n(this.view.state.viewingMode),this._intersector.options.store=_.o.MIN,this._intersector.options.normalRequired=!1,this._tmpEvent.context=this.intersectionHandler.isGround?"ground":"scene"}get spatialReference(){var e;return null===(e=this.view)||void 0===e||null===(e=e.elevationProvider)||void 0===e?void 0:e.spatialReference}getElevation(e,t,i,s){const n=this._renderCoordsHelper,r=(0,d.i)(M,e,t,i);if(!n.toRenderCoords(r,s,r))return o.A.getLogger(this).error("could not project point to compute elevation"),null;const{layerElevationSource:a,_intersector:l,intersectionHandler:u}=this,p=a.fullExtent,c=null!=p&&Number.isFinite(p.xmin)&&Number.isFinite(p.xmax)&&Number.isFinite(p.ymin)&&Number.isFinite(p.ymax)&&Number.isFinite(p.zmin)&&Number.isFinite(p.zmax)?new f.H(p.zmin,p.zmax):a.elevationRange;if(null==c)return null;const h=a.elevationOffset,v=c.elevationRangeMin+h,y=c.elevationRangeMax+h,g=n.setAltitude(x,y,r),m=n.setAltitude(w,v,r);return l.reset(g,m,this.view.state.camera),u.intersect(l,null,g,m,null,!0),l.results.min.getIntersectionPoint(r)?n.getAltitude(r):null}getSphereElevationBounds(e,t){return(0,h.z)(e,t,b,this._renderSR),this._layerElevationSource.getElevationRange(b)}getRootElevationBounds(){const e=this.layerElevationSource.fullExtent;return null!==e&&void 0!==e&&e.hasZ?new f.H(e.zmin,e.zmax):null}objectsChanged(e){this.spatialReference&&(this._computeLayerExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit("elevation-change",this._tmpEvent))}objectChanged(e){this.spatialReference&&(this._computeObjectExtent(e,this._tmpEvent.extent),this._tmpEvent.spatialReference=this.spatialReference,this.emit("elevation-change",this._tmpEvent))}_computeObjectExtent(e,t){(0,v.Ie)(t),this._expandExtent(e,t)}_computeLayerExtent(e,t){(0,v.Ie)(t);for(const i of e)this._expandExtent(i,t)}_expandExtent(e,t){const i=this.spatialReference;if(null==i)return;if(null==e)return;(0,u.I0)(R,e.quaternion),R[12]=e.center[0],R[13]=e.center[1],R[14]=e.center[2];const s=e.halfSize;for(let n=0;n<8;++n)M[0]=1&n?s[0]:-s[0],M[1]=2&n?s[1]:-s[1],M[2]=4&n?s[2]:-s[2],(0,d.t)(M,M,R),this._renderCoordsHelper.fromRenderCoords(M,M,i),(0,v.fT)(t,M,t)}};(0,s._)([(0,a.MZ)({constructOnly:!0})],E.prototype,"layerElevationSource",void 0),(0,s._)([(0,a.MZ)({constructOnly:!0})],E.prototype,"intersectionHandler",void 0),(0,s._)([(0,a.MZ)({constructOnly:!0})],E.prototype,"view",void 0),(0,s._)([(0,a.MZ)()],E.prototype,"spatialReference",null),E=(0,s._)([(0,l.$)("esri.views.3d.layers.i3s.LayerElevationProvider")],E);const R=(0,p.vt)(),b=(0,y.f)(0,0,0,0),M=(0,c.vt)(),x=(0,c.vt)(),w=(0,c.vt)()},55002:(e,t,i)=>{i.d(t,{d:()=>s});class s{constructor(e,t){this.position=e,this.rotationScale=t,this.origin=void 0}}},83491:(e,t,i)=>{i.d(t,{w:()=>p});var s=i(35143),n=i(54901),r=i(50346),o=i(68134),a=i(46053),l=(i(81806),i(76460),i(47249),i(85842)),u=i(47700);const p=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,u.jI)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,n.hA)(()=>e.abort())),await(0,o.C_)(()=>{var e;return null===(e=this.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady},t),(0,r.Te)(t);const i=(0,u.Hu)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}};return(0,s._)([(0,a.MZ)()],t.prototype,"view",void 0),(0,s._)([(0,a.MZ)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,s._)([(0,l.$)("esri.views.3d.layers.LayerView3D")],t),t}},91196:(e,t,i)=>{i.d(t,{A:()=>v});var s=i(35143),n=i(91967),r=i(54099),o=i(5632),a=i(76460),l=i(30726),u=i(91291),p=i(46053),d=(i(81806),i(47249),i(85842)),c=i(19451),h=i(90992);let v=class extends(o.A.IdentifiableMixin(u.A.EsriPromiseMixin(r.A.EventedMixin(n.A)))){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new c.U,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){var t;const i=this.layer&&this.layer.id||"no id",s=(null===(t=this.layer)||void 0===t?void 0:t.title)||"no title";a.A.getLogger(this).error("#resolve()","Failed to resolve layer view (layer title: '".concat(s,"', id: '").concat(i,"')"),e)}})}destroy(){this._updatingHandles=(0,l.pR)(this._updatingHandles)}get fullOpacity(){var e,t,i,s;return(null!==(e=null===(t=this.layer)||void 0===t?void 0:t.opacity)&&void 0!==e?e:1)*(null!==(i=null===(s=this.parent)||void 0===s?void 0:s.fullOpacity)&&void 0!==i?i:1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}get updating(){var e;return!((null===(e=this._updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){var e;const t=this.view.timeExtent,i=null===(e=this.layer)||void 0===e?void 0:e.visibilityTimeExtent;return!t||!i||!t.intersection(i).isEmpty}canResume(){var e,t;const i=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&this.parent&&!this.parent.suspended&&(null===(t=this.view)||void 0===t?void 0:t.ready)&&(0,h.g7)(i)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){var e,t;const i=null!==(e=this.parent)&&void 0!==e&&e.suspended?this.parent.suspendInfo:{};null!==(t=this.view)&&void 0!==t&&t.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0);const s=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,h.g7)(s)&&this.visibleAtCurrentScale||(i.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(i.outsideVisibilityTimeExtent=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"spatialReferenceSupported",null),(0,s._)([(0,p.MZ)()],v.prototype,"view",void 0),(0,s._)([(0,p.MZ)()],v.prototype,"fullOpacity",null),(0,s._)([(0,p.MZ)()],v.prototype,"layer",void 0),(0,s._)([(0,p.MZ)()],v.prototype,"parent",void 0),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"suspended",null),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"suspendInfo",null),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"legendEnabled",null),(0,s._)([(0,p.MZ)({type:Boolean,readOnly:!0})],v.prototype,"updating",null),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"updatingProgress",null),(0,s._)([(0,p.MZ)()],v.prototype,"updateSuspended",null),(0,s._)([(0,p.MZ)()],v.prototype,"visible",null),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"visibleAtCurrentScale",null),(0,s._)([(0,p.MZ)({readOnly:!0})],v.prototype,"visibleAtCurrentTimeExtent",null),v=(0,s._)([(0,d.$)("esri.views.layers.LayerView")],v)},97048:(e,t,i)=>{i.d(t,{Ir:()=>y,_b:()=>p,sQ:()=>d,xb:()=>c});var s=i(76460),n=i(68930),r=i(9392),o=i(12016),a=i(9956),l=i(14487),u=i(11941);class p{constructor(e,t,i,s,n,r){this.layout=e,this.interleavedVertexData=t,this.indices=i,this.hasColors=s,this.hasModifications=n,this.positionData=r}}class d{constructor(e,t,i,s,n,r,o){this.componentOffsets=e,this.featureIds=t,this.anchorIds=i,this.anchors=s,this.transformedGeometry=n,this.globalTrafo=r,this.obb=o}}class c extends o.B{constructor(e){super("SceneLayerWorker","process",{process:e=>[e.geometryBuffer],project:e=>[e.positions.buffer],transformNormals:e=>[e.normals.buffer]},e,{hasInitialize:!0})}setModifications(e,t,i,s){const n={context:e,modifications:y(t,i,s),isGeodetic:s.isGeographic};this.broadcast(n,"setModifications")}setLegacySchema(e,t){const i=JSON.stringify(t);return this.broadcast({context:e,jsonSchema:i},"setLegacySchema")}destroyContext(e){return this.broadcast(e,"destroyContext")}project(e,t){return this.invokeMethod("project",e,t)}transformNormals(e,t){return this.invokeMethod("transformNormals",e,t)}}const h=new n.A({deallocator:null}),v=(0,r.vt)();function y(e,t,i){h.clear();let n=1/0,r=1/0,o=-1/0,p=-1/0,d=!1;for(const y of t){const e="clip"===y.type?u.D.Inside:"mask"===y.type?u.D.Outside:u.D.Replace,t=y.geometry;let c=e=>e;if(t.spatialReference){if(!(0,a.canProjectWithoutEngine)(t.spatialReference,i)){s.A.getLogger("esri.views.3d.layers.I3SMeshWorkerHandle").warn("Can't project modification polygon into layer spatial reference, ignoring modification");continue}c=e=>((0,l.F)(e,t.spatialReference,v,i),v)}else t.hasZ||(v[2]=0,c=e=>(v[0]=e[0],v[1]=e[1],v));d=d||e===u.D.Outside,h.push(e),h.push(t.rings.length);for(const i of t.rings){h.push(i.length);for(const e of i){const t=c(e);h.push(t[0]),h.push(t[1]),h.push(t[2]),n=Math.min(n,t[0]),r=Math.min(r,t[1]),o=Math.max(o,t[0]),p=Math.max(p,t[1])}}}if(null!=e)if(d){const t=1e-4;h.push(u.D.Inside),h.push(2),h.push(4),h.push(n-t),h.push(r-t),h.push(0),h.push(o+t),h.push(r-t),h.push(0),h.push(o+t),h.push(p+t),h.push(0),h.push(n-t),h.push(p+t),h.push(0),h.push(4),h.push(e[0]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[3]),h.push(0),h.push(e[0]),h.push(e[3]),h.push(0)}else h.push(u.D.Outside),h.push(1),h.push(4),h.push(e[0]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[1]),h.push(0),h.push(e[2]),h.push(e[3]),h.push(0),h.push(e[0]),h.push(e[3]),h.push(0);h.push(u.D.Finished);const c=new Float64Array(h.length);for(let s=0;s<h.length;++s)c[s]=h.at(s);return c}}}]);
//# sourceMappingURL=44838.cbe2148e.chunk.js.map