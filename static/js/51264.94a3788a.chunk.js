"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[2259,51264,96141],{2259:(t,e,n)=>{n.d(e,{o6:()=>C,extractComponentsEdgeLocationsLayout:()=>B,hx:()=>x,Jb:()=>L});var o=n(77176);function i(t,e,n){const o=e/3,i=new Uint32Array(n+1),s=new Uint32Array(n+1),r=(t,e)=>{t<e?i[t+1]++:s[e+1]++};for(let v=0;v<o;v++){const e=t[3*v],n=t[3*v+1],o=t[3*v+2];r(e,n),r(n,o),r(o,e)}let c=0,a=0;for(let v=0;v<n;v++){const t=i[v+1],e=s[v+1];i[v+1]=c,s[v+1]=a,c+=t,a+=e}const u=new Uint32Array(6*o),d=i[n],f=(t,e,n)=>{if(t<e){const o=i[t+1]++;u[2*o]=e,u[2*o+1]=n}else{const o=s[e+1]++;u[2*d+2*o]=t,u[2*d+2*o+1]=n}};for(let v=0;v<o;v++){const e=t[3*v],n=t[3*v+1],o=t[3*v+2];f(e,n,v),f(n,o,v),f(o,e,v)}const l=(t,e)=>{const n=2*t,o=e-t;for(let i=1;i<o;i++){const t=u[n+2*i],e=u[n+2*i+1];let o=i-1;for(;o>=0&&u[n+2*o]>t;o--)u[n+2*o+2]=u[n+2*o],u[n+2*o+3]=u[n+2*o+1];u[n+2*o+2]=t,u[n+2*o+3]=e}};for(let v=0;v<n;v++)l(i[v],i[v+1]),l(d+s[v],d+s[v+1]);const p=new Int32Array(3*o),h=(e,n)=>e===t[3*n]?0:e===t[3*n+1]?1:e===t[3*n+2]?2:-1,g=(t,e)=>{const n=h(t,e);p[3*e+n]=-1},m=(t,e,n,o)=>{const i=h(t,e);p[3*e+i]=o;const s=h(n,o);p[3*o+s]=e};for(let v=0;v<n;v++){let t=i[v];const e=i[v+1];let n=s[v];const o=s[v+1];for(;t<e&&n<o;){const e=u[2*t],o=u[2*d+2*n];e===o?(m(v,u[2*t+1],o,u[2*d+2*n+1]),t++,n++):e<o?(g(v,u[2*t+1]),t++):(g(o,u[2*d+2*n+1]),n++)}for(;t<e;)g(v,u[2*t+1]),t++;for(;n<o;)g(u[2*d+2*n],u[2*d+2*n+1]),n++}return p}var s=n(48549),r=n(96141),c=n(47249),a=n(20664),u=n(9392),d=n(25672);class f{updateSettings(t){this.settings=t,this._edgeHashFunction=t.reducedPrecision?m:g}write(t,e,n){y.seed=this._edgeHashFunction(n);const o=y.getIntRange(0,255),i=y.getIntRange(0,this.settings.variants-1),s=y.getFloat(),r=255*(.5*function(t,e){return Math.abs(t)**e*Math.sign(t)}(-(1-Math.min(s/.7,1))+Math.max(0,s-.7)/(1-.7),1.2)+.5);t.position0.setVec(e,n.position0),t.position1.setVec(e,n.position1),t.componentIndex.set(e,n.componentIndex),t.variantOffset.set(e,o),t.variantStroke.set(e,i),t.variantExtension.set(e,r)}}const l=new Float32Array(6),p=new Uint32Array(l.buffer),h=new Uint32Array(1);function g(t){return l[0]=t.position0[0],l[1]=t.position0[1],l[2]=t.position0[2],l[3]=t.position1[0],l[4]=t.position1[1],l[5]=t.position1[2],h[0]=31*(31*(31*(31*(31*(166811+p[0])+p[1])+p[2])+p[3])+p[4])+p[5],h[0]}function m(t){const e=l;e[0]=_(t.position0[0]),e[1]=_(t.position0[1]),e[2]=_(t.position0[2]),e[3]=_(t.position1[0]),e[4]=_(t.position1[1]),e[5]=_(t.position1[2]),h[0]=5381;for(let n=0;n<p.length;n++)h[0]=31*h[0]+p[n];return h[0]}const v=1e4;function _(t){return Math.round(t*v)/v}const w=(0,u.vt)(),y=new c.A;var b=n(7150);function C(t){const e=x(t.data,t.skipDeduplicate,t.indices,t.indicesLength);return S.updateSettings(t.writerSettings),A.updateSettings(t.writerSettings),(0,b.K)(e,S,A)}function x(t,e,n,s){if(e){const e=i(n,s,t.count);return new I(n,s,e,t)}const c=(0,o.b)(t.buffer,t.stride/4,{originalIndices:n}),a=i(c.indices,s,c.uniqueCount);return{faces:c.indices,facesLength:c.indices.length,neighbors:a,vertices:r.EdgeInputBufferLayout.createView(c.buffer)}}class I{constructor(t,e,n,o){this.faces=t,this.facesLength=e,this.neighbors=n,this.vertices=o}}const S=new class{constructor(){this._commonWriter=new f}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return r.gr.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n),(0,a.g)(w,n.faceNormal0,n.faceNormal1),(0,a.n)(w,w);const{typedBuffer:o,typedBufferStride:i}=t.normalCompressed;(0,d.aT)(o,e,w[0],w[1],w[2],i)}},A=new class{constructor(){this._commonWriter=new f}updateSettings(t){this._commonWriter.updateSettings(t)}allocate(t){return r.In.createBuffer(t)}write(t,e,n){this._commonWriter.write(t,e,n);{const{typedBuffer:o,typedBufferStride:i}=t.normalCompressed;(0,d.aT)(o,e,n.faceNormal0[0],n.faceNormal0[1],n.faceNormal0[2],i)}{const{typedBuffer:o,typedBufferStride:i}=t.normal2Compressed;(0,d.aT)(o,e,n.faceNormal1[0],n.faceNormal1[1],n.faceNormal1[2],i)}}},L=(0,s.BP)().vec3f("position0").vec3f("position1"),B=(0,s.BP)().vec3f("position0").vec3f("position1").u16("componentIndex")},51264:(t,e,n)=>{n.r(e),n.d(e,{default:()=>g});var o=n(6326),i=n(50346),s=(n(76460),n(81806),n(47249),n(50076),n(87990)),r=n(20664),c=n(9392),a=n(44230),u=n(78315),d=n(94536),f=n(2259);function l(t,e,n){const o=p;(0,r.h)(o,t,.5),(0,r.c)(o,o,e,.5);const i=(0,r.k)(o,t);return(0,r.g)(o,o,n),(0,u.j)(o,i)}const p=(0,c.vt)();let h=class{constructor(){this._idToComponent=new Map,this._components=new d.x(t=>t.bounds),this._edges=new d.x(t=>t.bounds),this._tmpLineSegment=(0,a.vt)(),this._tmpP1=(0,c.vt)(),this._tmpP2=(0,c.vt)(),this._tmpP3=(0,c.vt)(),this.remoteClient=null}async fetchCandidates(t,e){await Promise.resolve(),(0,i.Te)(e),await this._ensureEdgeLocations(t,e);const n=[];return this._edges.forEachNeighbor(e=>(this._addCandidates(t,e,n),n.length<1e3),t.bounds),{result:{candidates:n}}}async _ensureEdgeLocations(t,e){const n=[];if(this._components.forEachNeighbor(t=>{if(null==t.info){const{id:e,uid:o}=t;n.push({id:e,uid:o})}return!0},t.bounds),!n.length)return;const o={components:n},i=await this.remoteClient.invoke("fetchAllEdgeLocations",o,null!==e&&void 0!==e?e:{});for(const s of i.components)this._setFetchEdgeLocations(s)}async add(t){const e=new v(t.id,t.bounds);return this._idToComponent.set(e.id,e),this._components.add([e]),{result:{}}}async remove(t){const e=this._idToComponent.get(t.id);if(e){const t=[];this._edges.forEachNeighbor(n=>(n.component===e&&t.push(n),!0),e.bounds),this._edges.remove(t),this._components.remove([e]),this._idToComponent.delete(e.id)}return{result:{}}}_setFetchEdgeLocations(t){const e=this._idToComponent.get(t.id);if(null==e||t.uid!==e.uid)return;const n=f.extractComponentsEdgeLocationsLayout.createView(t.locations),o=new Array(n.count),i=(0,c.vt)(),s=(0,c.vt)();for(let c=0;c<n.count;c++){n.position0.getVec(c,i),n.position1.getVec(c,s);const r=l(i,s,t.origin),a=new _(e,c,r);o[c]=a}this._edges.add(o);const{objectIds:r,origin:a}=t;e.info={locations:n,objectIds:r,origin:a}}_addCandidates(t,e,n){const{info:o}=e.component,{origin:i,objectIds:s}=o,c=o.locations,a=c.position0.getVec(e.index,this._tmpP1),u=c.position1.getVec(e.index,this._tmpP2);(0,r.g)(a,a,i),(0,r.g)(u,u,i);const d=s[c.componentIndex.get(e.index)];this._addEdgeCandidate(t,d,a,u,n),m(t,d,a,n),m(t,d,u,n)}_addEdgeCandidate(t,e,n,o,i){if(!t.returnEdge)return;const s=(0,u.n)(t.bounds,w),d=(0,a.Cr)(n,o,this._tmpLineSegment),f=(0,a._I)(d,s,this._tmpP3);(0,u.B)(t.bounds,f)&&i.push({type:"edge",objectId:e,target:(0,c.o8)(f),distance:(0,r.k)(s,f),start:(0,c.o8)(n),end:(0,c.o8)(o)})}};h=(0,o.Cg)([(0,s.$)("esri.views.interactive.snapping.featureSources.sceneLayerSource.SceneLayerSnappingSourceWorker")],h);const g=h;function m(t,e,n,o){t.returnVertex&&(0,u.B)(t.bounds,n)&&o.push({type:"vertex",objectId:e,target:(0,c.o8)(n),distance:(0,r.k)((0,u.a)(t.bounds),n)})}class v{constructor(t,e){this.id=t,this.bounds=e,this.info=null,this.uid=++v.uid}}v.uid=0;class _{constructor(t,e,n){this.component=t,this.index=e,this.bounds=n}}const w=(0,c.vt)()},77176:(t,e,n)=>{n.d(e,{b:()=>s});var o=n(15941),i=n(38496);function s(t,e,n){var s;const d=Array.isArray(t),f=d?t.length/e:t.byteLength/(4*e),l=d?t:new Uint32Array(t,0,f*e),p=null!==(s=null===n||void 0===n?void 0:n.minReduction)&&void 0!==s?s:0,h=(null===n||void 0===n?void 0:n.originalIndices)||null,g=h?h.length:0,m=(null===n||void 0===n?void 0:n.componentOffsets)||null;let v=0;if(m)for(let o=0;o<m.length-1;o++){const t=m[o+1]-m[o];t>v&&(v=t)}else v=f;const _=Math.floor(1.1*v)+1;(null==u||u.length<2*_)&&(u=new Uint32Array((0,o.cU)(2*_)));for(let o=0;o<2*_;o++)u[o]=0;let w=0;const y=!!m&&!!h,b=y?g:f;let C=(0,i.my)(f);const x=new Uint32Array(g),I=1.96;let S=0!==p?Math.ceil(4*I*I/(p*p)*p*(1-p)):b,A=1,L=m?m[1]:b;for(let o=0;o<b;o++){if(o===S){const t=1-w/o;if(t+I*Math.sqrt(t*(1-t)/o)<p)return null;S*=2}if(o===L){for(let t=0;t<2*_;t++)u[t]=0;if(h)for(let t=m[A-1];t<m[A];t++)x[t]=C[h[t]];L=m[++A]}const t=y?h[o]:o,n=t*e,i=a(l,n,e);let s=i%_,c=w;for(;0!==u[2*s+1];){if(u[2*s]===i){const t=u[2*s+1]-1;if(r(l,n,t*e,e)){c=C[t];break}}s++,s>=_&&(s-=_)}c===w&&(u[2*s]=i,u[2*s+1]=t+1,w++),C[t]=c}if(0!==p&&1-w/f<p)return null;if(y){for(let t=m[A-1];t<x.length;t++)x[t]=C[h[t]];C=(0,i.uW)(x)}const B=d?new Array(w):new Uint32Array(w*e);w=0;for(let o=0;o<b;o++)C[o]===w&&(c(l,(y?h[o]:o)*e,B,w*e,e),w++);if(h&&!y){const t=new Uint32Array(g);for(let e=0;e<t.length;e++)t[e]=C[h[e]];C=(0,i.uW)(t)}return{buffer:Array.isArray(B)?B:B.buffer,indices:C,uniqueCount:w}}function r(t,e,n,o){for(let i=0;i<o;i++)if(t[e+i]!==t[n+i])return!1;return!0}function c(t,e,n,o,i){for(let s=0;s<i;s++)n[o+s]=t[e+s]}function a(t,e,n){let o=0;for(let i=0;i<n;i++)o=t[e+i]+o|0,o=o+(o<<11)+(o>>>2)|0;return o>>>0}let u=null},96141:(t,e,n)=>{n.d(e,{EdgeInputBufferLayout:()=>r,In:()=>d,g6:()=>p,gr:()=>u,kU:()=>h,lX:()=>f,pz:()=>l,vJ:()=>c,wO:()=>a});var o=n(57481),i=n(48549),s=n(75757);const r=(0,i.BP)().vec3f("position").u16("componentIndex").freeze(),c=(0,i.BP)().vec2u8("sideness").freeze(),a=(0,o.U)(c),u=(0,i.BP)().vec3f("position0").vec3f("position1").vec2i16("normalCompressed").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).freeze(),d=(0,i.BP)().vec3f("position0").vec3f("position1").vec2i16("normalCompressed").vec2i16("normal2Compressed").u16("componentIndex").u8("variantOffset",{glNormalized:!0}).u8("variantStroke").u8("variantExtension",{glNormalized:!0}).freeze(),f=(0,o.U)(u,1),l=(0,o.U)(d,1),p=(0,s._u)([a,f]),h=(0,s._u)([a,l])}}]);
//# sourceMappingURL=51264.94a3788a.chunk.js.map