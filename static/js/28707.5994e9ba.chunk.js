"use strict";(self.webpackChunksc_utility=self.webpackChunksc_utility||[]).push([[28707],{10857:(e,t,i)=>{i.d(t,{d:()=>m});var r=i(89379),n=i(6326),s=i(91967),l=i(46053),a=(i(81806),i(76460),i(47249),i(87990)),o=i(76797),u=i(31608),d=i(12034),h=i(1900),p=i(80424),c=i(77725),g=i(68295),y=i(14387),v=i(97255);class f{constructor(e){this._cache=e.newCache("QueryEngine",null,-1)}clear(){this._cache.clear()}destroy(){this._cache.destroy()}get(e){var t;return null===(t=this._cache.get(e))||void 0===t?void 0:t.items}put(e,t){this._cache.put(e,new C(t))}get test(){}}class C{constructor(e){this.items=e}get usedMemory(){return this.items.reduce((e,t)=>e+t.usedMemory,v.ez+v.qK)}}const _=d.do;let m=class extends s.A{constructor(e){super(e),this._dataQueryEngineInstance=null}destroy(){this.clear()}get layer(){return this.context.layer}get spatialReference(){return this.context.spatialReference}get _queryGeometryType(){switch(this.layer.geometryType){case"multipoint":case"point":case"polygon":case"polyline":return this.layer.geometryType;case"mesh":return"polygon";default:return}}get defaultQueryJSON(){return new g.A({outSpatialReference:this.spatialReference}).toJSON()}clear(){return!!this._dataQueryEngineInstance&&(this._dataQueryEngineInstance.destroy(),this._dataQueryEngineInstance=null,!0)}async executeQueryForIdSet(e,t,i){return this._dataQueryEngine.executeQueryForIdSet(this._ensureQueryJSON(e,t),i)}async executeQueryForCount(e,t){return this._dataQueryEngine.executeQueryForCount(this._ensureQueryJSON(e),t)}async executeQueryForExtent(e,t){const{count:i,extent:r}=await this._dataQueryEngine.executeQueryForExtent(this._ensureQueryJSON(e),t);return{count:i,extent:o.A.fromJSON(r)}}async executeQueryForIds(e,t){return this._dataQueryEngine.executeQueryForIds(this._ensureQueryJSON(e),t)}async executeQueryForLatestObservations(e,t){const i=await this._dataQueryEngine.executeQueryForLatestObservations(this._ensureQueryJSON(e),t),r=c.A.fromJSON(i);return r.features.forEach(e=>{e.layer=this.layer,e.sourceLayer=this.layer,"graphicOrigin"in this.layer&&(e.origin=this.layer.graphicOrigin)}),r}async executeAttributeBinsQuery(e,t){const i=await this._dataQueryEngine.executeAttributeBinsQuery(e.toJSON(),t);return p.A.fromJSON(i)}async executeQuery(e,t){const i=await this._dataQueryEngine.executeQuery(this._ensureQueryJSON(e),t),r=c.A.fromJSON(i);return r.features.forEach(e=>{e.layer=this.layer,e.sourceLayer=this.layer,"graphicOrigin"in this.layer&&(e.origin=this.layer.graphicOrigin)}),r}_ensureQueryJSON(e,t){let i=this.defaultQueryJSON;if(null!=e&&("outSpatialReference"in e&&!e.outSpatialReference&&(e.outSpatialReference=this.spatialReference),i=e.toJSON(),i.cacheHint=!0),null!=t){const e=t.geometries.map(e=>e.toJSON()).reduce((e,t)=>(e.rings=e.rings.concat(t.rings),e));i=(0,r.A)((0,r.A)({},i),{},{cacheHint:!0,sceneFilter:(0,r.A)((0,r.A)({},t),{},{geometry:e})})}return i}get _dataQueryEngine(){var e,t;if(this._dataQueryEngineInstance)return this._dataQueryEngineInstance;const{priority:i,layer:r}=this,n="timeInfo"in r&&(null===(e=r.timeInfo)||void 0===e?void 0:e.toJSON())||null,s=(0,y.c)(r),l=u.gy.toJSON(this._queryGeometryType),a=(null===(t=r.fieldsIndex)||void 0===t?void 0:t.toJSON())||new h.A([]),o=this.spatialReference.toJSON(),{hasZ:d,hasM:p,featureStore:c,scheduler:g,memoryController:v}=this.context,C=new f(v);return this._dataQueryEngineInstance=new _({hasZ:d,hasM:p,geometryType:l,fieldsIndex:a,timeInfo:n,spatialReference:o,featureIdInfo:s,featureStore:c,scheduler:g,cache:C,priority:i}),this._dataQueryEngineInstance}};(0,n.Cg)([(0,l.MZ)({constructOnly:!0})],m.prototype,"context",void 0),(0,n.Cg)([(0,l.MZ)({constructOnly:!0})],m.prototype,"priority",void 0),(0,n.Cg)([(0,l.MZ)()],m.prototype,"layer",null),(0,n.Cg)([(0,l.MZ)()],m.prototype,"spatialReference",null),(0,n.Cg)([(0,l.MZ)()],m.prototype,"_queryGeometryType",null),(0,n.Cg)([(0,l.MZ)()],m.prototype,"defaultQueryJSON",null),m=(0,n.Cg)([(0,a.$)("esri.views.3d.layers.graphics.QueryEngine")],m)},18083:(e,t,i)=>{function r(e,t,i){if(!i||null==t)return null;if(!e)return function(e,t){const i=t.toLowerCase();for(const r in e)if(r.toLowerCase()===i)return e[r];return null}(t,i);const r=e.get(i);return r?t[r.name]:null}i.d(t,{f:()=>r})},21010:(e,t,i)=>{i.d(t,{n:()=>Z});var r=i(89379),n=i(6326),s=i(45667),l=i(98773),a=i(4212),o=i(54901),u=i(30726),d=i(91291),h=i(50346),p=i(68134),c=i(46053),g=(i(76460),i(47249),i(87990)),y=i(15011),v=i(19451),f=i(45417),C=i(86486),_=i(24107),m=i(38865),b=i(86079),w=i(54378),E=i(35148),x=i(31329),M=i(90592),S=i(93788),O=i(36423),R=i(88536),I=i(42123);let Z=class extends d.Z{constructor(e){super(e),this.type="graphics-3d",this._updatingHandles=new v.U,this.elevationFeatureExpressionEnabled=!1,this.scaleVisibilityEnabled=!1,this.filterVisibilityEnabled=!1,this.frustumVisibilityEnabled=!1,this.elevationAlignmentEnabled=!1,this.timeExtentEnabled=!1,this.setUidToIdOnAdd=!0,this.dataExtent=null,this.drapeSourceType=1,this.preferredUpdatePolicy=0,this._suspendResumeExtent=null}initialize(){const e=this.owner,t=(this.filterVisibilityEnabled||this.timeExtentEnabled)&&"multipatch"!==e.layer.geometryType,i=new w.w({owner:this,layer:this.layer,preferredUpdatePolicy:this.preferredUpdatePolicy,elevationFeatureExpressionEnabled:this.elevationFeatureExpressionEnabled,graphicSymbolSupported:!1,hasZ:e.hasZ,hasM:e.hasM,setUidToIdOnAdd:this.setUidToIdOnAdd,componentFactories:{deconflictor:t=>e.view.deconflictor.addGraphicsOwner(t),labeler:(t,i)=>e.view.labeler.addGraphicsOwner(t,i),elevationAlignment:this.elevationAlignmentEnabled?(t,i)=>new E.V({graphicsCoreOwner:this,graphicsCore:t,queryGraphicUIDsInExtent:i,elevationProvider:e.view.elevationProvider}):null,scaleVisibility:this.scaleVisibilityEnabled?(t,i)=>new S.N({graphicsCoreOwner:this,layer:this.layer,queryGraphicUIDsInExtent:i,graphicsCore:t,basemapTerrain:e.view.basemapTerrain}):null,filterVisibility:t?t=>new R.t({context:(0,r.A)((0,r.A)({},t),{},{configuration:e})}):null,objectStates:e=>new M.w(e)}});this._set("graphicsCore",i),this.frustumVisibilityEnabled&&this._set("frustumVisibility",new x.p({graphicsCoreOwner:this})),this.elevationAlignment&&this._updatingHandles.add(()=>this.layer.elevationInfo,(e,t)=>{(0,y.Ui)(e,t)&&this._updatingHandles.addPromise(this.graphicsCore.elevationInfoChange())}),this._updatingHandles.add(()=>this.layer.labelsVisible,()=>this.graphicsCore.updateVisibilityInfo()),this._updatingHandles.add(()=>this.layer.labelingInfo,(e,t)=>{(0,y.Ui)(e,t)&&this.graphicsCore.updateLabelingInfo()}),this._updatingHandles.add(()=>this.preferredUpdatePolicy,e=>this.graphicsCore.preferredUpdatePolicy=e),this.addResolvingTask((0,l.UT)(e=>this._initializeAsync(e)))}async _initializeAsync(e){await(0,h.Qg)(this.graphicsCore.initializePromise),(0,h.Te)(e);const t=this.owner;this._updatingHandles.add(()=>this.renderer,e=>this._updatingHandles.addPromise(this.graphicsCore.rendererChange(e))),this._updatingHandles.add(()=>t.fullOpacity,()=>this.graphicsCore.opacityChange()),this._setupSuspendResumeExtent(),this.updateClippingExtent&&(this._updatingHandles.add(()=>t.view.clippingArea,()=>this._updateClippingExtent()),this._updateClippingExtent()),this.graphicsCore.startCreateGraphics(),this.graphicsCore.labelsEnabled&&(await(0,h.Qg)(this.graphicsCore.updateLabelingInfo()),(0,h.Te)(e))}destroy(){this._updatingHandles.destroy(),this._set("frustumVisibility",(0,u.pR)(this.frustumVisibility)),this._set("graphicsCore",(0,u.pR)(this.graphicsCore)),this._set("owner",null)}get layer(){return this.owner.layer}get layerViewUid(){return this.owner.layerViewUid}get dataUpdating(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.dataUpdating)&&void 0!==e&&e}get renderer(){var e;const{renderer:t,objectIdField:i}=this.layer;if(!t||!i||"heatmap"===t.type||!t.visualVariables)return t;const r=t.visualVariables.findIndex(e=>"rotation"===e.type&&null!=e.valueExpression&&(0,_.D)(e.valueExpression)===i&&(null==e.axis||"heading"===e.axis)&&"geographic"===e.rotationType);if(r<0)return t;const n=t.clone();return n.visualVariables?(n.visualVariables.splice(r,1),null!==(e=this._randomRotationRenderers)&&void 0!==e||(this._randomRotationRenderers=new WeakMap),this._randomRotationRenderers.set(n,i),n):t}get scaleVisibility(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.scaleVisibility}get filterVisibility(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.filterVisibility}get elevationAlignment(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.elevationAlignment}get suspendResumeExtentMode(){var e;return null!==(e=this.owner.suspendResumeExtentMode)&&void 0!==e?e:"computed"}get scaleVisibilitySuspended(){return null!=this.scaleVisibility&&this.scaleVisibility.suspended}get suspended(){return this.owner.suspended}get legendEnabled(){return null==this.frustumVisibility||!this.frustumVisibility.suspended}get suspendInfo(){const e={};return this.scaleVisibilitySuspended&&(e.outsideScaleRange=!0),null!=this.frustumVisibility&&this.frustumVisibility.suspended&&(e.outsideOfView=!0),e}get updating(){var e,t;return!!(null!==(e=this.graphicsCore)&&void 0!==e&&e.updating||null!==(t=this.frustumVisibility)&&void 0!==t&&t.updating||this._updatingHandles.updating)}get updatingRemaining(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.updatingRemaining)&&void 0!==e?e:0}get featureStore(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.featureStore}get view(){return this.owner.view}get loadedGraphics(){return this.owner.loadedGraphics}get fullOpacity(){var e;return null===(e=this.owner)||void 0===e?void 0:e.fullOpacity}get filter(){return"filter"in this.owner?this.owner.filter:null}get slicePlaneEnabled(){return this.owner.slicePlaneEnabled}get updatePolicy(){return this.owner.updatePolicy}get featureSpatialReference(){return"featureSpatialReference"in this.owner?this.owner.featureSpatialReference:this.owner.view.spatialReference}get graphics3DGraphics(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.graphics3DGraphics}get graphics3DGraphicsByObjectID(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.graphics3DGraphicsByObjectID}get symbolUpdateType(){var e;return null===(e=this.graphicsCore)||void 0===e?void 0:e.symbolUpdateType}get displayFeatureLimit(){var e;const t=this.view.quality,i=null===(e=this.graphicsCore)||void 0===e?void 0:e.displayFeatureLimit;if(1===t)return i;const r=Math.ceil(i.maximumNumberOfFeatures*t);return new b.o(i.maximumTotalNumberOfVertices,r,i.averageSymbolComplexity)}get usedMemory(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.usedMemory)&&void 0!==e?e:0}get loadedFeatures(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.numberOfGraphics)&&void 0!==e?e:0}get usedMemoryPerFeature(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.usedMemoryPerGraphic)&&void 0!==e?e:0}get unprocessedMemoryEstimate(){var e,t;return null!==(e=null===(t=this.graphicsCore)||void 0===t?void 0:t.unprocessedMemoryEstimate)&&void 0!==e?e:0}get performanceInfo(){return this.graphicsCore.performanceInfo}maskOccludee(e){var t;const i=null===(t=this.graphicsCore)||void 0===t?void 0:t.objectStates;if(!i)return(0,o.hA)();const{set:r,handle:n}=i.acquireOccludeeSet(null);return i.setUid(r,e.uid),n}highlightByGraphics(e,t){var i;const r=null===(i=this.graphicsCore)||void 0===i?void 0:i.objectStates;if(!r)return I.Wg;const n=e.map(e=>e.uid),{set:s,handle:l}=r.acquireHighlightSet(t,null);return r.setUids(s,n),l}highlightByObjectIds(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2?arguments[2]:void 0;const n=null===(t=this.graphicsCore)||void 0===t?void 0:t.objectStates;if(!n)return I.Wg;const{set:s,handle:l}=n.acquireHighlightSet(r,i);return n.setObjectIds(s,e),l}resetObjectStates(){var e;null===(e=this.graphicsCore)||void 0===e||null===(e=e.objectStates)||void 0===e||e.reset()}whenGraphicBounds(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.whenGraphicBounds(e,t)}computeAttachmentOrigin(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.computeAttachmentOrigin(e,t)}notifyGraphicGeometryChanged(e){this.graphicsCore.notifyGraphicGeometryChanged(e)}notifyGraphicVisibilityChanged(e){this.graphicsCore.notifyGraphicVisibilityChanged(e)}notifyContentGeometryUpdate(){var e,t;null===(e=(t=this.owner).notifyContentGeometryUpdate)||void 0===e||e.call(t)}getRenderingInfo(e,t,i){var r;const n=(0,C.vl)(e,{renderer:t,arcade:i});if(null!==n&&void 0!==n&&n.color){const e=n.color;e[0]=e[0]/255,e[1]=e[1]/255,e[2]=e[2]/255}if(null!=n&&null!=t&&null!==(r=this._randomRotationRenderers)&&void 0!==r&&r.has(t)){const i=this._randomRotationRenderers.get(t),r=e.attributes[i],l=new s.b(0);l.updateFloatArray([r]),l.updateUint8Array([173]),n.heading=8.381e-8*l.digest()}return n}getRenderingInfoAsync(e,t,i,n){return(0,C.LO)(e,(0,r.A)({renderer:t,arcade:i},n))}getSymbolLayerSize(e,t){var i;return null===(i=this.graphicsCore)||void 0===i?void 0:i.getSymbolLayerSize(e,t)}setObjectIdVisibility(e,t){var i;null===(i=this.graphicsCore)||void 0===i||i.setObjectIdVisibility(e,t)}refreshFilter(){null!=this.filterVisibility&&this.filterVisibility.reapply()}getGraphics3DGraphicByObjectId(e){var t;return null===(t=this.graphicsCore)||void 0===t?void 0:t.getGraphics3DGraphicByObjectId(e)}_updateClippingExtent(){const e=this.owner.view.clippingArea;this.graphicsCore.setClippingExtent(e,this.owner.view.spatialReference)&&(this.updateClippingExtent(e)||this.graphicsCore.recreateAllGraphics())}_setupSuspendResumeExtent(){(this.frustumVisibility||this.scaleVisibility)&&this.addHandles((0,p.wB)(()=>this.suspendResumeExtentMode,()=>{switch(this.removeHandles(F),this.suspendResumeExtentMode){case"computed":this.addHandles([(0,p.wB)(()=>this.graphicsCore.computedExtent,e=>this._updateSuspendResumeExtent(e),p.Vh),(0,p.wB)(()=>this.graphicsCore.extentPadding,()=>this._updateSuspendResumeExtent(this.graphicsCore.computedExtent))],F);break;case"data":this.addHandles([(0,p.z7)(()=>this.dataExtent,e=>this._updateSuspendResumeExtent(e),p.Vh),(0,p.wB)(()=>this.graphicsCore.extentPadding,()=>this._updateSuspendResumeExtent(this.dataExtent))],F);break;default:(0,a.Xb)(this.suspendResumeExtentMode)}},p.Vh))}_updateSuspendResumeExtent(e){e?this._suspendResumeExtentChanged(this._extentToSuspendResumeRect(e,this._suspendResumeExtent)):this._suspendResumeExtentChanged(null)}_extentToSuspendResumeRect(e,t){const i=this.owner.view.spatialReference;if(!e.spatialReference.equals(i)){if(!(0,f.y7)(e,i))return;e=(0,f.Cv)(e,i)}return(0,O.t8)(e,t,m.qD,this.graphicsCore.extentPadding)}_suspendResumeExtentChanged(e){null!=this.frustumVisibility&&this.frustumVisibility.setExtent(e),null!=this.scaleVisibility&&this.scaleVisibility.setExtent(e)}};(0,n.Cg)([(0,c.MZ)()],Z.prototype,"type",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"owner",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"layer",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"layerViewUid",null),(0,n.Cg)([(0,c.MZ)({readOnly:!0})],Z.prototype,"dataUpdating",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"renderer",null),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"updateClippingExtent",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"elevationFeatureExpressionEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"graphicsCore",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"scaleVisibilityEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"filterVisibilityEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"frustumVisibilityEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"elevationAlignmentEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"timeExtentEnabled",void 0),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"setUidToIdOnAdd",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"scaleVisibility",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"filterVisibility",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"elevationAlignment",null),(0,n.Cg)([(0,c.MZ)({constructOnly:!0})],Z.prototype,"frustumVisibility",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"suspendResumeExtentMode",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"dataExtent",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"scaleVisibilitySuspended",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"suspended",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"legendEnabled",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"suspendInfo",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"updating",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"updatingRemaining",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"featureStore",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"view",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"loadedGraphics",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"fullOpacity",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"filter",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"slicePlaneEnabled",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"drapeSourceType",void 0),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"updatePolicy",null),(0,n.Cg)([(0,c.MZ)()],Z.prototype,"preferredUpdatePolicy",void 0),(0,n.Cg)([(0,c.MZ)({readOnly:!0})],Z.prototype,"displayFeatureLimit",null),Z=(0,n.Cg)([(0,g.$)("esri.views.3d.layers.graphics.Graphics3DFeatureProcessor")],Z);const F="suspendResumeExtentMode"},45667:(e,t,i)=>{i.d(t,{b:()=>u});const r=2654435761,n=2246822519,s=3266489917,l=668265263,a=374761393;function o(e){const t=[];for(let i=0,r=e.length;i<r;i++){let r=e.charCodeAt(i);r<128?t.push(r):r<2048?t.push(192|r>>6,128|63&r):r<55296||r>=57344?t.push(224|r>>12,128|r>>6&63,128|63&r):(i++,r=65536+((1023&r)<<10|1023&e.charCodeAt(i)),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return new Uint8Array(t)}class u{constructor(e){this._seed=e,this._totallen=0,this._bufs=[],this.init()}init(){return this._bufs=[],this._totallen=0,this}updateFloatArray(e){const t=[];for(const i of e)isNaN(i)?t.push("NaN"):i===1/0?t.push("Infinity"):i===-1/0?t.push("-Infinity"):0===i?t.push("0"):t.push(i.toString(16));this.update(o(t.join("")))}updateIntArray(e){const t=Int32Array.from(e);this.update(new Uint8Array(t.buffer))}updateUint8Array(e){this.update(Uint8Array.from(e))}updateWithString(e){return this.update(o(e))}update(e){return this._bufs.push(e),this._totallen+=e.length,this}digest(){const e=new Uint8Array(this._totallen);let t=0;for(const i of this._bufs)e.set(i,t),t+=i.length;return this.init(),this._xxHash32(e,this._seed)}_xxHash32(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const i=e;let o=t+a&4294967295,u=0;if(i.length>=16){const i=[t+r+n&4294967295,t+n&4294967295,t+0&4294967295,t-r&4294967295],s=e,l=s.length-16;let a=0;for(u=0;(4294967280&u)<=l;u+=4){const e=u,t=s[e]+(s[e+1]<<8),l=s[e+2]+(s[e+3]<<8),o=t*n+(l*n<<16);let d=i[a]+o&4294967295;d=d<<13|d>>>19;const h=65535&d,p=d>>>16;i[a]=h*r+(p*r<<16)&4294967295,a=a+1&3}o=(i[0]<<1|i[0]>>>31)+(i[1]<<7|i[1]>>>25)+(i[2]<<12|i[2]>>>20)+(i[3]<<18|i[3]>>>14)&4294967295}o=o+e.length&4294967295;const d=e.length-4;for(;u<=d;u+=4){const e=u,t=i[e]+(i[e+1]<<8),r=i[e+2]+(i[e+3]<<8);o=o+(t*s+(r*s<<16))&4294967295,o=o<<17|o>>>15,o=(65535&o)*l+((o>>>16)*l<<16)&4294967295}for(;u<i.length;++u)o+=i[u]*a,o=o<<11|o>>>21,o=(65535&o)*r+((o>>>16)*r<<16)&4294967295;return o^=o>>>15,o=((65535&o)*n&4294967295)+((o>>>16)*n<<16),o^=o>>>13,o=((65535&o)*s&4294967295)+((o>>>16)*s<<16),o^=o>>>16,o<0?o+4294967296:o}}},49927:(e,t,i)=>{i.d(t,{g:()=>r});class r{constructor(e,t,i,r,n,s){this.spatialReference=e,this.layer=t,this.resourceController=i,this._getFeatureStore=r,this.hasZ=n,this.hasM=s}get scheduler(){return this.resourceController.scheduler}get memoryController(){return this.resourceController.memoryController}get featureStore(){return this._getFeatureStore()}}},83491:(e,t,i)=>{i.d(t,{w:()=>d});var r=i(6326),n=i(54901),s=i(50346),l=i(68134),a=i(46053),o=(i(81806),i(76460),i(47249),i(87990)),u=i(47700);const d=e=>{const t=e;let i=class extends t{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,u.jI)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,n.hA)(()=>e.abort())),await(0,l.C_)(()=>{var e;return null===(e=this.view.defaultsFromMap)||void 0===e?void 0:e.heightModelInfoReady},t),(0,s.Te)(t);const i=(0,u.Hu)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(i)throw i}};return(0,r.Cg)([(0,a.MZ)()],i.prototype,"view",void 0),(0,r.Cg)([(0,a.MZ)()],i.prototype,"slicePlaneEnabled",void 0),i=(0,r.Cg)([(0,o.$)("esri.views.3d.layers.LayerView3D")],i),i}},88536:(e,t,i)=>{i.d(t,{t:()=>m});var r=i(56218),n=i(10600),s=i(6326),l=i(91967),a=i(76460),o=i(30726),u=i(50346),d=i(68134),h=i(34154),p=i(46053),c=(i(81806),i(47249),i(87990)),g=i(19451),y=i(8203),v=i(46530),f=i(10857),C=i(49927),_=i(59752);let m=class extends l.A{constructor(e){super(e),this._frameTask=null,this._queryEngine=null,this._updateRequested=!0,this._updatingHandles=new g.U,this._abortController=new AbortController}initialize(){var e,t;const i=_.W6.FILTER_VISIBILITY,{layer:r,view:n}=this._configuration,{featureStore:s}=this.context,{spatialReference:l,resourceController:a}=n,o=null!==(e=this._configuration.hasZ)&&void 0!==e&&e,h=null!==(t=this._configuration.hasM)&&void 0!==t&&t,p=new C.g(l,r,a,()=>s,o,h);this._queryEngine=new f.d({context:p,priority:i}),this._frameTask=n.resourceController.scheduler.registerTask(i),this._updatingHandles.add(()=>[this._compositedFeatureFilter,this._sceneFilter,this._displayFilterHighlightIds],()=>this.reapply(),d.Vh),this._updatingHandles.addWhen(()=>!this._frameTask.updating&&this._updateRequested,()=>{this._frameTask.scheduleGenerator(()=>this._updateVisibility(),this._abortController.signal).catch(u.jH)},d.Vh)}destroy(){this._abortController.abort(),this._updatingHandles.destroy(),this.clear(),this._frameTask=(0,o.xt)(this._frameTask),this._queryEngine=(0,o.pR)(this._queryEngine),this._set("context",null)}get updating(){return this._updateRequested||this._updatingHandles.updating||this._frameTask.updating}get defaultVisibility(){return null==this._compositedFeatureFilter&&null==this._sceneFilter}get _featureFilter(){return"filter"in this._configuration?this._configuration.filter:null}get _effectiveDisplayFilter(){return"effectiveDisplayFilter"in this._configuration?this._configuration.effectiveDisplayFilter:null}get _highlightIds(){return"highlightIds"in this._configuration?this._configuration.highlightIds:null}get _displayFilterHighlightIds(){var e;return this._effectiveDisplayFilter&&null!==(e=this._highlightIds)&&void 0!==e&&e.length?new Set(this._highlightIds):null}get _sceneFilter(){return"layerFilter"in this._configuration?this._configuration.layerFilter:null}get _floorFilter(){return(0,v.E)(this._configuration)}get _timeExtent(){return"timeExtent"in this._configuration?this._configuration.timeExtent:null}get _compositedFeatureFilter(){var e,t;const{_featureFilter:i,_effectiveDisplayFilter:r,_timeExtent:n,_floorFilter:s}=this;let l=null===i||void 0===i?void 0:i.clone();if(null!=r&&(null!==l&&void 0!==l||(l=new y.A),l.where=(0,h.mA)(l.where,r.where)),null!=n&&(null!==l&&void 0!==l||(l=new y.A),l.timeExtent=null!==(e=null===(t=l.timeExtent)||void 0===t?void 0:t.intersection(n))&&void 0!==e?e:n),null!=s){null!==l&&void 0!==l||(l=new y.A);const e=null==l.where||""===l.where;l.where=e?s:(0,h.mA)(l.where,s)}return l}get _configuration(){return this.context.configuration}reapply(){this._updateRequested=!0}clear(){this._queryEngine.clear(),this.context.clearFeaturesVisibility()}_updateVisibility(){var e=this;return(0,n.A)(function*(){e._updateRequested=!1;const{context:t,_sceneFilter:i,_compositedFeatureFilter:n,_displayFilterHighlightIds:s,_abortController:{signal:l}}=e;if((0,u.Te)(l),null==n&&null==i||0===t.getFeatureCount())return e.clear();try{let a=yield(0,r.A)(e._queryEngine.executeQueryForIdSet(n,i,l));yield,s&&(a=new Set([...a,...s])),yield,t.updateFeatureVisibilities(e=>a.has(e))}catch(o){(0,u.QP)(o),a.A.getLogger(e).warn("FeatureFilter query failed: ".concat(o),{error:o}),t.setAllFeaturesVisibility(!0)}})()}};(0,s.Cg)([(0,p.MZ)({constructOnly:!0})],m.prototype,"context",void 0),(0,s.Cg)([(0,p.MZ)()],m.prototype,"updating",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"defaultVisibility",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_featureFilter",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_effectiveDisplayFilter",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_highlightIds",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_displayFilterHighlightIds",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_sceneFilter",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_floorFilter",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_timeExtent",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_compositedFeatureFilter",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_configuration",null),(0,s.Cg)([(0,p.MZ)()],m.prototype,"_updateRequested",void 0),m=(0,s.Cg)([(0,c.$)("esri.views.3d.layers.support.FeatureVisibilityFilter")],m)},91196:(e,t,i)=>{i.d(t,{A:()=>c});var r=i(6326),n=i(54099),s=i(5632),l=i(76460),a=i(30726),o=i(91291),u=i(46053),d=(i(81806),i(47249),i(87990)),h=i(19451),p=i(90992);let c=class extends((0,s.sA)((0,o.g)(n.nJ))){get spatialReferenceSupported(){return!0}constructor(e){super(e),this._updatingHandles=new h.U,this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){var t;const i=this.layer&&this.layer.id||"no id",r=(null===(t=this.layer)||void 0===t?void 0:t.title)||"no title";l.A.getLogger(this).error("#resolve()","Failed to resolve layer view (layer title: '".concat(r,"', id: '").concat(i,"')"),e)}})}destroy(){this._updatingHandles=(0,a.pR)(this._updatingHandles),this._set("parent",null)}get fullOpacity(){var e,t,i,r;return(null!==(e=null===(t=this.layer)||void 0===t?void 0:t.opacity)&&void 0!==e?e:1)*(null!==(i=null===(r=this.parent)||void 0===r?void 0:r.fullOpacity)&&void 0!==i?i:1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){var e;return!this.suspended&&!0===(null===(e=this.layer)||void 0===e?void 0:e.legendEnabled)}get updating(){var e;return!((null===(e=this._updatingHandles)||void 0===e||!e.updating)&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){var e;return!0===(null===(e=this.layer)||void 0===e?void 0:e.visible)}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){var e;const t=this.view.timeExtent,i=null===(e=this.layer)||void 0===e?void 0:e.visibilityTimeExtent;return!t||!i||!t.intersection(i).isEmpty}canResume(){var e,t;const i=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&(null===(e=this.layer)||void 0===e?void 0:e.loaded)&&this.parent&&!this.parent.suspended&&(null===(t=this.view)||void 0===t?void 0:t.ready)&&(0,p.g7)(i)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){var e,t;const i=null!==(e=this.parent)&&void 0!==e&&e.suspended?this.parent.suspendInfo:{};null!==(t=this.view)&&void 0!==t&&t.ready||(i.viewNotReady=!0),this.layer&&this.layer.loaded||(i.layerNotLoaded=!0);const r=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,p.g7)(r)&&this.visibleAtCurrentScale||(i.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(i.outsideVisibilityTimeExtent=!0),this.visible||(i.layerInvisible=!0),i}isUpdating(){return!1}};(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"spatialReferenceSupported",null),(0,r.Cg)([(0,u.MZ)()],c.prototype,"view",void 0),(0,r.Cg)([(0,u.MZ)()],c.prototype,"fullOpacity",null),(0,r.Cg)([(0,u.MZ)()],c.prototype,"layer",void 0),(0,r.Cg)([(0,u.MZ)()],c.prototype,"parent",void 0),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"suspended",null),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"suspendInfo",null),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"legendEnabled",null),(0,r.Cg)([(0,u.MZ)({type:Boolean,readOnly:!0})],c.prototype,"updating",null),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"updatingProgress",null),(0,r.Cg)([(0,u.MZ)()],c.prototype,"updateSuspended",null),(0,r.Cg)([(0,u.MZ)()],c.prototype,"visible",null),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"visibleAtCurrentScale",null),(0,r.Cg)([(0,u.MZ)({readOnly:!0})],c.prototype,"visibleAtCurrentTimeExtent",null),c=(0,r.Cg)([(0,d.$)("esri.views.layers.LayerView")],c)}}]);
//# sourceMappingURL=28707.5994e9ba.chunk.js.map